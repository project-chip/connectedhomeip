language: minimal

services:
  - docker

before_install:
- ./integrations/ci-tools/pre_build.sh

script:
- ./integrations/ci-tools/build.sh

# Note: To add new job types, add it to the matrix below, with a unique TASK varable, then update the build.sh to do what you want during that task

jobs:
  include:
    - stage: build
      name: "Main Build"
      env: TASK="build-linux"
    - stage: build
      name: "Main Build"
      env: TASK="build-main"
    - stage: test
      name: "Unit & Functional Tests"
      env: TASK="run-unit-and-functional-tests"
    - stage: test
      name: "Crypto Tests"
      env: TASK="run-crypto-tests"
    - stage: test
      name: "Setup Payload Tests"
      env: TASK="run-setup-payload-tests"
    - stage: deploy
      name: "Distribution Check"
      env: TASK="build-distribution-check"
      