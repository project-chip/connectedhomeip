<?xml version="1.0"?>
<!--
Copyright (c) 2021-2025 Project CHIP Authors

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<!--
XML generated by Alchemy; DO NOT EDIT.
Source: src/service_device_management/TimeSync.adoc
Parameters: zap attribute=in-progress ignore-errored provisional-policy=loose sdkRoot=./connectedhomeip/ specRoot=./connectedhomeip-spec/ ./connectedhomeip-spec/src/service_device_management/TimeSync.adoc 
Git: 0.9-fall2025-ncr-84-g920fa66b5
Alchemy: v1.5.55
-->
<configurator xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../zcl.xsd">
  <domain name="CHIP"/>
  <!-- NOTE: This type is not defined as an enum in the spec, but the Status Codes section
  of this cluster defines these status codes, and we're choosing to represent them as an enum. -->
  <enum name="StatusCode" type="enum8">
    <cluster code="0x0038"/>
    <item name="TimeNotAccepted" value="0x02"/>
  </enum>

  <enum name="GranularityEnum" type="enum8">
    <cluster code="0x0038"/>
    <item name="NoTimeGranularity" value="0x00"/>
    <item name="MinutesGranularity" value="0x01"/>
    <item name="SecondsGranularity" value="0x02"/>
    <item name="MillisecondsGranularity" value="0x03"/>
    <item name="MicrosecondsGranularity" value="0x04"/>
  </enum>

  <enum name="TimeSourceEnum" type="enum8">
    <cluster code="0x0038"/>
    <item name="None" value="0x00"/>
    <item name="Unknown" value="0x01"/>
    <item name="Admin" value="0x02"/>
    <item name="NodeTimeCluster" value="0x03"/>
    <item name="NonMatterSNTP" value="0x04"/>
    <item name="NonMatterNTP" value="0x05"/>
    <item name="MatterSNTP" value="0x06"/>
    <item name="MatterNTP" value="0x07"/>
    <item name="MixedNTP" value="0x08"/>
    <item name="NonMatterSNTPNTS" value="0x09"/>
    <item name="NonMatterNTPNTS" value="0x0A"/>
    <item name="MatterSNTPNTS" value="0x0B"/>
    <item name="MatterNTPNTS" value="0x0C"/>
    <item name="MixedNTPNTS" value="0x0D"/>
    <item name="CloudSource" value="0x0E"/>
    <item name="PTP" value="0x0F"/>
    <item name="GNSS" value="0x10"/>
  </enum>

  <enum name="TimeZoneDatabaseEnum" type="enum8">
    <cluster code="0x0038"/>
    <item name="Full" value="0x00"/>
    <item name="Partial" value="0x01"/>
    <item name="None" value="0x02"/>
  </enum>

  <struct name="TrustedTimeSourceStruct">
    <cluster code="0x0038"/>
    <item fieldId="0" name="FabricIndex" type="fabric_idx"/>
    <item fieldId="1" name="NodeID" type="node_id"/>
    <item fieldId="2" name="Endpoint" type="endpoint_no"/>
  </struct>

  <struct name="FabricScopedTrustedTimeSourceStruct">
    <cluster code="0x0038"/>
    <item fieldId="0" name="NodeID" type="node_id"/>
    <item fieldId="1" name="Endpoint" type="endpoint_no"/>
  </struct>

  <struct name="TimeZoneStruct">
    <cluster code="0x0038"/>
    <item fieldId="0" name="Offset" type="int32s" min="-43200" max="50400"/>
    <item fieldId="1" name="ValidAt" type="epoch_us"/>
    <item fieldId="2" name="Name" type="char_string" length="64" optional="true"/>
  </struct>

  <struct name="DSTOffsetStruct">
    <cluster code="0x0038"/>
    <item fieldId="0" name="Offset" type="int32s"/>
    <item fieldId="1" name="ValidStarting" type="epoch_us"/>
    <item fieldId="2" name="ValidUntil" type="epoch_us" isNullable="true"/>
  </struct>

  <cluster>
    <domain>General</domain>
    <name>Time Synchronization</name>
    <code>0x0038</code>
    <define>TIME_SYNCHRONIZATION_CLUSTER</define>
    <client init="false" tick="false">true</client>
    <server init="false" tick="false">true</server>
    <description>Accurate time is required for a number of reasons, including scheduling, display and validating security materials.</description>
    <globalAttribute side="either" code="0xFFFD" value="2"/>
    <features>
      <feature bit="0" code="TZ" name="TimeZone" summary="Server supports time zone.">
        <optionalConform/>
      </feature>
      <feature bit="1" code="NTPC" name="NTPClient" summary="Server supports an NTP or SNTP client.">
        <optionalConform/>
      </feature>
      <feature bit="2" code="NTPS" name="NTPServer" summary="Server supports an NTP server role.">
        <optionalConform/>
      </feature>
      <feature bit="3" code="TSC" name="TimeSyncClient" summary="Time synchronization client cluster is present.">
        <optionalConform/>
      </feature>
    </features>
    <attribute side="server" code="0x0000" name="UTCTime" define="UTC_TIME" type="epoch_us" isNullable="true">
      <quality changeOmitted="true"/>
    </attribute>
    <attribute side="server" code="0x0001" name="Granularity" define="GRANULARITY" type="GranularityEnum" default="0x00" max="0x04"/>
    <attribute side="server" code="0x0002" name="TimeSource" define="TIME_SOURCE" type="TimeSourceEnum" default="0x00" optional="true" max="0x10">
      <optionalConform/>
    </attribute>
    <attribute side="server" code="0x0003" name="TrustedTimeSource" define="TRUSTED_TIME_SOURCE" type="TrustedTimeSourceStruct" isNullable="true" optional="true">
      <mandatoryConform>
        <feature name="TSC"/>
      </mandatoryConform>
    </attribute>
    <attribute side="server" code="0x0004" name="DefaultNTP" define="DEFAULT_NTP" type="char_string" length="128" isNullable="true" optional="true">
      <mandatoryConform>
        <feature name="NTPC"/>
      </mandatoryConform>
    </attribute>
    <attribute side="server" code="0x0005" name="TimeZone" define="TIME_ZONE" type="array" entryType="TimeZoneStruct" optional="true" length="2" minLength="1">
      <mandatoryConform>
        <feature name="TZ"/>
      </mandatoryConform>
    </attribute>
    <attribute side="server" code="0x0006" name="DSTOffset" define="DST_OFFSET" type="array" entryType="DSTOffsetStruct" optional="true">
      <mandatoryConform>
        <feature name="TZ"/>
      </mandatoryConform>
    </attribute>
    <attribute side="server" code="0x0007" name="LocalTime" define="LOCAL_TIME" type="epoch_us" isNullable="true" optional="true">
      <quality changeOmitted="true"/>
      <mandatoryConform>
        <feature name="TZ"/>
      </mandatoryConform>
    </attribute>
    <attribute side="server" code="0x0008" name="TimeZoneDatabase" define="TIME_ZONE_DATABASE" type="TimeZoneDatabaseEnum" default="2" optional="true" max="0x02">
      <mandatoryConform>
        <feature name="TZ"/>
      </mandatoryConform>
    </attribute>
    <attribute side="server" code="0x0009" name="NTPServerAvailable" define="NTP_SERVER_AVAILABLE" type="boolean" optional="true" default="0">
      <mandatoryConform>
        <feature name="NTPS"/>
      </mandatoryConform>
    </attribute>
    <attribute side="server" code="0x000A" name="TimeZoneListMaxSize" define="TIME_ZONE_LIST_MAX_SIZE" type="int8u" min="1" max="2" optional="true">
      <mandatoryConform>
        <feature name="TZ"/>
      </mandatoryConform>
    </attribute>
    <attribute side="server" code="0x000B" name="DSTOffsetListMaxSize" define="DST_OFFSET_LIST_MAX_SIZE" type="int8u" min="1" optional="true">
      <mandatoryConform>
        <feature name="TZ"/>
      </mandatoryConform>
    </attribute>
    <attribute side="server" code="0x000C" name="SupportsDNSResolve" define="SUPPORTS_DNS_RESOLVE" type="boolean" optional="true" default="0">
      <mandatoryConform>
        <feature name="NTPC"/>
      </mandatoryConform>
    </attribute>
    <command source="client" code="0x00" name="SetUTCTime">
      <description>This command is used to set the UTC time of the node.</description>
      <arg id="0" name="UTCTime" type="epoch_us" default="0"/>
      <arg id="1" name="Granularity" type="GranularityEnum" default="0x00" max="0x04"/>
      <arg id="2" name="TimeSource" type="TimeSourceEnum" optional="true" default="0x00" max="0x10"/>
      <access op="invoke" privilege="administer"/>
    </command>

    <command source="client" code="0x01" name="SetTrustedTimeSource" isFabricScoped="true" optional="true">
      <description>This command is used to set the TrustedTimeSource attribute.</description>
      <arg id="0" name="TrustedTimeSource" type="FabricScopedTrustedTimeSourceStruct" isNullable="true"/>
      <access op="invoke" privilege="administer"/>
      <mandatoryConform>
        <feature name="TSC"/>
      </mandatoryConform>
    </command>

    <command source="client" code="0x02" name="SetTimeZone" response="SetTimeZoneResponse" optional="true">
      <description>This command is used to set the time zone of the node.</description>
      <arg id="0" name="TimeZone" type="TimeZoneStruct" array="true" length="2" minLength="1"/>
      <access op="invoke" privilege="manage"/>
      <mandatoryConform>
        <feature name="TZ"/>
      </mandatoryConform>
    </command>

    <command source="server" code="0x03" name="SetTimeZoneResponse" optional="true" disableDefaultResponse="true">
      <description>THis command is used to report the result of a SetTimeZone command.</description>
      <arg id="0" name="DSTOffsetRequired" type="boolean" default="1"/>
      <mandatoryConform>
        <feature name="TZ"/>
      </mandatoryConform>
    </command>

    <command source="client" code="0x04" name="SetDSTOffset" optional="true">
      <description>This command is used to set the DST offsets for a node.</description>
      <arg id="0" name="DSTOffset" type="DSTOffsetStruct" array="true"/>
      <access op="invoke" privilege="manage"/>
      <mandatoryConform>
        <feature name="TZ"/>
      </mandatoryConform>
    </command>

    <command source="client" code="0x05" name="SetDefaultNTP" optional="true">
      <description>This command is used to set the DefaultNTP attribute.</description>
      <arg id="0" name="DefaultNTP" type="char_string" length="128" isNullable="true"/>
      <access op="invoke" privilege="administer"/>
      <mandatoryConform>
        <feature name="NTPC"/>
      </mandatoryConform>
    </command>

    <event code="0x0000" name="DSTTableEmpty" priority="info" side="server" optional="true">
      <description>This event SHALL be generated when the node stops applying the current DSTOffset and there are no entries in the list with a larger ValidStarting time, indicating the need to possibly get new DST data.</description>
      <mandatoryConform>
        <feature name="TZ"/>
      </mandatoryConform>
    </event>

    <event code="0x0001" name="DSTStatus" priority="info" side="server" optional="true">
      <description>This event SHALL be generated when the node starts or stops applying a DST offset.</description>
      <field id="0" name="DSTOffsetActive" type="boolean"/>
      <mandatoryConform>
        <feature name="TZ"/>
      </mandatoryConform>
    </event>

    <event code="0x0002" name="TimeZoneStatus" priority="info" side="server" optional="true">
      <description>This event SHALL be generated when the node changes its time zone offset or name.</description>
      <field id="0" name="Offset" type="int32s" min="-43200" max="50400"/>
      <field id="1" name="Name" type="char_string" length="64" optional="true"/>
      <mandatoryConform>
        <feature name="TZ"/>
      </mandatoryConform>
    </event>

    <event code="0x0003" name="TimeFailure" priority="info" side="server">
      <description>This event SHALL be generated if the node has not generated a TimeFailure event in the last hour, and the node is unable to get a time from any source.</description>
    </event>

    <event code="0x0004" name="MissingTrustedTimeSource" priority="info" side="server" optional="true">
      <description>This event SHALL be generated if the TrustedTimeSource is set to null upon fabric removal or by a SetTrustedTimeSource command.</description>
      <mandatoryConform>
        <feature name="TSC"/>
      </mandatoryConform>
    </event>

  </cluster>
</configurator>
