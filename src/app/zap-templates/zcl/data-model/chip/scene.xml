<?xml version="1.0"?>
<!--
Copyright (c) 2022 Project CHIP Authors

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<configurator>
  <bitmap name="ScenesCopyMode" type="BITMAP8">
    <cluster code="0x0005"/>
    <field name="CopyAllScenes" mask="0x01"/>
  </bitmap>

  <struct name="SceneExtensionAttributeInfo">
    <item name="attributeType" type="INT8U"/>
    <item name="attributeLocation" type="NO_DATA"/>
  </struct>

  <struct name="SceneExtensionFieldSet">
    <cluster code="0x0005"/>
    <item name="clusterId" type="CLUSTER_ID"/>
    <item name="length" type="INT8U"/>
    <item name="value" type="INT8U"/>
  </struct>

  <domain name="CHIP"/>
    <cluster>
    <name>Scenes</name>
    <domain>General</domain>
    <description>Attributes and commands for scene configuration and manipulation.</description>
    <code>0x0005</code>
    <define>SCENES_CLUSTER</define>
    <client tick="false" init="false">true</client>
    <server tick="false" init="false">true</server>
    <globalAttribute side="either" code="0xFFFD" value="3"/>
   
    <attribute side="server" code="0x0000" define="SCENE_COUNT" type="INT8U" min="0x00" max="0xFF" writable="false" default="0x00" optional="false">scene count</attribute>
    <attribute side="server" code="0x0001" define="CURRENT_SCENE" type="INT8U" min="0x00" max="0xFF" writable="false" default="0x00" optional="false">current scene</attribute>
    <attribute side="server" code="0x0002" define="CURRENT_GROUP" type="INT16U" min="0x0000" max="0xFFF7" writable="false" default="0x0000" optional="false">current group</attribute>
    <attribute side="server" code="0x0003" define="SCENE_VALID" type="BOOLEAN" min="0x00" max="0x01" writable="false" default="0x00" optional="false">scene valid</attribute>
    <attribute side="server" code="0x0004" define="SCENE_NAME_SUPPORT" type="BITMAP8" min="0x00" max="0x80" writable="false" optional="false">name support</attribute>
    <!-- NAME_SUPPORT -->
    <attribute side="server" code="0x0005" define="LAST_CONFIGURED_BY" type="NODE_ID" writable="false" optional="true">last configured by</attribute>
   
    <command source="client" code="0x00" name="AddScene" response="AddSceneResponse" optional="false" cli="zcl scenes add">
      <description>
        Add a scene to the scene table. Extension field sets are supported, and are inputed as arrays of the form [[cluster ID] [length] [value0...n] ...]
      </description>
      <arg name="groupId" type="INT16U"/>
      <arg name="sceneId" type="INT8U"/>
      <arg name="transitionTime" type="INT16U"/>
      <arg name="sceneName" type="CHAR_STRING"/>
      <arg name="extensionFieldSets" type="SceneExtensionFieldSet" array="true"/>
      <access op="invoke" role="manage"/>
    </command>
   
    <command source="client" code="0x01" name="ViewScene" response="ViewSceneResponse" optional="false" cli="zcl scenes view">
      <description>
        Command description for ViewScene
      </description>
      <arg name="groupId" type="INT16U"/>
      <arg name="sceneId" type="INT8U"/>
    </command>
   
    <command source="client" code="0x02" name="RemoveScene" response="RemoveSceneResponse" optional="false" cli="zcl scenes remove">
      <description>
        Command description for RemoveScene
      </description>
      <arg name="groupId" type="INT16U"/>
      <arg name="sceneId" type="INT8U"/>
      <access op="invoke" role="manage"/>
    </command>
    
    <command source="client" code="0x03" name="RemoveAllScenes" response="RemoveAllScenesResponse" optional="false" cli="zcl scenes rmall">
      <description>
        Command description for RemoveAllScenes
      </description>
      <arg name="groupId" type="INT16U"/>
      <access op="invoke" role="manage"/>
    </command>
    
    <command source="client" code="0x04" name="StoreScene" response="StoreSceneResponse" optional="false" cli="zcl scenes store">
      <description>
        Command description for StoreScene
      </description>
      <arg name="groupId" type="INT16U"/>
      <arg name="sceneId" type="INT8U"/>
      <access op="invoke" role="manage"/>
    </command>
    
    <command source="client" code="0x05" name="RecallScene" optional="false" cli="zcl scenes recall">
      <description>
        Command description for RecallScene
      </description>
      <arg name="groupId" type="INT16U"/>
      <arg name="sceneId" type="INT8U"/>
      <arg name="transitionTime" type="INT16U" introducedIn="zcl-7.0-07-5123-07" optional="1"/>
    </command>
   
    <command source="client" code="0x06" name="GetSceneMembership" response="GetSceneMembershipResponse" optional="false" cli="zcl scenes get">
      <description>
        Command description for GetSceneMembership
      </description>
      <arg name="groupId" type="INT16U"/>
    </command>

    <command source="client" code="0x40" name="EnhancedAddScene" response="EnhancedAddSceneResponse" optional="true" introducedIn="zll-1.0-11-0037-10" cli="zcl scenes eadd">
      <description>
        Command description for EnhancedAddScene
      </description>
      <arg name="groupId" type="INT16U"/>
      <arg name="sceneId" type="INT8U"/>
      <arg name="transitionTime" type="INT16U"/>
      <arg name="sceneName" type="CHAR_STRING"/>
      <arg name="extensionFieldSets" type="SceneExtensionFieldSet" array="true"/>
    </command>
    <command source="client" code="0x41" name="EnhancedViewScene" response="EnhancedViewSceneResponse" optional="true" noDefaultImplementation="true" introducedIn="zll-1.0-11-0037-10" cli="zcl scenes eview">
      <description>
        Command description for EnhancedViewScene
      </description>
      <arg name="groupId" type="INT16U"/>
      <arg name="sceneId" type="INT8U"/>
    </command>
    <command source="client" code="0x42" name="CopyScene" response="CopySceneResponse" optional="true" introducedIn="zll-1.0-11-0037-10" cli="zcl scenes copy">
      <description>
        Command description for CopyScene
      </description>
      <arg name="mode" type="ScenesCopyMode"/>
      <arg name="groupIdFrom" type="INT16U"/>
      <arg name="sceneIdFrom" type="INT8U"/>
      <arg name="groupIdTo" type="INT16U"/>
      <arg name="sceneIdTo" type="INT8U"/>
    </command>
    
    <command source="server" code="0x00" name="AddSceneResponse" optional="false" disableDefaultResponse="true">
      <description>
        Command description for AddSceneResponse
      </description>
      <arg name="status" type="ENUM8"/>
      <arg name="groupId" type="INT16U"/>
      <arg name="sceneId" type="INT8U"/>
    </command>
    
    <command source="server" code="0x01" name="ViewSceneResponse" optional="false" disableDefaultResponse="true">
      <description>
        Command description for ViewSceneResponse
      </description>
      <arg name="status" type="ENUM8"/>
      <arg name="groupId" type="INT16U"/>
      <arg name="sceneId" type="INT8U"/>
      <arg name="transitionTime" type="INT16U" presentIf="status==0"/>
      <arg name="sceneName" type="CHAR_STRING" presentIf="status==0"/>
      <arg name="extensionFieldSets" type="SceneExtensionFieldSet" array="true" presentIf="status==0"/>
    </command>
    
    <command source="server" code="0x02" name="RemoveSceneResponse" optional="false" disableDefaultResponse="true">
      <description>
        Command description for RemoveSceneResponse
      </description>
      <arg name="status" type="ENUM8"/>
      <arg name="groupId" type="INT16U"/>
      <arg name="sceneId" type="INT8U"/>
    </command>
    
    <command source="server" code="0x03" name="RemoveAllScenesResponse" optional="false" disableDefaultResponse="true">
      <description>
        Command description for RemoveAllScenesResponse
      </description>
      <arg name="status" type="ENUM8"/>
      <arg name="groupId" type="INT16U"/>
    </command>
    
    <command source="server" code="0x04" name="StoreSceneResponse" optional="false" disableDefaultResponse="true">
      <description>
        Command description for StoreSceneResponse
      </description>
      <arg name="status" type="ENUM8"/>
      <arg name="groupId" type="INT16U"/>
      <arg name="sceneId" type="INT8U"/>
    </command>
    
    <command source="server" code="0x06" name="GetSceneMembershipResponse" optional="false" disableDefaultResponse="true">
      <description>
        Command description for GetSceneMembershipResponse
      </description>
      <arg name="status" type="ENUM8"/>
      <arg name="capacity" type="INT8U"/>
      <arg name="groupId" type="INT16U"/>
      <arg name="sceneCount" type="INT8U" arrayLength="true" presentIf="status==0"/>
      <arg name="sceneList" type="INT8U" array="true" presentIf="status==0"/>
    </command>

  <command source="server" code="0x40" name="EnhancedAddSceneResponse" optional="true" introducedIn="zll-1.0-11-0037-10" disableDefaultResponse="true">
      <description>
        Command description for EnhancedAddSceneResponse
      </description>
      <arg name="status" type="ENUM8"/>
      <arg name="groupId" type="INT16U"/>
      <arg name="sceneId" type="INT8U"/>
    </command>

    <command source="server" code="0x41" name="EnhancedViewSceneResponse" optional="true" introducedIn="zll-1.0-11-0037-10" disableDefaultResponse="true">
      <description>
        Command description for EnhancedViewSceneResponse
      </description>
      <arg name="status" type="ENUM8"/>
      <arg name="groupId" type="INT16U"/>
      <arg name="sceneId" type="INT8U"/>
      <arg name="transitionTime" type="INT16U"/>
      <arg name="sceneName" type="CHAR_STRING"/>
      <arg name="extensionFieldSets" type="SceneExtensionFieldSet" array="true"/>
    </command>

    <command source="server" code="0x42" name="CopySceneResponse" optional="true" introducedIn="zll-1.0-11-0037-10" disableDefaultResponse="true">
      <description>
        Command description for CopySceneResponse
      </description>
      <arg name="status" type="ENUM8"/>
      <arg name="groupIdFrom" type="INT16U"/>
      <arg name="sceneIdFrom" type="INT8U"/>
    </command>

  </cluster>
</configurator>