# Copyright (c) 2021 Project CHIP Authors
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# Auto-generated scripts for harness use only, please review before automation. The endpoints and cluster names are currently set to default

name: 4.1.5. [TC-DA-1.5] NOCSR Procedure Validation [DUT - Commissionee]

config:
    nodeId: 0x12344321
    cluster: "Basic"
    endpoint: 0

tests:
    - label: "TH1 Completes the Attestation procedure"
      verification: |
          Verify in TH log:

          [1655374218.114327][35023:35028] CHIP:CTL: Performing next commissioning step 'SendAttestationRequest'
          [1655374218.114378][35023:35028] CHIP:CTL: Sending Attestation Request to the device.
          [1655374218.114556][35023:35028] CHIP:CTL: Sending Attestation request to 0xffff74000b60 device
          [1655374218.114675][35023:35028] CHIP:DMG: ICR moving to [AddingComm]
          [1655374218.114746][35023:35028] CHIP:DMG: ICR moving to [AddedComma]
          [1655374218.115227][35023:35028] CHIP:IN: Prepared secure message 0xffff7bffc958 to 0xFFFFFFFB00000000 (0)  of type 0x8 and protocolId (0, 1) on exchange 1302i with MessageCounter:20936210.
          [1655374218.115326][35023:35028] CHIP:IN: Sending encrypted msg 0xffff7bffc958 with MessageCounter:20936210 to 0xFFFFFFFB00000000 (0) at monotonic time: 00000000004F8059 msec
          [1655374218.115908][35023:35028] CHIP:DMG: >> to BLE | 20936210 | [Interaction Model  (1) / InvokeCommandRequest (0x08) / Session = 43668 / Exchange = 1302]
          [1655374218.116008][35023:35028] CHIP:DMG: Header Flags =
          [1655374218.116065][35023:35028] CHIP:DMG: {
          [1655374218.116149][35023:35028] CHIP:DMG:     Exchange (0x01) =
          [1655374218.116187][35023:35028] CHIP:DMG:     {
          [1655374218.116209][35023:35028] CHIP:DMG:         Initiator = true
          [1655374218.116233][35023:35028] CHIP:DMG:     }
          [1655374218.116264][35023:35028] CHIP:DMG: }
          [1655374218.116288][35023:35028] CHIP:DMG:
          [1655374218.116381][35023:35028] CHIP:DMG: Encrypted Payload (94 bytes) =
          [1655374218.116408][35023:35028] CHIP:DMG: {
          [1655374218.116432][35023:35028] CHIP:DMG:     data = 0094aa0012763f01f66833cd7fd4d0b928d486cd8459db3eb0f11f7b48d3145a810b0c2e03ea68c89e4ee9cf28127369ac0eef32376c5303945a2fe8c99d13a49086721cd68804d90415fef75a0b464605f2d0245f293767a4077eb7d5eb
          [1655374218.116458][35023:35028] CHIP:DMG:     buffer_ptr = 281472627988496
          [1655374218.116482][35023:35028] CHIP:DMG: }
          [1655374218.116505][35023:35028] CHIP:DMG:
          [1655374218.116585][35023:35028] CHIP:DMG: InvokeRequestMessage =
          [1655374218.116614][35023:35028] CHIP:DMG: {
          [1655374218.116640][35023:35028] CHIP:DMG: 	suppressResponse = false,
          [1655374218.116669][35023:35028] CHIP:DMG: 	timedRequest = false,
          [1655374218.116697][35023:35028] CHIP:DMG: 	InvokeRequests =
          [1655374218.116732][35023:35028] CHIP:DMG: 	[
          [1655374218.116759][35023:35028] CHIP:DMG: 		CommandDataIB =
          [1655374218.116790][35023:35028] CHIP:DMG: 		{
          [1655374218.116818][35023:35028] CHIP:DMG: 			CommandPathIB =
          [1655374218.116853][35023:35028] CHIP:DMG: 			{
          [1655374218.116888][35023:35028] CHIP:DMG: 				EndpointId = 0x0,
          [1655374218.116926][35023:35028] CHIP:DMG: 				ClusterId = 0x3e,
          [1655374218.116966][35023:35028] CHIP:DMG: 				CommandId = 0x0,
          [1655374218.117000][35023:35028] CHIP:DMG: 			},
          [1655374218.117037][35023:35028] CHIP:DMG:
          [1655374218.117068][35023:35028] CHIP:DMG: 			CommandFields =
          [1655374218.117103][35023:35028] CHIP:DMG: 			{
          [1655374218.117137][35023:35028] CHIP:DMG: 				0x0 = [
          [1655374218.117184][35023:35028] CHIP:DMG: 					0x76, 0x2b, 0x6b, 0x9d, 0xa0, 0x8f, 0x7f, 0xc6, 0x3b, 0xb6, 0x93, 0xe3, 0x86, 0x34, 0xec, 0x6f, 0x87, 0xce, 0xff, 0x28, 0xab, 0x15, 0x54, 0xa1, 0x6a, 0xd4, 0x3d, 0xce, 0xc2, 0x4c, 0x24, 0x66,
          [1655374218.117223][35023:35028] CHIP:DMG: 			]
          [1655374218.117257][35023:35028] CHIP:DMG: 			},
          [1655374218.117290][35023:35028] CHIP:DMG: 		},
          [1655374218.117323][35023:35028] CHIP:DMG:
          [1655374218.117350][35023:35028] CHIP:DMG: 	],
          [1655374218.117384][35023:35028] CHIP:DMG:
          [1655374218.117410][35023:35028] CHIP:DMG: 	InteractionModelRevision = 1
          [1655374218.117436][35023:35028] CHIP:DMG: },
          [1655374218.117462][35023:35028] CHIP:DMG:
          [1655374218.117597][35023:35028] CHIP:DMG: ICR moving to [CommandSen]
          [1655374218.117635][35023:35028] CHIP:CTL: Sent Attestation request, waiting for the Attestation Information
          [1655374218.117686][35023:35028] CHIP:DMG: ICR moving to [AwaitingDe]
          [1655374218.204040][35023:35028] CHIP:DL: HandlePlatformSpecificBLEEvent 16387
          [1655374218.252180][35023:35026] CHIP:DL: Indication received, conn = 0xffff8003c0c0
          [1655374218.252405][35023:35028] CHIP:DL: HandlePlatformSpecificBLEEvent 16389
          [1655374218.352372][35023:35026] CHIP:DL: Indication received, conn = 0xffff8003c0c0
          [1655374218.352509][35023:35028] CHIP:DL: HandlePlatformSpecificBLEEvent 16389
          [1655374218.450622][35023:35026] CHIP:DL: Indication received, conn = 0xffff8003c0c0
          [1655374218.450870][35023:35028] CHIP:DL: HandlePlatformSpecificBLEEvent 16389
          [1655374218.452138][35023:35028] CHIP:DMG: << from BLE | 224958145 | [Interaction Model  (1) / InvokeCommandResponse (0x09) / Session = 19710 / Exchange = 1302]
          [1655374218.452241][35023:35028] CHIP:DMG: Header Flags =
          [1655374218.452300][35023:35028] CHIP:DMG: {
          [1655374218.452395][35023:35028] CHIP:DMG: }
          [1655374218.452449][35023:35028] CHIP:DMG:
          [1655374218.452521][35023:35028] CHIP:DMG: Encrypted Payload (716 bytes) =
          [1655374218.452579][35023:35028] CHIP:DMG: {
          [1655374218.452634][35023:35028] CHIP:DMG:     data = 00fe4c00c196680d30c5e98d35a6d844102a8b0067edba80e2adf97e28751f8353657dacb7c9706c2c22add28d18adca15378d16af57f0f4092893cfc5d3e85f6e409f70e39bcb9e0bd3397947e927d20e5bf5173e3def7218d0152cf40e7cb16db615efbd282fd6e84c710bd2c7441228eb5dbbcf0dc76a3eaa0b04655f434d3c8223c7016703b8082c9984c3a91432d12271c87f4d09e90cb6e78d07c81d6359cd5a756f2bace60a7a216896949b536e5583f22db64aeae0279ba2fd279813be383e4324ab63472e3d9877f6c9fa539e577dc50fbcc5a7124a14ea78abdd6ada4ec256a3ee0a242747d636215ffab3c8b4291023eb51b3701939e153912b0f5764479b05e1cf472c350304d1ead872295c80fed3a545530f773e729b6f7bd7d5547de03076a72b8855191beb12d8194477bc9798b6177557cccf3b11b2c1f82cee31d451408359650112394dc2c1592cd2eb1e75881aa340885e65ef9a9905947842574ddcac832d68188b0a3a20fb223258d766692b13a6cde0de34d4f9047046d38ad94caf0a9cc7a786c082d5ae8c62346d69684c6ed5ae958ab68c0685922751ff04d922a838c9d2257a7af6e72af524b459a45ea6311431d30c7de32b3d79581ac119d6e7f63a877b53fda9d69256c5870f2af36f74e08b22e1217a0324b772394a4a596ff237331c623b8d7746077826088dddd2a741f19011cde09f1e897f92ac975fd9a157de0b780f6551b11a50ffe12c781f304dbda9dd75465fb3a8ec52d30f7ddb9179f1b9dfe415ae2d66a53bad67bcf27b3351b8a5cdc9e8b54095c81774007237c8a14a3e2c9cf350616cf5ebf7f6ae5a8c77207924b0e1cddc6c7e77c2a514319947c5988af1dd77325259f496293e53041941d45a1355f56b8036008ab696f7d47d17f9fc4890aa78c2811560b7b4d79a460b7dcd3d9bc3bdd5f72d27bb0060f722aa9c22e7d635895404c832bf2371321d1ababa954482c847fedd0d4676bd188365
          [1655374218.452884][35023:35028] CHIP:DMG:     buffer_ptr = 281472627984864
          [1655374218.452941][35023:35028] CHIP:DMG: }
          [1655374218.452992][35023:35028] CHIP:DMG:
          [1655374218.453303][35023:35028] CHIP:DMG: Attestation Elements (585 bytes) =
          [1655374218.453366][35023:35028] CHIP:DMG: {
          [1655374218.453431][35023:35028] CHIP:DMG:     Certification Declaration =
          [1655374218.453483][35023:35028] CHIP:DMG:     {
          [1655374218.455342][35023:35028] CHIP:DMG:         Format Version = 1
          [1655374218.455398][35023:35028] CHIP:DMG:         Vendor Id = 65521
          [1655374218.455438][35023:35028] CHIP:DMG:         Product Ids =
          [1655374218.455474][35023:35028] CHIP:DMG:         {
          [1655374218.455512][35023:35028] CHIP:DMG:             Product Id = 32768
          [1655374218.455552][35023:35028] CHIP:DMG:             Product Id = 32769
          [1655374218.455590][35023:35028] CHIP:DMG:             Product Id = 32770
          [1655374218.455628][35023:35028] CHIP:DMG:             Product Id = 32771
          [1655374218.455666][35023:35028] CHIP:DMG:             Product Id = 32772
          [1655374218.455704][35023:35028] CHIP:DMG:             Product Id = 32773
          [1655374218.455742][35023:35028] CHIP:DMG:             Product Id = 32774
          [1655374218.455780][35023:35028] CHIP:DMG:             Product Id = 32775
          [1655374218.455818][35023:35028] CHIP:DMG:             Product Id = 32776
          [1655374218.455855][35023:35028] CHIP:DMG:             Product Id = 32777
          [1655374218.455893][35023:35028] CHIP:DMG:             Product Id = 32778
          [1655374218.455931][35023:35028] CHIP:DMG:             Product Id = 32779
          [1655374218.455969][35023:35028] CHIP:DMG:             Product Id = 32780
          [1655374218.456007][35023:35028] CHIP:DMG:             Product Id = 32781
          [1655374218.456045][35023:35028] CHIP:DMG:             Product Id = 32782
          [1655374218.456082][35023:35028] CHIP:DMG:             Product Id = 32783
          [1655374218.456120][35023:35028] CHIP:DMG:             Product Id = 32784
          [1655374218.456158][35023:35028] CHIP:DMG:             Product Id = 32785
          [1655374218.456196][35023:35028] CHIP:DMG:             Product Id = 32786
          [1655374218.456234][35023:35028] CHIP:DMG:             Product Id = 32787
          [1655374218.456271][35023:35028] CHIP:DMG:             Product Id = 32788
          [1655374218.456309][35023:35028] CHIP:DMG:             Product Id = 32789
          [1655374218.456347][35023:35028] CHIP:DMG:             Product Id = 32790
          [1655374218.456385][35023:35028] CHIP:DMG:             Product Id = 32791
          [1655374218.456423][35023:35028] CHIP:DMG:             Product Id = 32792
          [1655374218.456461][35023:35028] CHIP:DMG:             Product Id = 32793
          [1655374218.456498][35023:35028] CHIP:DMG:             Product Id = 32794
          [1655374218.456536][35023:35028] CHIP:DMG:             Product Id = 32795
          [1655374218.456573][35023:35028] CHIP:DMG:             Product Id = 32796
          [1655374218.456611][35023:35028] CHIP:DMG:             Product Id = 32797
          [1655374218.456649][35023:35028] CHIP:DMG:             Product Id = 32798
          [1655374218.456687][35023:35028] CHIP:DMG:             Product Id = 32799
          [1655374218.456724][35023:35028] CHIP:DMG:             Product Id = 32800
          [1655374218.456761][35023:35028] CHIP:DMG:             Product Id = 32801
          [1655374218.456799][35023:35028] CHIP:DMG:             Product Id = 32802
          [1655374218.456836][35023:35028] CHIP:DMG:             Product Id = 32803
          [1655374218.456874][35023:35028] CHIP:DMG:             Product Id = 32804
          [1655374218.456912][35023:35028] CHIP:DMG:             Product Id = 32805
          [1655374218.456949][35023:35028] CHIP:DMG:             Product Id = 32806
          [1655374218.456987][35023:35028] CHIP:DMG:             Product Id = 32807
          [1655374218.457024][35023:35028] CHIP:DMG:             Product Id = 32808
          [1655374218.457061][35023:35028] CHIP:DMG:             Product Id = 32809
          [1655374218.457099][35023:35028] CHIP:DMG:             Product Id = 32810
          [1655374218.457138][35023:35028] CHIP:DMG:             Product Id = 32811
          [1655374218.457175][35023:35028] CHIP:DMG:             Product Id = 32812
          [1655374218.457212][35023:35028] CHIP:DMG:             Product Id = 32813
          [1655374218.457250][35023:35028] CHIP:DMG:             Product Id = 32814
          [1655374218.457288][35023:35028] CHIP:DMG:             Product Id = 32815
          [1655374218.457326][35023:35028] CHIP:DMG:             Product Id = 32816
          [1655374218.457363][35023:35028] CHIP:DMG:             Product Id = 32817
          [1655374218.457401][35023:35028] CHIP:DMG:             Product Id = 32818
          [1655374218.457439][35023:35028] CHIP:DMG:             Product Id = 32819
          [1655374218.457476][35023:35028] CHIP:DMG:             Product Id = 32820
          [1655374218.457514][35023:35028] CHIP:DMG:             Product Id = 32821
          [1655374218.457552][35023:35028] CHIP:DMG:             Product Id = 32822
          [1655374218.457590][35023:35028] CHIP:DMG:             Product Id = 32823
          [1655374218.457627][35023:35028] CHIP:DMG:             Product Id = 32824
          [1655374218.457665][35023:35028] CHIP:DMG:             Product Id = 32825
          [1655374218.457702][35023:35028] CHIP:DMG:             Product Id = 32826
          [1655374218.457740][35023:35028] CHIP:DMG:             Product Id = 32827
          [1655374218.457777][35023:35028] CHIP:DMG:             Product Id = 32828
          [1655374218.457833][35023:35028] CHIP:DMG:             Product Id = 32829
          [1655374218.457874][35023:35028] CHIP:DMG:             Product Id = 32830
          [1655374218.457912][35023:35028] CHIP:DMG:             Product Id = 32831
          [1655374218.457950][35023:35028] CHIP:DMG:             Product Id = 32832
          [1655374218.457987][35023:35028] CHIP:DMG:             Product Id = 32833
          [1655374218.458026][35023:35028] CHIP:DMG:             Product Id = 32834
          [1655374218.458063][35023:35028] CHIP:DMG:             Product Id = 32835
          [1655374218.458101][35023:35028] CHIP:DMG:             Product Id = 32836
          [1655374218.458139][35023:35028] CHIP:DMG:             Product Id = 32837
          [1655374218.458177][35023:35028] CHIP:DMG:             Product Id = 32838
          [1655374218.458215][35023:35028] CHIP:DMG:             Product Id = 32839
          [1655374218.458253][35023:35028] CHIP:DMG:             Product Id = 32840
          [1655374218.458291][35023:35028] CHIP:DMG:             Product Id = 32841
          [1655374218.458328][35023:35028] CHIP:DMG:             Product Id = 32842
          [1655374218.458366][35023:35028] CHIP:DMG:             Product Id = 32843
          [1655374218.458404][35023:35028] CHIP:DMG:             Product Id = 32844
          [1655374218.458441][35023:35028] CHIP:DMG:             Product Id = 32845
          [1655374218.458480][35023:35028] CHIP:DMG:             Product Id = 32846
          [1655374218.458517][35023:35028] CHIP:DMG:             Product Id = 32847
          [1655374218.458555][35023:35028] CHIP:DMG:             Product Id = 32848
          [1655374218.458592][35023:35028] CHIP:DMG:             Product Id = 32849
          [1655374218.458630][35023:35028] CHIP:DMG:             Product Id = 32850
          [1655374218.458667][35023:35028] CHIP:DMG:             Product Id = 32851
          [1655374218.458706][35023:35028] CHIP:DMG:             Product Id = 32852
          [1655374218.458743][35023:35028] CHIP:DMG:             Product Id = 32853
          [1655374218.458781][35023:35028] CHIP:DMG:             Product Id = 32854
          [1655374218.458818][35023:35028] CHIP:DMG:             Product Id = 32855
          [1655374218.458856][35023:35028] CHIP:DMG:             Product Id = 32856
          [1655374218.458893][35023:35028] CHIP:DMG:             Product Id = 32857
          [1655374218.458932][35023:35028] CHIP:DMG:             Product Id = 32858
          [1655374218.458969][35023:35028] CHIP:DMG:             Product Id = 32859
          [1655374218.459007][35023:35028] CHIP:DMG:             Product Id = 32860
          [1655374218.459045][35023:35028] CHIP:DMG:             Product Id = 32861
          [1655374218.459082][35023:35028] CHIP:DMG:             Product Id = 32862
          [1655374218.459120][35023:35028] CHIP:DMG:             Product Id = 32863
          [1655374218.459159][35023:35028] CHIP:DMG:             Product Id = 32864
          [1655374218.459196][35023:35028] CHIP:DMG:             Product Id = 32865
          [1655374218.459234][35023:35028] CHIP:DMG:             Product Id = 32866
          [1655374218.459271][35023:35028] CHIP:DMG:             Product Id = 32867
          [1655374218.459309][35023:35028] CHIP:DMG:         }
          [1655374218.459347][35023:35028] CHIP:DMG:         Device Type Id = 22
          [1655374218.459390][35023:35028] CHIP:DMG:         Certificate Id (19) = ZIG20142ZB330003-24
          [1655374218.459430][35023:35028] CHIP:DMG:         Security Level = 0
          [1655374218.459470][35023:35028] CHIP:DMG:         Security Information = 0
          [1655374218.459508][35023:35028] CHIP:DMG:         Version Number = 9876
          [1655374218.459546][35023:35028] CHIP:DMG:         Certification Type = 0
          [1655374218.459584][35023:35028] CHIP:DMG:     }
          [1655374218.459627][35023:35028] CHIP:DMG:     Attestation Nonce (32) = 762B6B9DA08F7FC63BB693E38634EC6F87CEFF28AB1554A16AD43DCEC24C2466
          [1655374218.459664][35023:35028] CHIP:DMG:     Timestamp = 0
          [1655374218.459699][35023:35028] CHIP:DMG: }
          [1655374218.459732][35023:35028] CHIP:DMG:
          [1655374218.459776][35023:35028] CHIP:DMG:
          [1655374218.459846][35023:35028] CHIP:DMG: Additional Fields =
          [1655374218.459884][35023:35028] CHIP:DMG: {
          [1655374218.459924][35023:35028] CHIP:DMG:     peer_address = BLE
          [1655374218.459960][35023:35028] CHIP:DMG: }
          [1655374218.459993][35023:35028] CHIP:DMG:
          [1655374218.460045][35023:35028] CHIP:EM: Received message of type 0x9 with protocolId (0, 1) and MessageCounter:224958145 on exchange 1302i
          [1655374218.460090][35023:35028] CHIP:EM: Found matching exchange: 1302i, Delegate: 0xffff74005ab0
          [1655374218.460157][35023:35028] CHIP:DMG: ICR moving to [ResponseRe]
          [1655374218.460220][35023:35028] CHIP:DMG: InvokeResponseMessage =
          [1655374218.460260][35023:35028] CHIP:DMG: {
          [1655374218.460298][35023:35028] CHIP:DMG: 	suppressResponse = false,
          [1655374218.460338][35023:35028] CHIP:DMG: 	InvokeResponseIBs =
          [1655374218.460390][35023:35028] CHIP:DMG: 	[
          [1655374218.460430][35023:35028] CHIP:DMG: 		InvokeResponseIB =
          [1655374218.460487][35023:35028] CHIP:DMG: 		{
          [1655374218.460530][35023:35028] CHIP:DMG: 			CommandDataIB =
          [1655374218.460580][35023:35028] CHIP:DMG: 			{
          [1655374218.460628][35023:35028] CHIP:DMG: 				CommandPathIB =
          [1655374218.460686][35023:35028] CHIP:DMG: 				{
          [1655374218.460745][35023:35028] CHIP:DMG: 					EndpointId = 0x0,
          [1655374218.460802][35023:35028] CHIP:DMG: 					ClusterId = 0x3e,
          [1655374218.460852][35023:35028] CHIP:DMG: 					CommandId = 0x1,
          [1655374218.460906][35023:35028] CHIP:DMG: 				},
          [1655374218.460962][35023:35028] CHIP:DMG:
          [1655374218.461010][35023:35028] CHIP:DMG: 				CommandFields =
          [1655374218.461068][35023:35028] CHIP:DMG: 				{
          [1655374218.461123][35023:35028] CHIP:DMG: 					0x0 = [
          [1655374218.461351][35023:35028] CHIP:DMG: 						0x15, 0x31, 0x1, 0x1d, 0x2, 0x30, 0x82, 0x2, 0x19, 0x6, 0x9, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0xd, 0x1, 0x7, 0x2, 0xa0, 0x82, 0x2, 0xa, 0x30, 0x82, 0x2, 0x6, 0x2, 0x1, 0x3, 0x31, 0xd, 0x30, 0xb, 0x6, 0x9, 0x60, 0x86, 0x48, 0x1, 0x65, 0x3, 0x4, 0x2, 0x1, 0x30, 0x82, 0x1, 0x71, 0x6, 0x9, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0xd, 0x1, 0x7, 0x1, 0xa0, 0x82, 0x1, 0x62, 0x4, 0x82, 0x1, 0x5e, 0x15, 0x24, 0x0, 0x1, 0x25, 0x1, 0xf1, 0xff, 0x36, 0x2, 0x5, 0x0, 0x80, 0x5, 0x1, 0x80, 0x5, 0x2, 0x80, 0x5, 0x3, 0x80, 0x5, 0x4, 0x80, 0x5, 0x5, 0x80, 0x5, 0x6, 0x80, 0x5, 0x7, 0x80, 0x5, 0x8, 0x80, 0x5, 0x9, 0x80, 0x5, 0xa, 0x80, 0x5, 0xb, 0x80, 0x5, 0xc, 0x80, 0x5, 0xd, 0x80, 0x5, 0xe, 0x80, 0x5, 0xf, 0x80, 0x5, 0x10, 0x80, 0x5, 0x11, 0x80, 0x5, 0x12, 0x80, 0x5, 0x13, 0x80, 0x5, 0x14, 0x80, 0x5, 0x15, 0x80, 0x5, 0x16, 0x80, 0x5, 0x17, 0x80, 0x5, 0x18, 0x80, 0x5, 0x19, 0x80, 0x5, 0x1a, 0x80, 0x5, 0x1b, 0x80, 0x5, 0x1c, 0x80, 0x5, 0x1d, 0x80, 0x5, 0x1e, 0x80, 0x5, 0x1f, 0x80, 0x5, 0x20, 0x80, 0x5, 0x21, 0x80, 0x5, 0x22, 0x80, 0x5, 0x23, 0x80, 0x5, 0x24, 0x80, 0x5, 0x25, 0x80, 0x5, 0x26, 0x80, 0x5, 0x27, 0x80, 0x5, 0x28, 0x80, 0x5, 0x29, 0x80, 0x5, 0x2a, 0x80, 0x5, 0x2b, 0x80, 0x5, 0x2c, 0x80, 0x5, 0x2d, 0x80, 0x5, 0x2e, 0x80, 0x5, 0x2f, 0x80, 0x5, 0x30, 0x80, 0x5, 0x31, 0x80, 0x5, 0x32, 0x80, 0x5, 0x33, 0x80, 0x5, 0x34, 0x80, 0x5, 0x35, 0x80, 0x5, 0x36, 0x80, 0x5, 0x37, 0x80, 0x5, 0x38, 0x80, 0x5, 0x39, 0x80, 0x5, 0x3a, 0x80, 0x5, 0x3b, 0x80, 0x5, 0x3c, 0x80, 0x5, 0x3d, 0x80, 0x5, 0x3e, 0x80, 0x5, 0x3f, 0x80, 0x5, 0x40, 0x80, 0x5, 0x41, 0x80, 0x5, 0x42, 0x80, 0x5, 0x43, 0x80, 0x5, 0x44, 0x80, 0x5, 0x45, 0x80, 0x5, 0x46, 0x80, 0x5, 0x47, 0x80, 0x5, 0x48, 0x80, 0x5, 0x49, 0x80, 0x5, 0x4a, 0x80, 0x5, 0x
          [1655374218.461469][35023:35028] CHIP:DMG: 				]
          [1655374218.461523][35023:35028] CHIP:DMG: 					0x1 = [
          [1655374218.461611][35023:35028] CHIP:DMG: 						0xd6, 0x91, 0x3d, 0x0, 0x37, 0xd3, 0x23, 0x11, 0xa9, 0xe6, 0x23, 0xe3, 0xb0, 0x80, 0x27, 0x71, 0xc2, 0xb1, 0xdc, 0xe1, 0xb8, 0x95, 0x7c, 0x88, 0x92, 0xc6, 0x84, 0xe4, 0x21, 0xa2, 0x87, 0x22, 0x6d, 0xeb, 0x42, 0x82, 0x67, 0xe0, 0x9c, 0x17, 0xb1, 0x1c, 0x1, 0xff, 0x8b, 0xff, 0x23, 0x47, 0xc4, 0xe7, 0x6, 0x1d, 0x8f, 0x1e, 0x26, 0x8e, 0xad, 0xbd, 0xc9, 0x9e, 0x23, 0x88, 0xdb, 0xb6,
          [1655374218.461681][35023:35028] CHIP:DMG: 				]
          [1655374218.461733][35023:35028] CHIP:DMG: 				},
          [1655374218.461783][35023:35028] CHIP:DMG: 			},
          [1655374218.461855][35023:35028] CHIP:DMG:
          [1655374218.461900][35023:35028] CHIP:DMG: 		},
          [1655374218.461951][35023:35028] CHIP:DMG:
          [1655374218.461990][35023:35028] CHIP:DMG: 	],
          [1655374218.462041][35023:35028] CHIP:DMG:
          [1655374218.462080][35023:35028] CHIP:DMG: 	InteractionModelRevision = 1
          [1655374218.462118][35023:35028] CHIP:DMG: },
          [1655374218.462220][35023:35028] CHIP:DMG: Received Command Response Data, Endpoint=0 Cluster=0x0000_003E Command=0x0000_0001
          [1655374218.462275][35023:35028] CHIP:CTL: Received Attestation Information from the device
          [1655374218.462320][35023:35028] CHIP:CTL: Successfully finished commissioning step 'SendAttestationRequest'
      disabled: true

    - label: "TH1 generates 32-byte CSRNonce"
      verification: |
          Verify in TH log

          [1655374218.694869][35023:35028] CHIP:DMG: NOCSR Elements =
          [1655374218.694922][35023:35028] CHIP:DMG: {
          [1655374218.695009][35023:35028] CHIP:DMG:     CSR (203) = 3081C83070020100300E310C300A060355040A0C034353523059301306072A8648CE3D020106082A8648CE3D03010703420004FD1662E0C1F44C5BD8A284452ED17C631CA88697CBF396EB765397315ED248729BFC7DE464404B1FA34B2DD81714E2484B8E908121BB95DFDA4493D5CDDA797AA000300A06082A8648CE3D0403020348003045022100832718B8679DB2C9A26579F08D930F7DA747F6F23EE2DD11777FBF1191909FD3022073E039F63AEA4C1BF812AE65221CB09203FF1BD382872FB37478C2C4045FD8B8
          [1655374218.695086][35023:35028] CHIP:DMG:     CSRNonce (32) = 79964F34E68A97E41DBDFE7888583183535EDC3A185AF99941BDA4C5A65FDA39
          [1655374218.695133][35023:35028] CHIP:DMG: }
      disabled: true

    - label: "TH1 sends CSRRequest Command with CSRNonce as field to the DUT."
      verification: |
          Verify in TH log

          [1655374218.694869][35023:35028] CHIP:DMG: NOCSR Elements =
          [1655374218.694922][35023:35028] CHIP:DMG: {
          [1655374218.695009][35023:35028] CHIP:DMG:     CSR (203) = 3081C83070020100300E310C300A060355040A0C034353523059301306072A8648CE3D020106082A8648CE3D03010703420004FD1662E0C1F44C5BD8A284452ED17C631CA88697CBF396EB765397315ED248729BFC7DE464404B1FA34B2DD81714E2484B8E908121BB95DFDA4493D5CDDA797AA000300A06082A8648CE3D0403020348003045022100832718B8679DB2C9A26579F08D930F7DA747F6F23EE2DD11777FBF1191909FD3022073E039F63AEA4C1BF812AE65221CB09203FF1BD382872FB37478C2C4045FD8B8
          [1655374218.695086][35023:35028] CHIP:DMG:     CSRNonce (32) = 79964F34E68A97E41DBDFE7888583183535EDC3A185AF99941BDA4C5A65FDA39
          [1655374218.695133][35023:35028] CHIP:DMG: }
      disabled: true

    - label:
          "Save following information that is sent by the DUT in the CSRResponse
          Command NOCSRElement Node Operational Key Pair as Key 1"
      verification: |
          Verify in TH log

          [1655374218.694869][35023:35028] CHIP:DMG: NOCSR Elements =
          [1655374218.694922][35023:35028] CHIP:DMG: {
          [1655374218.695009][35023:35028] CHIP:DMG:     CSR (203) = 3081C83070020100300E310C300A060355040A0C034353523059301306072A8648CE3D020106082A8648CE3D03010703420004FD1662E0C1F44C5BD8A284452ED17C631CA88697CBF396EB765397315ED248729BFC7DE464404B1FA34B2DD81714E2484B8E908121BB95DFDA4493D5CDDA797AA000300A06082A8648CE3D0403020348003045022100832718B8679DB2C9A26579F08D930F7DA747F6F23EE2DD11777FBF1191909FD3022073E039F63AEA4C1BF812AE65221CB09203FF1BD382872FB37478C2C4045FD8B8
          [1655374218.695086][35023:35028] CHIP:DMG:     CSRNonce (32) = 79964F34E68A97E41DBDFE7888583183535EDC3A185AF99941BDA4C5A65FDA39
          [1655374218.695133][35023:35028] CHIP:DMG: }
      disabled: true

    - label:
          "TH1 sends AddTrustedRootCertificate command to DUT to install the
          Root CA Certificate to the trust store"
      verification: |
          1. ./chip-tool generalcommissioning arm-fail-safe 500 600 1 0

          2. ./chip-tool operationalcredentials  add-trusted-root-certificate 1530010100240201370324140018260480228127260580254D3A37062414001824070124080130094104277CAFBA69B2C219DF198735F27E3874019F75812933BC737FF8BA660902FE97D212E925D0B53B0755C52B3CDCAC9B797C2B452ED76D9B5F348A0586043857F3370A3501290118240260300414CD47A91F241CF86E4CE627568ACD47BB3A25C106300514CD47A91F241CF86E4CE627568ACD47BB3A25C10618300B40A937FE4F3921D229051DF5F5D3EEBD52A5012405D15EBA8A7542B9F54D33D406DF0F09247529012 1 0




          [1655374218.706390][35023:35028] CHIP:DMG:                         CommandFields =
          [1655374218.706431][35023:35028] CHIP:DMG:                         {
          [1655374218.706464][35023:35028] CHIP:DMG:                                 0x0 = [
          [1655374218.706591][35023:35028] CHIP:DMG:                                         0x15, 0x30, 0x1, 0x1, 0x0, 0x24, 0x2, 0x1, 0x37, 0x3, 0x24, 0x14, 0x0, 0x18, 0x26, 0x4, 0x80, 0x22, 0x81, 0x27, 0x26, 0x5, 0x80, 0x25, 0x4d, 0x3a, 0x37, 0x6, 0x24, 0x14, 0x0, 0x18, 0x24, 0x7, 0x1, 0x24, 0x8, 0x1, 0x30, 0x9, 0x41, 0x4, 0xab, 0xae, 0x5e, 0xc6, 0x4f, 0xc4, 0x6e, 0x99, 0xc, 0x44, 0x55, 0x39, 0x2, 0x45, 0xf6, 0xe9, 0x9, 0xcb, 0xc3, 0xc3, 0xc, 0xa0, 0x8, 0xb7, 0x36, 0x96, 0x62, 0x56, 0x43, 0x56, 0xba, 0x22, 0x25, 0x38, 0x6f, 0x40, 0x50, 0xf8, 0x7b, 0xd1, 0xd7, 0xe4, 0xd6, 0x5c, 0x12, 0x30, 0x84, 0x91, 0xb3, 0x10, 0x8f, 0x6a, 0x71, 0x8, 0xe1, 0xf0, 0xc3, 0xa0, 0xd2, 0x4, 0x99, 0xe3, 0xfb, 0xf, 0x37, 0xa, 0x35, 0x1, 0x29, 0x1, 0x18, 0x24, 0x2, 0x60, 0x30, 0x4, 0x14, 0x89, 0x4f, 0x8f, 0xdd, 0xf2, 0x13, 0x8d, 0x8e, 0xe0, 0x12, 0x13, 0x72, 0xa2, 0xb4, 0x23, 0x25, 0xef, 0xd6, 0x25, 0x8c, 0x30, 0x5, 0x14, 0x89, 0x4f, 0x8f, 0xdd, 0xf2, 0x13, 0x8d, 0x8e, 0xe0, 0x12, 0x13, 0x72, 0xa2, 0xb4, 0x23, 0x25, 0xef, 0xd6, 0x25, 0x8c, 0x18, 0x30, 0xb, 0x40, 0xd3, 0x8f, 0x56, 0xa2, 0xd9, 0xb4, 0x4a, 0x3a, 0x79, 0x6d, 0xed, 0xd7, 0x1c, 0x7a, 0x3e, 0xd6, 0xb9, 0x8d, 0x80, 0xd6, 0x3d, 0xe2, 0xde, 0xa5, 0xb0, 0x3b, 0xc0, 0xce, 0x1a, 0xe9, 0x26, 0x0, 0x9d, 0x9c, 0x78, 0xe4, 0xf3, 0x78, 0x74, 0x3a, 0xd, 0xfa, 0xc8, 0x1f, 0x27, 0xaa, 0x5e, 0x9b, 0xef, 0x78, 0x48, 0x1e, 0x6a, 0x60, 0x1a, 0x71, 0xd8, 0x67, 0x9, 0x40, 0xb3, 0xe4, 0xd0, 0xc6, 0x18,

          Verify we are getting success response
          [1655371172.014771][2459:2464] CHIP:DMG: InvokeResponseMessage =
          [1655371172.014797][2459:2464] CHIP:DMG: {
          [1655371172.014822][2459:2464] CHIP:DMG:         suppressResponse = false,
          [1655371172.014854][2459:2464] CHIP:DMG:         InvokeResponseIBs =
          [1655371172.014889][2459:2464] CHIP:DMG:         [
          [1655371172.014914][2459:2464] CHIP:DMG:                 InvokeResponseIB =
          [1655371172.014959][2459:2464] CHIP:DMG:                 {
          [1655371172.014989][2459:2464] CHIP:DMG:                         CommandStatusIB =
          [1655371172.015024][2459:2464] CHIP:DMG:                         {
          [1655371172.015055][2459:2464] CHIP:DMG:                                 CommandPathIB =
          [1655371172.015090][2459:2464] CHIP:DMG:                                 {
          [1655371172.015125][2459:2464] CHIP:DMG:                                         EndpointId = 0x0,
          [1655371172.015161][2459:2464] CHIP:DMG:                                         ClusterId = 0x3e,
          [1655371172.015196][2459:2464] CHIP:DMG:                                         CommandId = 0xb,
          [1655371172.015229][2459:2464] CHIP:DMG:                                 },
          [1655371172.015266][2459:2464] CHIP:DMG:
          [1655371172.015297][2459:2464] CHIP:DMG:                                 StatusIB =
          [1655371172.015332][2459:2464] CHIP:DMG:                                 {
          [1655371172.015366][2459:2464] CHIP:DMG:                                         status = 0x00 (SUCCESS),
          [1655371172.015399][2459:2464] CHIP:DMG:                                 },
          [1655371172.015433][2459:2464] CHIP:DMG:
          [1655371172.015464][2459:2464] CHIP:DMG:                         },
          [1655371172.015498][2459:2464] CHIP:DMG:
          [1655371172.015527][2459:2464] CHIP:DMG:                 },
          [1655371172.015560][2459:2464] CHIP:DMG:
          [1655371172.015584][2459:2464] CHIP:DMG:         ],
          [1655371172.015614][2459:2464] CHIP:DMG:
          [1655371172.015639][2459:2464] CHIP:DMG:         InteractionModelRevision = 1
          [1655371172.015665][2459:2464] CHIP:DMG: },
          [1655371172.015725][2459:2464] CHIP:DMG: Received Command Response Status for Endpoint=0 Cluster=0x0000_003E Command=0x0000_000B Status=0x0
          [1655371172.015770][2459:2464] CHIP:DMG: ICR moving to [AwaitingDe]
      disabled: true

    - label: "TH1 Sends AddNOC Command to DUT"
      verification: |
          https://github.com/project-chip/connectedhomeip/issues/19068
      disabled: true

    - label: "Read the NOCs List from the DUT"
      verification: |
          ./chip-tool operationalcredentials read nocs 1 0

          [1655470923.441130][13282:13287] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Attribute 0x0000_0000 DataVersion: 2667297991
          [1655470923.441223][13282:13287] CHIP:TOO:   NOCs: 1 entries
          [1655470923.441297][13282:13287] CHIP:TOO:     [1]: {
          [1655470923.441352][13282:13287] CHIP:TOO:       Noc: 1530010101240201370324130118260480228127260580254D3A37062415012411011824070124080130094104D5FA104FF03F9118BDC2A072D50DB3BED32C47F138439FBF05753D02D01AEC10F350CB77EA22844A83FF0FEF6CFA764F5B1FD48E487F3EC82A201D376F56DCC8370A350128011824020136030402040118300414BD61F9405A7A15EFA38F8B6833AB9027876482E1300514B5AED0B2C2CDBB9D4D0124755B56278B081FD4AD18300B40441AA0EE6ACE43EEA2A52321821D8B260AAFFEBD394C2FD11E83008C5AD2DF5EA58FAFA14A3EF7BAFDE190591298311D7DE6A257819D98D0E9FE239A635684B418
          [1655470923.441411][13282:13287] CHIP:TOO:       Icac: 1530010100240201370324140018260480228127260580254D3A37062413011824070124080130094104B267483D9981A2C15E7DE8C63298FEB6DC19EAA9AEA41D9D659CD3BBBD25B943B3186716C82B297091D64B1620E8FB2C6FD095F509684E074C5B479E583CE295370A3501290118240260300414B5AED0B2C2CDBB9D4D0124755B56278B081FD4AD3005146EDE812590A5E6E4463798EB06AC3BD5284DFAAE18300B404A48E0B45704A98739C0C656B0F1A4252AEED8E1EBA5FD1032C79A4B26BF8A314EFDD7C835947DEB4B3E9F6D0BF2A561CEE54B45F311773301D4B5CFFF2F76D918
          [1655470923.441453][13282:13287] CHIP:TOO:       FabricIndex: 1
          [1655470923.441486][13282:13287] CHIP:TOO:      }
      disabled: true

    - label: "Factory Reset TH1 so that it is commissionable again"
      verification: |
          DUT side:
          sudo rm -rf /tmp/chip_*
      disabled: true

    - label:
          "Start the commissioning process of TH1 on DUT. Device attestation
          procedure is completed"
      verification: |
          sudo ./chip-all-clusters-app --wifi

          TH side:
          ./chip-tool pairing ble-wifi 1 zigbeehome matter123 20202021 3841 --trace_decode 1

          [1650455358.501816][4366:4371] CHIP:TOO: Device commissioning completed with success"""
      disabled: true

    - label: "TH1 generates 32-byte CSRNonce"
      verification: |
          Verify in TH log


          [1655968443.868940][21387:21392] CHIP:DMG: NOCSR Elements =
          [1655968443.869000][21387:21392] CHIP:DMG: {
          [1655968443.869077][21387:21392] CHIP:DMG:     CSR (204) = 3081C93070020100300E310C300A060355040A0C034353523059301306072A8648CE3D020106082A8648CE3D030107034200041DC0424E5FE9BC13997CE5D29A61C944BFC808923E8656D801A44D25E3DAFC093FB2B175CFF1588CF68090FE2C3172975CA6874E7CF85FBA26C8F46FF0F5F453A000300A06082A8648CE3D04030203490030460221008A1C12FCDF67D97C99ED87AFE5A0F49321DCF6EB42D05AA286359CCFD206C120022100E66C05339B4517D143ADF9D1AB65AD14BC6D2E804AF073C25FDF6569C39E393F
          [1655968443.869145][21387:21392] CHIP:DMG:     CSRNonce (32) = 6FD841CB599C51208A19018F5C0BC970BA0A9303B07A2F2FB8ED77EF809B90A9
          [1655968443.869265][21387:21392] CHIP:DMG: }
          [1655968443.869316][21387:21392] CHIP:DMG:
          [1655968443.869367][21387:21392] CHIP:DMG: CSR (204) =
          [1655968443.869451][21387:21392] CHIP:DMG: {
          -----BEGIN CERTIFICATE REQUEST-----
          MIHJMHACAQAwDjEMMAoGA1UECgwDQ1NSMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcD
          QgAEHcBCTl/pvBOZfOXSmmHJRL/ICJI+hlbYAaRNJePa/Ak/srF1z/FYjPaAkP4s
          MXKXXKaHTnz4X7omyPRv8PX0U6AAMAoGCCqGSM49BAMCA0kAMEYCIQCKHBL832fZ
          fJnth6/loPSTIdz260LQWqKGNZzP0gbBIAIhAOZsBTObRRfRQ6350atlrRS8bS6A
          SvBzwl/fZWnDnjk/
          -----END CERTIFICATE REQUEST-----
      disabled: true

    - label: "TH1 sends CSRRequest Command with CSRNonce as field to the DUT."
      verification: |
          Verify in TH log

          [1655968443.653325][21387:21392] CHIP:CTL: Sending CSR request to 0xffff88000b60 device
          [1655968443.653468][21387:21392] CHIP:DMG: ICR moving to [AddingComm]
          [1655968443.653547][21387:21392] CHIP:DMG: ICR moving to [AddedComma]
          [1655968443.654120][21387:21392] CHIP:IN: Prepared secure message 0xffff9afdc028 to 0xFFFFFFFB00000000 (0)  of type 0x8 and protocolId (0, 1) on exchange 11675i with MessageCounter:162800415.
          [1655968443.654238][21387:21392] CHIP:IN: Sending encrypted msg 0xffff9afdc028 with MessageCounter:162800415 to 0xFFFFFFFB00000000 (0) at monotonic time: 00000000059CF5E5 msec
          [1655968443.654746][21387:21392] CHIP:DMG: >> to BLE | 162800415 | [Interaction Model  (1) / InvokeCommandRequest (0x08) / Session = 52324 / Exchange = 11675]
          [1655968443.654843][21387:21392] CHIP:DMG: Header Flags =
          [1655968443.654899][21387:21392] CHIP:DMG: {
          [1655968443.654984][21387:21392] CHIP:DMG:     Exchange (0x01) =
          [1655968443.655039][21387:21392] CHIP:DMG:     {
          [1655968443.655087][21387:21392] CHIP:DMG:         Initiator = true
          [1655968443.655139][21387:21392] CHIP:DMG:     }
          [1655968443.655207][21387:21392] CHIP:DMG: }
          [1655968443.655260][21387:21392] CHIP:DMG:
          [1655968443.655328][21387:21392] CHIP:DMG: Encrypted Payload (94 bytes) =
          [1655968443.655382][21387:21392] CHIP:DMG: {
          [1655968443.655435][21387:21392] CHIP:DMG:     data = 0064cc001f23b4098ca07591c210364800feb2c612bb0e4d2ebab7ad8296c308a560bcbc8617bec763775fe04f8158deec052be5110c79734b9d561a9f0f50bac052c4a9a323e175e359c946b335cefd5e99f8edfdeee3234f2c73e6a3b0
          [1655968443.655492][21387:21392] CHIP:DMG:     buffer_ptr = 281472963536976
          [1655968443.655543][21387:21392] CHIP:DMG: }
          [1655968443.655592][21387:21392] CHIP:DMG:
          [1655968443.655754][21387:21392] CHIP:DMG: InvokeRequestMessage =
          [1655968443.655821][21387:21392] CHIP:DMG: {
          [1655968443.655878][21387:21392] CHIP:DMG: 	suppressResponse = false,
          [1655968443.655947][21387:21392] CHIP:DMG: 	timedRequest = false,
          [1655968443.656007][21387:21392] CHIP:DMG: 	InvokeRequests =
          [1655968443.656082][21387:21392] CHIP:DMG: 	[
          [1655968443.656142][21387:21392] CHIP:DMG: 		CommandDataIB =
          [1655968443.656217][21387:21392] CHIP:DMG: 		{
          [1655968443.656288][21387:21392] CHIP:DMG: 			CommandPathIB =
          [1655968443.656375][21387:21392] CHIP:DMG: 			{
          [1655968443.656458][21387:21392] CHIP:DMG: 				EndpointId = 0x0,
          [1655968443.656549][21387:21392] CHIP:DMG: 				ClusterId = 0x3e,
          [1655968443.656639][21387:21392] CHIP:DMG: 				CommandId = 0x4,
          [1655968443.656725][21387:21392] CHIP:DMG: 			},
          [1655968443.656814][21387:21392] CHIP:DMG:
          [1655968443.656886][21387:21392] CHIP:DMG: 			CommandFields =
          [1655968443.656971][21387:21392] CHIP:DMG: 			{
          [1655968443.657106][21387:21392] CHIP:DMG: 				0x0 = [
          [1655968443.657246][21387:21392] CHIP:DMG: 						0x6f, 0xd8, 0x41, 0xcb, 0x59, 0x9c, 0x51, 0x20, 0x8a, 0x19, 0x1, 0x8f, 0x5c, 0xb, 0xc9, 0x70, 0xba, 0xa, 0x93, 0x3, 0xb0, 0x7a, 0x2f, 0x2f, 0xb8, 0xed, 0x77, 0xef, 0x80, 0x9b, 0x90, 0xa9,
          [1655968443.657364][21387:21392] CHIP:DMG: 				]
          [1655968443.657448][21387:21392] CHIP:DMG: 			},
          [1655968443.657528][21387:21392] CHIP:DMG: 		},
          [1655968443.657607][21387:21392] CHIP:DMG:
          [1655968443.657666][21387:21392] CHIP:DMG: 	],
          [1655968443.657738][21387:21392] CHIP:DMG:
          [1655968443.657798][21387:21392] CHIP:DMG: 	InteractionModelRevision = 1
          [1655968443.657855][21387:21392] CHIP:DMG: },
          [1655968443.657910][21387:21392] CHIP:DMG:
          [1655968443.658186][21387:21392] CHIP:DMG: ICR moving to [CommandSen]
          [1655968443.658271][21387:21392] CHIP:CTL: Sent CSR request, waiting for the CSR
          [1655968443.658392][21387:21392] CHIP:DMG: ICR moving to [AwaitingDe]
          [1655968443.766979][21387:21392] CHIP:DL: HandlePlatformSpecificBLEEvent 16387
          [1655968443.770604][21387:21390] CHIP:DL: Indication received, conn = 0xffff900200d0
          [1655968443.770857][21387:21392] CHIP:DL: HandlePlatformSpecificBLEEvent 16389
          [1655968443.866712][21387:21390] CHIP:DL: Indication received, conn = 0xffff900200d0
          [1655968443.866976][21387:21392] CHIP:DL: HandlePlatformSpecificBLEEvent 16389
          [1655968443.868071][21387:21392] CHIP:DMG: << from BLE | 163275441 | [Interaction Model  (1) / InvokeCommandResponse (0x09) / Session = 42825 / Exchange = 11675]
          [1655968443.868171][21387:21392] CHIP:DMG: Header Flags =
          [1655968443.868227][21387:21392] CHIP:DMG: {
          [1655968443.868322][21387:21392] CHIP:DMG: }
          [1655968443.868377][21387:21392] CHIP:DMG:
          [1655968443.868444][21387:21392] CHIP:DMG: Encrypted Payload (374 bytes) =
          [1655968443.868498][21387:21392] CHIP:DMG: {
          [1655968443.868550][21387:21392] CHIP:DMG:     data = 0049a700b162bb098738968b1939ee14f928225366b2f4bc5fff780dab81f2424266d6ec5fb570726f9c64f4c64fcc381c2808d65f9713f1b21ca51167d88d161472a02a68a9b058418ac1e9b7aa3e2d6529501ef0f2000cfe93904b1f9942e92c306ba26a6eaf89aedf134eae1c455c18f55686bac675659602c6f9a766adb495975515815f4560bcb2553bc33ecbd6024463121d7553a64cdbb016b8e39f394b05bcd5b1f067ffd7186f40e276b2bc1fa0a7b1059312d5af443b7661e31995eb71c7962899506868ff6c55ca4f2b73e98a5a55037384067795c479eed0f28f98e9863904ecb1093aea2ba2d41e39fdfa4e87c0c3b49996781a32c87d56d56086e2eb046e18837e56651a4b52544fff9a7715d5459edef0071a95ab0ce6da21846632be497f827a2808b25466c9bd0cde20b1f56341d4c28319cee5570d0937f873c7a5cae6702aae36f5046265989d37b8f14e6b3b30c2b6536e1fb80f2eb92466a8c8fe562f77bca17a57ddc8b35138f685b64a16
          [1655968443.868623][21387:21392] CHIP:DMG:     buffer_ptr = 281472963520464
          [1655968443.868673][21387:21392] CHIP:DMG: }
          [1655968443.868722][21387:21392] CHIP:DMG:
          [1655968443.868940][21387:21392] CHIP:DMG: NOCSR Elements =
          [1655968443.869000][21387:21392] CHIP:DMG: {
          [1655968443.869077][21387:21392] CHIP:DMG:     CSR (204) = 3081C93070020100300E310C300A060355040A0C034353523059301306072A8648CE3D020106082A8648CE3D030107034200041DC0424E5FE9BC13997CE5D29A61C944BFC808923E8656D801A44D25E3DAFC093FB2B175CFF1588CF68090FE2C3172975CA6874E7CF85FBA26C8F46FF0F5F453A000300A06082A8648CE3D04030203490030460221008A1C12FCDF67D97C99ED87AFE5A0F49321DCF6EB42D05AA286359CCFD206C120022100E66C05339B4517D143ADF9D1AB65AD14BC6D2E804AF073C25FDF6569C39E393F
          [1655968443.869145][21387:21392] CHIP:DMG:     CSRNonce (32) = 6FD841CB599C51208A19018F5C0BC970BA0A9303B07A2F2FB8ED77EF809B90A9
          [1655968443.869265][21387:21392] CHIP:DMG: }
          [1655968443.869316][21387:21392] CHIP:DMG:
          [1655968443.869367][21387:21392] CHIP:DMG: CSR (204) =
          [1655968443.869451][21387:21392] CHIP:DMG: {
          -----BEGIN CERTIFICATE REQUEST-----
          MIHJMHACAQAwDjEMMAoGA1UECgwDQ1NSMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcD
          QgAEHcBCTl/pvBOZfOXSmmHJRL/ICJI+hlbYAaRNJePa/Ak/srF1z/FYjPaAkP4s
          MXKXXKaHTnz4X7omyPRv8PX0U6AAMAoGCCqGSM49BAMCA0kAMEYCIQCKHBL832fZ
          fJnth6/loPSTIdz260LQWqKGNZzP0gbBIAIhAOZsBTObRRfRQ6350atlrRS8bS6A
          SvBzwl/fZWnDnjk/
          -----END CERTIFICATE REQUEST-----
          [1655968443.869588][21387:21392] CHIP:DMG: }
          [1655968443.869639][21387:21392] CHIP:DMG:
          [1655968443.869704][21387:21392] CHIP:DMG:
          [1655968443.869788][21387:21392] CHIP:DMG: Additional Fields =
          [1655968443.869842][21387:21392] CHIP:DMG: {
          [1655968443.869899][21387:21392] CHIP:DMG:     peer_address = BLE
          [1655968443.869952][21387:21392] CHIP:DMG: }
          [1655968443.870001][21387:21392] CHIP:DMG:
          [1655968443.870068][21387:21392] CHIP:EM: Received message of type 0x9 with protocolId (0, 1) and MessageCounter:163275441 on exchange 11675i
          [1655968443.870132][21387:21392] CHIP:EM: Found matching exchange: 11675i, Delegate: 0xffff90047da0
          [1655968443.870221][21387:21392] CHIP:DMG: ICR moving to [ResponseRe]
          [1655968443.870312][21387:21392] CHIP:DMG: InvokeResponseMessage =
          [1655968443.870371][21387:21392] CHIP:DMG: {
          [1655968443.870429][21387:21392] CHIP:DMG: 	suppressResponse = false,
          [1655968443.870488][21387:21392] CHIP:DMG: 	InvokeResponseIBs =
          [1655968443.870564][21387:21392] CHIP:DMG: 	[
          [1655968443.870623][21387:21392] CHIP:DMG: 		InvokeResponseIB =
          [1655968443.870703][21387:21392] CHIP:DMG: 		{
          [1655968443.870766][21387:21392] CHIP:DMG: 			CommandDataIB =
          [1655968443.870841][21387:21392] CHIP:DMG: 			{
          [1655968443.870911][21387:21392] CHIP:DMG: 				CommandPathIB =
          [1655968443.870998][21387:21392] CHIP:DMG: 				{
          [1655968443.871081][21387:21392] CHIP:DMG: 					EndpointId = 0x0,
          [1655968443.871165][21387:21392] CHIP:DMG: 					ClusterId = 0x3e,
          [1655968443.871248][21387:21392] CHIP:DMG: 					CommandId = 0x5,
          [1655968443.871334][21387:21392] CHIP:DMG: 				},
          [1655968443.871416][21387:21392] CHIP:DMG:
          [1655968443.871489][21387:21392] CHIP:DMG: 				CommandFields =
          [1655968443.871568][21387:21392] CHIP:DMG: 				{
          [1655968443.871646][21387:21392] CHIP:DMG: 					0x0 = [
          [1655968443.871916][21387:21392] CHIP:DMG: 							0x15, 0x30, 0x1, 0xcc, 0x30, 0x81, 0xc9, 0x30, 0x70, 0x2, 0x1, 0x0, 0x30, 0xe, 0x31, 0xc, 0x30, 0xa, 0x6, 0x3, 0x55, 0x4, 0xa, 0xc, 0x3, 0x43, 0x53, 0x52, 0x30, 0x59, 0x30, 0x13, 0x6, 0x7, 0x2a, 0x86, 0x48, 0xce, 0x3d, 0x2, 0x1, 0x6, 0x8, 0x2a, 0x86, 0x48, 0xce, 0x3d, 0x3, 0x1, 0x7, 0x3, 0x42, 0x0, 0x4, 0x1d, 0xc0, 0x42, 0x4e, 0x5f, 0xe9, 0xbc, 0x13, 0x99, 0x7c, 0xe5, 0xd2, 0x9a, 0x61, 0xc9, 0x44, 0xbf, 0xc8, 0x8, 0x92, 0x3e, 0x86, 0x56, 0xd8, 0x1, 0xa4, 0x4d, 0x25, 0xe3, 0xda, 0xfc, 0x9, 0x3f, 0xb2, 0xb1, 0x75, 0xcf, 0xf1, 0x58, 0x8c, 0xf6, 0x80, 0x90, 0xfe, 0x2c, 0x31, 0x72, 0x97, 0x5c, 0xa6, 0x87, 0x4e, 0x7c, 0xf8, 0x5f, 0xba, 0x26, 0xc8, 0xf4, 0x6f, 0xf0, 0xf5, 0xf4, 0x53, 0xa0, 0x0, 0x30, 0xa, 0x6, 0x8, 0x2a, 0x86, 0x48, 0xce, 0x3d, 0x4, 0x3, 0x2, 0x3, 0x49, 0x0, 0x30, 0x46, 0x2, 0x21, 0x0, 0x8a, 0x1c, 0x12, 0xfc, 0xdf, 0x67, 0xd9, 0x7c, 0x99, 0xed, 0x87, 0xaf, 0xe5, 0xa0, 0xf4, 0x93, 0x21, 0xdc, 0xf6, 0xeb, 0x42, 0xd0, 0x5a, 0xa2, 0x86, 0x35, 0x9c, 0xcf, 0xd2, 0x6, 0xc1, 0x20, 0x2, 0x21, 0x0, 0xe6, 0x6c, 0x5, 0x33, 0x9b, 0x45, 0x17, 0xd1, 0x43, 0xad, 0xf9, 0xd1, 0xab, 0x65, 0xad, 0x14, 0xbc, 0x6d, 0x2e, 0x80, 0x4a, 0xf0, 0x73, 0xc2, 0x5f, 0xdf, 0x65, 0x69, 0xc3, 0x9e, 0x39, 0x3f, 0x30, 0x2, 0x20, 0x6f, 0xd8, 0x41, 0xcb, 0x59, 0x9c, 0x51, 0x20, 0x8a, 0x19, 0x1, 0x8f, 0x5c, 0xb, 0xc9, 0x70, 0xba, 0xa, 0x93, 0x3, 0xb0, 0x7a, 0x2f, 0x2f, 0xb8, 0xed, 0x77, 0xef, 0x80, 0x9b, 0x90, 0xa9, 0x18,
          [1655968443.872069][21387:21392] CHIP:DMG: 					]
          [1655968443.872144][21387:21392] CHIP:DMG: 					0x1 = [
          [1655968443.872275][21387:21392] CHIP:DMG: 							0x16, 0xd9, 0x90, 0x89, 0xc, 0xf0, 0x56, 0xf3, 0xfe, 0xeb, 0xa1, 0xec, 0x7e, 0xc2, 0xd4, 0x55, 0x17, 0xf9, 0xf2, 0x56, 0x11, 0xdc, 0x98, 0xcb, 0xc8, 0xa2, 0xf5, 0x96, 0x70, 0x11, 0x17, 0x73, 0xe8, 0x36, 0xcf, 0xc, 0x36, 0x2a, 0x3a, 0x23, 0xef, 0xb6, 0x81, 0x3f, 0xb0, 0x81, 0xef, 0x5e, 0x7e, 0xc5, 0x7f, 0x2f, 0xbd, 0xb3, 0xc8, 0x57, 0xa9, 0x11, 0xbd, 0xd1, 0x1a, 0x69, 0x4e, 0x89,
          [1655968443.872374][21387:21392] CHIP:DMG: 					]
          [1655968443.872450][21387:21392] CHIP:DMG: 				},
          [1655968443.872650][21387:21392] CHIP:DMG: 			},
          [1655968443.872742][21387:21392] CHIP:DMG:
          [1655968443.872810][21387:21392] CHIP:DMG: 		},
          [1655968443.872885][21387:21392] CHIP:DMG:
          [1655968443.872943][21387:21392] CHIP:DMG: 	],
          [1655968443.873018][21387:21392] CHIP:DMG:
          [1655968443.873077][21387:21392] CHIP:DMG: 	InteractionModelRevision = 1
          [1655968443.873134][21387:21392] CHIP:DMG: },
          [1655968443.873301][21387:21392] CHIP:DMG: Received Command Response Data, Endpoint=0 Cluster=0x0000_003E Command=0x0000_0005
          [1655968443.873382][21387:21392] CHIP:CTL: Received certificate signing request from the device
          [1655968443.873446][21387:21392] CHIP:CTL: Successfully finished commissioning step 'SendOpCertSigningRequest'
      disabled: true

    - label: "TH1 generates 32-byte CSRNonce"
      verification: |
          Verify in TH log


          [1655968443.868940][21387:21392] CHIP:DMG: NOCSR Elements =
          [1655968443.869000][21387:21392] CHIP:DMG: {
          [1655968443.869077][21387:21392] CHIP:DMG:     CSR (204) = 3081C93070020100300E310C300A060355040A0C034353523059301306072A8648CE3D020106082A8648CE3D030107034200041DC0424E5FE9BC13997CE5D29A61C944BFC808923E8656D801A44D25E3DAFC093FB2B175CFF1588CF68090FE2C3172975CA6874E7CF85FBA26C8F46FF0F5F453A000300A06082A8648CE3D04030203490030460221008A1C12FCDF67D97C99ED87AFE5A0F49321DCF6EB42D05AA286359CCFD206C120022100E66C05339B4517D143ADF9D1AB65AD14BC6D2E804AF073C25FDF6569C39E393F
          [1655968443.869145][21387:21392] CHIP:DMG:     CSRNonce (32) = 6FD841CB599C51208A19018F5C0BC970BA0A9303B07A2F2FB8ED77EF809B90A9
          [1655968443.869265][21387:21392] CHIP:DMG: }
          [1655968443.869316][21387:21392] CHIP:DMG:
          [1655968443.869367][21387:21392] CHIP:DMG: CSR (204) =
          [1655968443.869451][21387:21392] CHIP:DMG: {
          -----BEGIN CERTIFICATE REQUEST-----
          MIHJMHACAQAwDjEMMAoGA1UECgwDQ1NSMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcD
          QgAEHcBCTl/pvBOZfOXSmmHJRL/ICJI+hlbYAaRNJePa/Ak/srF1z/FYjPaAkP4s
          MXKXXKaHTnz4X7omyPRv8PX0U6AAMAoGCCqGSM49BAMCA0kAMEYCIQCKHBL832fZ
          fJnth6/loPSTIdz260LQWqKGNZzP0gbBIAIhAOZsBTObRRfRQ6350atlrRS8bS6A
          SvBzwl/fZWnDnjk/
          -----END CERTIFICATE REQUEST-----
      disabled: true

    - label:
          "Save Node Operational Key Pair sent by the DUT in the CSRResponse
          Command as Key 2"
      verification: |
          Verify in TH log:

          [1655968443.870429][21387:21392] CHIP:DMG:         suppressResponse = false,
          [1655968443.870488][21387:21392] CHIP:DMG:         InvokeResponseIBs =
          [1655968443.870564][21387:21392] CHIP:DMG:         [
          [1655968443.870623][21387:21392] CHIP:DMG:                 InvokeResponseIB =
          [1655968443.870703][21387:21392] CHIP:DMG:                 {
          [1655968443.870766][21387:21392] CHIP:DMG:                         CommandDataIB =
          [1655968443.870841][21387:21392] CHIP:DMG:                         {
          [1655968443.870911][21387:21392] CHIP:DMG:                                 CommandPathIB =
          [1655968443.870998][21387:21392] CHIP:DMG:                                 {
          [1655968443.871081][21387:21392] CHIP:DMG:                                         EndpointId = 0x0,
          [1655968443.871165][21387:21392] CHIP:DMG:                                         ClusterId = 0x3e,
          [1655968443.871248][21387:21392] CHIP:DMG:                                         CommandId = 0x5,
          [1655968443.871334][21387:21392] CHIP:DMG:                                 },
          [1655968443.871416][21387:21392] CHIP:DMG:
          [1655968443.871489][21387:21392] CHIP:DMG:                                 CommandFields =
          [1655968443.871568][21387:21392] CHIP:DMG:                                 {
          [1655968443.871646][21387:21392] CHIP:DMG:                                         0x0 = [
          [1655968443.871916][21387:21392] CHIP:DMG:                                                         0x15, 0x30, 0x1, 0xcc, 0x30, 0x81, 0xc9, 0x30, 0x70, 0x2, 0x1, 0x0, 0x30, 0xe, 0x31, 0xc, 0x30, 0xa, 0x6, 0x3, 0x55, 0x4, 0xa, 0xc, 0x3, 0x43, 0x53, 0x52, 0x30, 0x59, 0x30, 0x13, 0x6, 0x7, 0x2a, 0x86, 0x48, 0xce, 0x3d, 0x2, 0x1, 0x6, 0x8, 0x2a, 0x86, 0x48, 0xce, 0x3d, 0x3, 0x1, 0x7, 0x3, 0x42, 0x0, 0x4, 0x1d, 0xc0, 0x42, 0x4e, 0x5f, 0xe9, 0xbc, 0x13, 0x99, 0x7c, 0xe5, 0xd2, 0x9a, 0x61, 0xc9, 0x44, 0xbf, 0xc8, 0x8, 0x92, 0x3e, 0x86, 0x56, 0xd8, 0x1, 0xa4, 0x4d, 0x25, 0xe3, 0xda, 0xfc, 0x9, 0x3f, 0xb2, 0xb1, 0x75, 0xcf, 0xf1, 0x58, 0x8c, 0xf6, 0x80, 0x90, 0xfe, 0x2c, 0x31, 0x72, 0x97, 0x5c, 0xa6, 0x87, 0x4e, 0x7c, 0xf8, 0x5f, 0xba, 0x26, 0xc8, 0xf4, 0x6f, 0xf0, 0xf5, 0xf4, 0x53, 0xa0, 0x0, 0x30, 0xa, 0x6, 0x8, 0x2a, 0x86, 0x48, 0xce, 0x3d, 0x4, 0x3, 0x2, 0x3, 0x49, 0x0, 0x30, 0x46, 0x2, 0x21, 0x0, 0x8a, 0x1c, 0x12, 0xfc, 0xdf, 0x67, 0xd9, 0x7c, 0x99, 0xed, 0x87, 0xaf, 0xe5, 0xa0, 0xf4, 0x93, 0x21, 0xdc, 0xf6, 0xeb, 0x42, 0xd0, 0x5a, 0xa2, 0x86, 0x35, 0x9c, 0xcf, 0xd2, 0x6, 0xc1, 0x20, 0x2, 0x21, 0x0, 0xe6, 0x6c, 0x5, 0x33, 0x9b, 0x45, 0x17, 0xd1, 0x43, 0xad, 0xf9, 0xd1, 0xab, 0x65, 0xad, 0x14, 0xbc, 0x6d, 0x2e, 0x80, 0x4a, 0xf0, 0x73, 0xc2, 0x5f, 0xdf, 0x65, 0x69, 0xc3, 0x9e, 0x39, 0x3f, 0x30, 0x2, 0x20, 0x6f, 0xd8, 0x41, 0xcb, 0x59, 0x9c, 0x51, 0x20, 0x8a, 0x19, 0x1, 0x8f, 0x5c, 0xb, 0xc9, 0x70, 0xba, 0xa, 0x93, 0x3, 0xb0, 0x7a, 0x2f, 0x2f, 0xb8, 0xed, 0x77, 0xef, 0x80, 0x9b, 0x90, 0xa9, 0x18,
          [1655968443.872069][21387:21392] CHIP:DMG:                                         ]
          [1655968443.872144][21387:21392] CHIP:DMG:                                         0x1 = [
          [1655968443.872275][21387:21392] CHIP:DMG:                                                         0x16, 0xd9, 0x90, 0x89, 0xc, 0xf0, 0x56, 0xf3, 0xfe, 0xeb, 0xa1, 0xec, 0x7e, 0xc2, 0xd4, 0x55, 0x17, 0xf9, 0xf2, 0x56, 0x11, 0xdc, 0x98, 0xcb, 0xc8, 0xa2, 0xf5, 0x96, 0x70, 0x11, 0x17, 0x73, 0xe8, 0x36, 0xcf, 0xc, 0x36, 0x2a, 0x3a, 0x23, 0xef, 0xb6, 0x81, 0x3f, 0xb0, 0x81, 0xef, 0x5e, 0x7e, 0xc5, 0x7f, 0x2f, 0xbd, 0xb3, 0xc8, 0x57, 0xa9, 0x11, 0xbd, 0xd1, 0x1a, 0x69, 0x4e, 0x89,
          [1655968443.872374][21387:21392] CHIP:DMG:                                         ]
          [1655968443.872450][21387:21392] CHIP:DMG:                                 },
          [1655968443.872650][21387:21392] CHIP:DMG:                         },
          [1655968443.872742][21387:21392] CHIP:DMG:
          [1655968443.872810][21387:21392] CHIP:DMG:                 },
          [1655968443.872885][21387:21392] CHIP:DMG:
          [1655968443.872943][21387:21392] CHIP:DMG:         ],
          [1655968443.873018][21387:21392] CHIP:DMG:
          [1655968443.873077][21387:21392] CHIP:DMG:         InteractionModelRevision = 1
          [1655968443.873134][21387:21392] CHIP:DMG: },
      disabled: true
