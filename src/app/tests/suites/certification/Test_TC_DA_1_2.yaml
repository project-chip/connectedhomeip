# Copyright (c) 2021 Project CHIP Authors
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# Auto-generated scripts for harness use only, please review before automation. The endpoints and cluster names are currently set to default

name:
    4.1.2. [TC-DA-1.2] Device Attestation Request Validation [DUT -
    Commissionee]

PICS:
    - MCORE.ROLE.COMMISSIONEE

config:
    nodeId: 0x12344321
    cluster: "Basic"
    endpoint: 0

tests:
    - label: "Pre-Conditions"
      verification: |
          PAA certificates were obtained externally
      disabled: true

    - label: "TH1 generates 32-byte AttestationNonce"
      verification: |
          To generate the Attestation Nonce give below command

          echo hex:$(hexdump -vn32 -e"4/4 "%08X" " /dev/urandom)

          The generated Attestation Nonce is hex:97B823C0207728BEC509CFE4D413C95AA693140D1F5D60215913ABB1F220E631
      disabled: true

    - label:
          "TH1 sends AttestationRequest Command with a random 32 bytes
          AttestationNonce` to the DUT."
      verification: |
          ./chip-tool operationalcredentials attestation-request hex:97B823C0207728BEC509CFE4D413C95AA693140D1F5D60215913ABB1F220E631 1 0 --trace_decode 1

          Verify  attestation response in TH(chip-tool) Log:

          [1657814395.876850][2481:2486] CHIP:DMG: Received Command Response Data, Endpoint=0 Cluster=0x0000_003E Command=0x0000_0001
          [1657814395.876900][2481:2486] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Command 0x0000_0001
          [1657814395.877019][2481:2486] CHIP:TOO:   AttestationResponse: {
          [1657814395.878828][2481:2486] CHIP:TOO:     attestationElements: 1531011D023082021906092A864886F70D010702A082020A30820206020103310D300B06096086480165030402013082017106092A864886F70D010701A08201620482015E152400012501F1FF3602050080050180050280050380050480050580050680050780050880050980050A80050B80050C80050D80050E80050F80051080051180051280051380051480051580051680051780051880051980051A80051B80051C80051D80051E80051F80052080052180052280052380052480052580052680052780052880052980052A80052B80052C80052D80052E80052F80053080053180053280053380053480053580053680053780053880053980053A80053B80053C80053D80053E80053F80054080054180054280054380054480054580054680054780054880054980054A80054B80054C80054D80054E80054F80055080055180055280055380055480055580055680055780055880055980055A80055B80055C80055D80055E80055F80056080056180056280056380182403162C04135A494732303134325A423333303030332D3234240500240600250794
          [1657814395.878926][2481:2486] CHIP:TOO:     ...................: 2624080018317D307B020103801462FA823359ACFAA9963E1CFA140ADDF504F37160300B0609608648016503040201300A06082A8648CE3D04030204473045022024E5D1F47A7D7B0D206A26EF699B7C9757B72D469089DE3192E678C745E7F60C022100F8AA2FA711FCB79B97E397CEDA667BAE464E2BD3FFDFC3CCED7AA8CA5F4C1A7C300220762B6B9DA08F7FC63BB693E38634EC6F87CEFF28AB1554A16AD43DCEC24C246624030018
          [1657814395.878960][2481:2486] CHIP:TOO:     signature: A572A713B9A05208DEE004F41043577547B66D1EDECB36707E069EB1C04C1F75BEE56D3FE1E5CD3FD5E6CFB848E0B888C08BB3FD42D988B175A07D671F3C4D7C
          [1657814395.878985][2481:2486] CHIP:TOO:    }
      disabled: true

    - label:
          "Verify that the DUT generates the Attestation Information and that it
          is sent to TH1 using AttestationResponse Command"
      verification: |
          Verify the attestation information field on TH(chip-tool) Log generated from the previous step

          [1655374218.453303][35023:35028] CHIP:DMG: Attestation Elements (585 bytes) =
          [1655374218.453366][35023:35028] CHIP:DMG: {
          [1655374218.453431][35023:35028] CHIP:DMG:     Certification Declaration =
          [1655374218.453483][35023:35028] CHIP:DMG:     {
          [1655374218.455342][35023:35028] CHIP:DMG:         Format Version = 1
          [1655374218.455398][35023:35028] CHIP:DMG:         Vendor Id = 65521
          [1655374218.455438][35023:35028] CHIP:DMG:         Product Ids =
          [1655374218.455474][35023:35028] CHIP:DMG:         {
          [1655374218.455512][35023:35028] CHIP:DMG:             Product Id = 32768
          [1655374218.455552][35023:35028] CHIP:DMG:             Product Id = 32769
          [1655374218.455590][35023:35028] CHIP:DMG:             Product Id = 32770
          [1655374218.455628][35023:35028] CHIP:DMG:             Product Id = 32771
          [1655374218.455666][35023:35028] CHIP:DMG:             Product Id = 32772
          [1655374218.455704][35023:35028] CHIP:DMG:             Product Id = 32773
          [1655374218.455742][35023:35028] CHIP:DMG:             Product Id = 32774
          [1655374218.455780][35023:35028] CHIP:DMG:             Product Id = 32775
          [1655374218.455818][35023:35028] CHIP:DMG:             Product Id = 32776
          [1655374218.455855][35023:35028] CHIP:DMG:             Product Id = 32777
          [1655374218.455893][35023:35028] CHIP:DMG:             Product Id = 32778
          [1655374218.455931][35023:35028] CHIP:DMG:             Product Id = 32779
          [1655374218.455969][35023:35028] CHIP:DMG:             Product Id = 32780
          [1655374218.456007][35023:35028] CHIP:DMG:             Product Id = 32781
          [1655374218.456045][35023:35028] CHIP:DMG:             Product Id = 32782
          [1655374218.456082][35023:35028] CHIP:DMG:             Product Id = 32783
          [1655374218.456120][35023:35028] CHIP:DMG:             Product Id = 32784
          [1655374218.456158][35023:35028] CHIP:DMG:             Product Id = 32785
          [1655374218.456196][35023:35028] CHIP:DMG:             Product Id = 32786
          [1655374218.456234][35023:35028] CHIP:DMG:             Product Id = 32787
          [1655374218.456271][35023:35028] CHIP:DMG:             Product Id = 32788
          [1655374218.456309][35023:35028] CHIP:DMG:             Product Id = 32789
          [1655374218.456347][35023:35028] CHIP:DMG:             Product Id = 32790
          [1655374218.456385][35023:35028] CHIP:DMG:             Product Id = 32791
          [1655374218.456423][35023:35028] CHIP:DMG:             Product Id = 32792
          [1655374218.456461][35023:35028] CHIP:DMG:             Product Id = 32793
          [1655374218.456498][35023:35028] CHIP:DMG:             Product Id = 32794
          [1655374218.456536][35023:35028] CHIP:DMG:             Product Id = 32795
          [1655374218.456573][35023:35028] CHIP:DMG:             Product Id = 32796
          [1655374218.456611][35023:35028] CHIP:DMG:             Product Id = 32797
          [1655374218.456649][35023:35028] CHIP:DMG:             Product Id = 32798
          [1655374218.456687][35023:35028] CHIP:DMG:             Product Id = 32799
          [1655374218.456724][35023:35028] CHIP:DMG:             Product Id = 32800
          [1655374218.456761][35023:35028] CHIP:DMG:             Product Id = 32801
          [1655374218.456799][35023:35028] CHIP:DMG:             Product Id = 32802
          [1655374218.456836][35023:35028] CHIP:DMG:             Product Id = 32803
          [1655374218.456874][35023:35028] CHIP:DMG:             Product Id = 32804
          [1655374218.456912][35023:35028] CHIP:DMG:             Product Id = 32805
          [1655374218.456949][35023:35028] CHIP:DMG:             Product Id = 32806
          [1655374218.456987][35023:35028] CHIP:DMG:             Product Id = 32807
          [1655374218.457024][35023:35028] CHIP:DMG:             Product Id = 32808
          [1655374218.457061][35023:35028] CHIP:DMG:             Product Id = 32809
          [1655374218.457099][35023:35028] CHIP:DMG:             Product Id = 32810
          [1655374218.457138][35023:35028] CHIP:DMG:             Product Id = 32811
          [1655374218.457175][35023:35028] CHIP:DMG:             Product Id = 32812
          [1655374218.457212][35023:35028] CHIP:DMG:             Product Id = 32813
          [1655374218.457250][35023:35028] CHIP:DMG:             Product Id = 32814
          [1655374218.457288][35023:35028] CHIP:DMG:             Product Id = 32815
          [1655374218.457326][35023:35028] CHIP:DMG:             Product Id = 32816
          [1655374218.457363][35023:35028] CHIP:DMG:             Product Id = 32817
          [1655374218.457401][35023:35028] CHIP:DMG:             Product Id = 32818
          [1655374218.457439][35023:35028] CHIP:DMG:             Product Id = 32819
          [1655374218.457476][35023:35028] CHIP:DMG:             Product Id = 32820
          [1655374218.457514][35023:35028] CHIP:DMG:             Product Id = 32821
          [1655374218.457552][35023:35028] CHIP:DMG:             Product Id = 32822
          [1655374218.457590][35023:35028] CHIP:DMG:             Product Id = 32823
          [1655374218.457627][35023:35028] CHIP:DMG:             Product Id = 32824
          [1655374218.457665][35023:35028] CHIP:DMG:             Product Id = 32825
          [1655374218.457702][35023:35028] CHIP:DMG:             Product Id = 32826
          [1655374218.457740][35023:35028] CHIP:DMG:             Product Id = 32827
          [1655374218.457777][35023:35028] CHIP:DMG:             Product Id = 32828
          [1655374218.457833][35023:35028] CHIP:DMG:             Product Id = 32829
          [1655374218.457874][35023:35028] CHIP:DMG:             Product Id = 32830
          [1655374218.457912][35023:35028] CHIP:DMG:             Product Id = 32831
          [1655374218.457950][35023:35028] CHIP:DMG:             Product Id = 32832
          [1655374218.457987][35023:35028] CHIP:DMG:             Product Id = 32833
          [1655374218.458026][35023:35028] CHIP:DMG:             Product Id = 32834
          [1655374218.458063][35023:35028] CHIP:DMG:             Product Id = 32835
          [1655374218.458101][35023:35028] CHIP:DMG:             Product Id = 32836
          [1655374218.458139][35023:35028] CHIP:DMG:             Product Id = 32837
          [1655374218.458177][35023:35028] CHIP:DMG:             Product Id = 32838
          [1655374218.458215][35023:35028] CHIP:DMG:             Product Id = 32839
          [1655374218.458253][35023:35028] CHIP:DMG:             Product Id = 32840
          [1655374218.458291][35023:35028] CHIP:DMG:             Product Id = 32841
          [1655374218.458328][35023:35028] CHIP:DMG:             Product Id = 32842
          [1655374218.458366][35023:35028] CHIP:DMG:             Product Id = 32843
          [1655374218.458404][35023:35028] CHIP:DMG:             Product Id = 32844
          [1655374218.458441][35023:35028] CHIP:DMG:             Product Id = 32845
          [1655374218.458480][35023:35028] CHIP:DMG:             Product Id = 32846
          [1655374218.458517][35023:35028] CHIP:DMG:             Product Id = 32847
          [1655374218.458555][35023:35028] CHIP:DMG:             Product Id = 32848
          [1655374218.458592][35023:35028] CHIP:DMG:             Product Id = 32849
          [1655374218.458630][35023:35028] CHIP:DMG:             Product Id = 32850
          [1655374218.458667][35023:35028] CHIP:DMG:             Product Id = 32851
          [1655374218.458706][35023:35028] CHIP:DMG:             Product Id = 32852
          [1655374218.458743][35023:35028] CHIP:DMG:             Product Id = 32853
          [1655374218.458781][35023:35028] CHIP:DMG:             Product Id = 32854
          [1655374218.458818][35023:35028] CHIP:DMG:             Product Id = 32855
          [1655374218.458856][35023:35028] CHIP:DMG:             Product Id = 32856
          [1655374218.458893][35023:35028] CHIP:DMG:             Product Id = 32857
          [1655374218.458932][35023:35028] CHIP:DMG:             Product Id = 32858
          [1655374218.458969][35023:35028] CHIP:DMG:             Product Id = 32859
          [1655374218.459007][35023:35028] CHIP:DMG:             Product Id = 32860
          [1655374218.459045][35023:35028] CHIP:DMG:             Product Id = 32861
          [1655374218.459082][35023:35028] CHIP:DMG:             Product Id = 32862
          [1655374218.459120][35023:35028] CHIP:DMG:             Product Id = 32863
          [1655374218.459159][35023:35028] CHIP:DMG:             Product Id = 32864
          [1655374218.459196][35023:35028] CHIP:DMG:             Product Id = 32865
          [1655374218.459234][35023:35028] CHIP:DMG:             Product Id = 32866
          [1655374218.459271][35023:35028] CHIP:DMG:             Product Id = 32867
          [1655374218.459309][35023:35028] CHIP:DMG:         }
          [1655374218.459347][35023:35028] CHIP:DMG:         Device Type Id = 22
          [1655374218.459390][35023:35028] CHIP:DMG:         Certificate Id (19) = ZIG20142ZB330003-24
          [1655374218.459430][35023:35028] CHIP:DMG:         Security Level = 0
          [1655374218.459470][35023:35028] CHIP:DMG:         Security Information = 0
          [1655374218.459508][35023:35028] CHIP:DMG:         Version Number = 9876
          [1655374218.459546][35023:35028] CHIP:DMG:         Certification Type = 0
      disabled: true

    - label:
          "TH1 sends CertificateChainRequest Command with CertificateType field
          set to DACCertificate (1) to DUT to obtain DAC"
      verification: |
          ./chip-tool operationalcredentials certificate-chain-request 1 1 0  --trace_decode 1

          Verify certificate chain response in TH (chip-tool) Log:

          CertificateChainResponse: {
          [1657814457.685538][2491:2496] CHIP:TOO:     certificate: 308201E73082018EA003020102020869CDF10DE9E54ED1300A06082A8648CE3D040302303D3125302306035504030C1C4D6174746572204465762050414920307846464631206E6F2050494431143012060A2B0601040182A27C02010C04464646313020170D3232303230353030303030305A180F39393939313233313233353935395A30533125302306035504030C1C4D61747465722044657620444143203078464646312F30783830303131143012060A2B0601040182A27C02010C044646463131143012060A2B0601040182A27C02020C04383030313059301306072A8648CE3D020106082A8648CE3D03010703420004463AC69342910A0E5588FC6FF56BB63E62ECCECB148F7D4EB03EE552601415767D16A5C663F793E49123260B8297A7CD7E7CFC7B316B39D98E90D29377738E82A360305E300C0603551D130101FF04023000300E0603551D0F0101FF040403020780301D0603551D0E0416041488DDE7B300382932CFF734C04624810F44168A6F301F0603551D2304183016801463540E47F64B1C38D13884A462D16C195D8FFB3C300A06082A8648CE3D040302
          [1657814457.685600][2491:2496] CHIP:TOO:     ...........: 034700304402200127A27B4B44610EE2FCDC4D2B7885563660BC0F76F17219ED6A08DFB2B3C1CD02206B59E0AF45F3EB2A85B919D35731528C6028C415239545E108E4E54E70971353

          The log has certificate details (starting with ---BEGIN CERTIFICATE and ending with ---END CERTIFICATE ) as highlighted below, save the certificate in .pem file format. Open editor on your TH , save that in file , example: dac.pem

          1660951953700] [17233:5262446] CHIP: [DMG]     data = 0068e9001f1f110e4f813e5e997100f2b1c69eb72b23bd4e69002a0485ecc741a33706d82f20c8ea99d6b830b2f60ed69c07cecba48142c7f3c8ded67e9ed878b5d68fe28facaf111ee3ce4510fc9b00ad13d57c2a7bd8bdcf868ca8e0aa0bb96c873862f32f12a32207a22e33fe3d8124435207df4f5747414a21b9674685a486f0d3c0aae5d96ba2f02067be2221b98415244522a221f570b62c21a83d88a9ee1a085c5a8c8f5d598f7cb168b4b36ca2306a4554a062e058dba25e7058a4e2f9f976fc71e3d6fcdafb40346d74600e033100243c0837f30f2e6fb337582f6a7d122ffc8943bbc17ba447f80fbac538609c9822d0ab95f6c831071a68ccc9cb1e5180f4daf0a1ae16a33ee3ac7d4754d5f6dca657e44f5a1f9405e668ce848132bb62b1fab6f5cd9aa2d4357fd14e516f18f5c158373f21479aef4c290477141e6d1894901a1c88db870fc1fc005be219dce3f708868ba532c657cf98b8d154d569d6f3de7639cdf72cc43af330ddbac0b910a839416e38a8b305a7eb1b069d274c8c31868363615adb08bfe99a4353f34927785acdb8c1619e1d4f8574491a3e77a46e6c5b47bdd722adfcb00937be7f9ba8c53a8188d42795439a435e6f6a26288c9278981dcac442d480ee40397e2a808d4ae55139562111120bd69411ef301d1b6caf3a4793d143c57092d4944ca93e848f553a19145dc6c02a0b68a67ea83b66afd10988737a753ea8d1f49ca534d12590bf7c3fddd0d7d00baf0121c883a743fcd289dab3d2a8e5131bd987
          [1660951953700] [17233:5262446] CHIP: [DMG]     buffer_ptr = 140355398986080
          [1660951953700] [17233:5262446] CHIP: [DMG] }
          [1660951953700] [17233:5262446] CHIP: [DMG]
          [1660951953700] [17233:5262446] CHIP: [DMG] DAC/PAI (491) =
          [1660951953700] [17233:5262446] CHIP: [DMG] {
          -----BEGIN CERTIFICATE-----
          MIIB5zCCAY6gAwIBAgIIac3xDenlTtEwCgYIKoZIzj0EAwIwPTElMCMGA1UEAwwc
          TWF0dGVyIERldiBQQUkgMHhGRkYxIG5vIFBJRDEUMBIGCisGAQQBgqJ8AgEMBEZG
          RjEwIBcNMjIwMjA1MDAwMDAwWhgPOTk5OTEyMzEyMzU5NTlaMFMxJTAjBgNVBAMM
          HE1hdHRlciBEZXYgREFDIDB4RkZGMS8weDgwMDExFDASBgorBgEEAYKifAIBDARG
          RkYxMRQwEgYKKwYBBAGConwCAgwEODAwMTBZMBMGByqGSM49AgEGCCqGSM49AwEH
          A0IABEY6xpNCkQoOVYj8b/Vrtj5i7M7LFI99TrA+5VJgFBV2fRalxmP3k+SRIyYL
          gpenzX58/HsxaznZjpDSk3dzjoKjYDBeMAwGA1UdEwEB/wQCMAAwDgYDVR0PAQH/
          BAQDAgeAMB0GA1UdDgQWBBSI3eezADgpMs/3NMBGJIEPRBaKbzAfBgNVHSMEGDAW
          gBRjVA5H9kscONE4hKRi0WwZXY/7PDAKBggqhkjOPQQDAgNHADBEAiABJ6J7S0Rh
          DuL83E0reIVWNmC8D3bxchntagjfsrPBzQIga1ngr0Xz6yqFuRnTVzFSjGAoxBUj
          lUXhCOTlTnCXE1M=
          -----END CERTIFICATE-----
          [1660951953700] [17233:5262446] CHIP: [DMG] }
      disabled: true

    - label: "TH1 saves DAC certificate"
      verification: |
          Verify the size of certificate is less than or equal to 600 bytes and of type octstr from the above log, You have saved the file already in the above step

          Example :
          308201E73082018EA003020102020869CDF10DE9E54ED1300A06082A8648CE3D040302303D3125302306035504030C1C4D6174746572204465762050414920307846464631206E6F2050494431143012060A2B0601040182A27C02010C04464646313020170D3232303230353030303030305A180F39393939313233313233353935395A30533125302306035504030C1C4D61747465722044657620444143203078464646312F30783830303131143012060A2B0601040182A27C02010C044646463131143012060A2B0601040182A27C02020C04383030313059301306072A8648CE3D020106082A8648CE3D03010703420004463AC69342910A0E5588FC6FF56BB63E62ECCECB148F7D4EB03EE552601415767D16A5C663F793E49123260B8297A7CD7E7CFC7B316B39D98E90D29377738E82A360305E300C0603551D130101FF04023000300E0603551D0F0101FF040403020780301D0603551D0E0416041488DDE7B300382932CFF734C04624810F44168A6F301F0603551D2304183016801463540E47F64B1C38D13884A462D16C195D8FFB3C300A06082A8648CE3D040302
      disabled: true

    - label:
          "TH1 sends CertificateChainRequest Command with CertificateType field
          set to PAICertificate (2) to DUT to obtain DAC"
      verification: |
          ./chip-tool operationalcredentials certificate-chain-request 2 1 0  --trace_decode 1

          Verify CertificateChainResponse and the size is 600 bytes in TH (chip-tool) Log:

          [1657814533.325960][2501:2506] CHIP:DMG: Received Command Response Data, Endpoint=0 Cluster=0x0000_003E Command=0x0000_0003
          [1657814533.326064][2501:2506] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Command 0x0000_0003
          [1657814533.326158][2501:2506] CHIP:TOO:   CertificateChainResponse: {
          [1657814533.326229][2501:2506] CHIP:TOO:     certificate: 308201CB30820171A003020102020856AD8222AD945B64300A06082A8648CE3D04030230303118301606035504030C0F4D617474657220546573742050414131143012060A2B0601040182A27C02010C04464646313020170D3232303230353030303030305A180F39393939313233313233353935395A303D3125302306035504030C1C4D6174746572204465762050414920307846464631206E6F2050494431143012060A2B0601040182A27C02010C04464646313059301306072A8648CE3D020106082A8648CE3D03010703420004419A9315C2173E0C8C876D03CCFC944852647F7FEC5E5082F4059928ECA894C594151309AC631E4CB03392AF684B0BAFB7E65B3B8162C2F52BF931B8E77AAA82A366306430120603551D130101FF040830060101FF020100300E0603551D0F0101FF040403020106301D0603551D0E0416041463540E47F64B1C38D13884A462D16C195D8FFB3C301F0603551D230418301680146AFD22771F511FECBF1641976710DCDC31A1717E300A06082A8648CE3D0403020348003045022100B2EF27F49AE9B50FB91EEAC94C4D0BDBB8D7929C6C
          [1657814533.326315][2501:2506] CHIP:TOO:     ...........: B88FACE529368D12054C0C0220655DC92B86BD909882A6C62177B825D7D05EDBE7C22F9FEA71220E7EA703F891

          The log has certificate details (starting with ---BEGIN CERTIFICATE and ending with ---END CERTIFICATE ) as highlighted below , save the certificate in .pem file format. Open editor on your TH , save that in file , example: pai.pem

          [1660952198157] [17290:5268348] CHIP: [DMG] Encrypted Payload (531 bytes) =
          [1660952198157] [17290:5268348] CHIP: [DMG] {
          [1660952198157] [17290:5268348] CHIP: [DMG]     data = 001c39000820730541fea9f0e9b148d6c50bdd30d20acef8a0ee67b0458c5fe377d9793092b83e0670ad46770ce44154de4d131731f7065b8329d08be8a280db77f8c12b48300c5fb009c0d3f4b0b1b0a8f4523e319db11ee5d8eb679325c2982248aa5c75b474c50f3bbb0f617ab06a04df403557a564bac4cf08c56fd2eb951d4be875f290dd7b9da01e558fc85ad7b4922d804029410735cae9910a6df282145059b3228e9349467ddc917a268638fa7882a3f7b278355ec848c2ac3f466d3cca746ca416733b85dc6bd8e99ecd35bfc0d3b85f28db6e897636bec89fc41ee2eba78bc7ca11fe959a913ec37901b30a193e6665672e8159e194ca133831251205bca75c00dd8b10160a5b6b814e0cc4fc52f48cc2b68819212bcf71ba11785d2c4628363718e9943216a3f4a3f28adcb988997af982a48d793cd9bd0b62648aa2ffed8f373cd7d5ca86ae703415016adf45a1e8ee26a62d023a6a09accca619ca28e3db15cd4ee5b850608c8319e166dc540877683d960d4b9fde0ae4042096ce696532e9d6b8c96f030def011e59a8762753fc0d50ecf30842377249f78c9b3ee164f5f7988a777a4a1ca407f40923737480eca5e0181977b6048d8835b3d3cedd0d36b9c39098e49048c31db9b48decd744f3121b0260e07b9afe9a8a71d9c14a230e48a1b56894c0453b9779bc8fe269e072ee842aa17821ee09b83cfab5e852918a37bbc1414b7f62cd5dc4c254bfa4
          [1660952198157] [17290:5268348] CHIP: [DMG]     buffer_ptr = 140233457951312
          [1660952198157] [17290:5268348] CHIP: [DMG] }
          [1660952198157] [17290:5268348] CHIP: [DMG]
          [1660952198157] [17290:5268348] CHIP: [DMG] DAC/PAI (463) =
          [1660952198157] [17290:5268348] CHIP: [DMG] {
          -----BEGIN CERTIFICATE-----
          MIIByzCCAXGgAwIBAgIIVq2CIq2UW2QwCgYIKoZIzj0EAwIwMDEYMBYGA1UEAwwP
          TWF0dGVyIFRlc3QgUEFBMRQwEgYKKwYBBAGConwCAQwERkZGMTAgFw0yMjAyMDUw
          MDAwMDBaGA85OTk5MTIzMTIzNTk1OVowPTElMCMGA1UEAwwcTWF0dGVyIERldiBQ
          QUkgMHhGRkYxIG5vIFBJRDEUMBIGCisGAQQBgqJ8AgEMBEZGRjEwWTATBgcqhkjO
          PQIBBggqhkjOPQMBBwNCAARBmpMVwhc+DIyHbQPM/JRIUmR/f+xeUIL0BZko7KiU
          xZQVEwmsYx5MsDOSr2hLC6+35ls7gWLC9Sv5MbjneqqCo2YwZDASBgNVHRMBAf8E
          CDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBBjAdBgNVHQ4EFgQUY1QOR/ZLHDjROISk
          YtFsGV2P+zwwHwYDVR0jBBgwFoAUav0idx9RH+y/FkGXZxDc3DGhcX4wCgYIKoZI
          zj0EAwIDSAAwRQIhALLvJ/Sa6bUPuR7qyUxNC9u415KcbLiPrOUpNo0SBUwMAiBl
          Xckrhr2QmIKmxiF3uCXX0F7b58Ivn+pxIg5+pwP4kQ==
          -----END CERTIFICATE-----
          [1660952198157] [17290:5268348] CHIP: [DMG] }
          [1660952198157] [17290:5268348] CHIP: [DMG]
      disabled: true

    - label: "TH1 saves PAI certificate"
      verification: |
          Verify the size of certificate is less than or equal to 600 bytes and of type octstr from the above log, already saved the file in the above step

          Example :
          308201CB30820171A003020102020856AD8222AD945B64300A06082A8648CE3D04030230303118301606035504030C0F4D617474657220546573742050414131143012060A2B0601040182A27C02010C04464646313020170D3232303230353030303030305A180F39393939313233313233353935395A303D3125302306035504030C1C4D6174746572204465762050414920307846464631206E6F2050494431143012060A2B0601040182A27C02010C04464646313059301306072A8648CE3D020106082A8648CE3D03010703420004419A9315C2173E0C8C876D03CCFC944852647F7FEC5E5082F4059928ECA894C594151309AC631E4CB03392AF684B0BAFB7E65B3B8162C2F52BF931B8E77AAA82A366306430120603551D130101FF040830060101FF020100300E0603551D0F0101FF040403020106301D0603551D0E0416041463540E47F64B1C38D13884A462D16C195D8FFB3C301F0603551D230418301680146AFD22771F511FECBF1641976710DCDC31A1717E300A06082A8648CE3D0403020348003045022100B2EF27F49AE9B50FB91EEAC94C4D0BDBB8D7929C6C
      disabled: true

    - label:
          "TH1 Reads the VendorID attribute of the Basic Information cluster and
          saves it as basic_info_vendor_id"
      verification: |
          ./chip-tool basic read vendor-id 1 0  --trace_decode 1

          Verify the vendorId in TH (chip-tool) Log , Note this Vendor ID and you are going to verify this matching with CD in the steps below

          [1654068802.514300][10990:10995] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_0028 Attribute 0x0000_0002 DataVersion: 2079473956
          [1654068802.514357][10990:10995] CHIP:TOO:   VendorID: 65521
          [1654068802.514447][10990:10995] CHIP:EM: Sending Standalone Ack for MessageCounter:5573281 on exchange 17510i
      disabled: true

    - label:
          "TH1 Reads the ProductID attribute of the Basic Information cluster
          and saves it as basic_info_product_id"
      verification: |
          ./chip-tool basic read product-id 1 0  --trace_decode 1

          Verify  ProductId in TH (chip-tool) Log,  Note this PID and you are going to verify this matching with CD in the steps below

          [1654068987.385768][11050:11055] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_0028 Attribute 0x0000_0004 DataVersion: 2079473956
          [1654068987.385820][11050:11055] CHIP:TOO:   ProductID: 32769
          [1654068987.385908][11050:11055] CHIP:EM: Sending Standalone Ack for MessageCounter:7653435 on exchange 20545i
      disabled: true

    - label:
          "Extract the attestation_elements_message structure fields from the
          AttestationResponse Command received by TH1 from DUT"
      verification: |
          To get attestation nonce give below command
           echo hex:$(hexdump -vn32 -e"4/4 "%08X" " /dev/urandom)


          ./chip-tool operationalcredentials attestation-request hex:3577CA6EFFFC560E287604663AE5BE2F11D1B1CF99BE326AF5B3B114A2E91395 1 0 --trace_decode 1


          Verify attestation response in TH (chip-tool) Log

          [1658223434.718871][5712:5717] CHIP:DMG: Received Command Response Data, Endpoint=0 Cluster=0x0000_003E Command=0x0000_0001
          [1658223434.718921][5712:5717] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Command 0x0000_0001
          [1658223434.718981][5712:5717] CHIP:TOO:   AttestationResponse: {
          [1658223434.719026][5712:5717] CHIP:TOO:     attestationElements: 1531011D023082021906092A864886F70D010702A082020A30820206020103310D300B06096086480165030402013082017106092A864886F70D010701A08201620482015E152400012501F1FF3602050080050180050280050380050480050580050680050780050880050980050A80050B80050C80050D80050E80050F80051080051180051280051380051480051580051680051780051880051980051A80051B80051C80051D80051E80051F80052080052180052280052380052480052580052680052780052880052980052A80052B80052C80052D80052E80052F80053080053180053280053380053480053580053680053780053880053980053A80053B80053C80053D80053E80053F80054080054180054280054380054480054580054680054780054880054980054A80054B80054C80054D80054E80054F80055080055180055280055380055480055580055680055780055880055980055A80055B80055C80055D80055E80055F80056080056180056280056380182403162C04135A494732303134325A423333303030332D3234240500240600250794
          [1658223434.719078][5712:5717] CHIP:TOO:     ...................: 2624080018317D307B020103801462FA823359ACFAA9963E1CFA140ADDF504F37160300B0609608648016503040201300A06082A8648CE3D04030204473045022024E5D1F47A7D7B0D206A26EF699B7C9757B72D469089DE3192E678C745E7F60C022100F8AA2FA711FCB79B97E397CEDA667BAE464E2BD3FFDFC3CCED7AA8CA5F4C1A7C3002203577CA6EFFFC560E287604663AE5BE2F11D1B1CF99BE326AF5B3B114A2E9139524030018
          [1658223434.719110][5712:5717] CHIP:TOO:     signature: 7E18271F57FFC60492CA74943FC897493FB2FECDD4A4DC9F2AD348AAD1F5C57DAEB144A4D1C79419386C746F28AC145F3185C64AD99DD829EE70C3690D29642D
          [1658223434.719135][5712:5717] CHIP:TOO:    }
      disabled: true

    - label:
          "Verify that the DUT generated the AttestationResponse has the
          following fields: AttestationElements ,AttestationSignature"
      verification: |
          Verify that the DUT generated the AttestationResponse has the following fields in the TH (Chip-Tool ) log generated from the previous step command
          1. AttestationElements
          2. AttestationSignature

           AttestationResponse: {
          [1658223434.719026][5712:5717] CHIP:TOO:     attestationElements: 1531011D023082021906092A864886F70D010702A082020A30820206020103310D300B06096086480165030402013082017106092A864886F70D010701A08201620482015E152400012501F1FF3602050080050180050280050380050480050580050680050780050880050980050A80050B80050C80050D80050E80050F80051080051180051280051380051480051580051680051780051880051980051A80051B80051C80051D80051E80051F80052080052180052280052380052480052580052680052780052880052980052A80052B80052C80052D80052E80052F80053080053180053280053380053480053580053680053780053880053980053A80053B80053C80053D80053E80053F80054080054180054280054380054480054580054680054780054880054980054A80054B80054C80054D80054E80054F80055080055180055280055380055480055580055680055780055880055980055A80055B80055C80055D80055E80055F80056080056180056280056380182403162C04135A494732303134325A423333303030332D3234240500240600250794
          [1658223434.719078][5712:5717] CHIP:TOO:     ...................: 2624080018317D307B020103801462FA823359ACFAA9963E1CFA140ADDF504F37160300B0609608648016503040201300A06082A8648CE3D04030204473045022024E5D1F47A7D7B0D206A26EF699B7C9757B72D469089DE3192E678C745E7F60C022100F8AA2FA711FCB79B97E397CEDA667BAE464E2BD3FFDFC3CCED7AA8CA5F4C1A7C3002203577CA6EFFFC560E287604663AE5BE2F11D1B1CF99BE326AF5B3B114A2E9139524030018
          [1658223434.719110][5712:5717] CHIP:TOO:     signature: 7E18271F57FFC60492CA74943FC897493FB2FECDD4A4DC9F2AD348AAD1F5C57DAEB144A4D1C79419386C746F28AC145F3185C64AD99DD829EE70C3690D29642D
      disabled: true

    - label: "Read the attestation_elements_message structure fields"
      verification: |
          Verify the attestation elements field on TH(chip-tool) Log generated  from  step 5
          1. AttestationElements

          [1655374218.453303][35023:35028] CHIP:DMG: Attestation Elements (585 bytes) =
          [1655374218.453366][35023:35028] CHIP:DMG: {
          [1655374218.453431][35023:35028] CHIP:DMG:     Certification Declaration =
          [1655374218.453483][35023:35028] CHIP:DMG:     {
          [1655374218.455342][35023:35028] CHIP:DMG:         Format Version = 1
          [1655374218.455398][35023:35028] CHIP:DMG:         Vendor Id = 65521
          [1655374218.455438][35023:35028] CHIP:DMG:         Product Ids =
          [1655374218.455474][35023:35028] CHIP:DMG:         {
          [1655374218.455512][35023:35028] CHIP:DMG:             Product Id = 32768
          [1655374218.455552][35023:35028] CHIP:DMG:             Product Id = 32769
          [1655374218.455590][35023:35028] CHIP:DMG:             Product Id = 32770
          [1655374218.455628][35023:35028] CHIP:DMG:             Product Id = 32771
          [1655374218.455666][35023:35028] CHIP:DMG:             Product Id = 32772
          [1655374218.455704][35023:35028] CHIP:DMG:             Product Id = 32773
          [1655374218.455742][35023:35028] CHIP:DMG:             Product Id = 32774
          [1655374218.455780][35023:35028] CHIP:DMG:             Product Id = 32775
          [1655374218.455818][35023:35028] CHIP:DMG:             Product Id = 32776
          [1655374218.455855][35023:35028] CHIP:DMG:             Product Id = 32777
          [1655374218.455893][35023:35028] CHIP:DMG:             Product Id = 32778
          [1655374218.455931][35023:35028] CHIP:DMG:             Product Id = 32779
          [1655374218.455969][35023:35028] CHIP:DMG:             Product Id = 32780
          [1655374218.456007][35023:35028] CHIP:DMG:             Product Id = 32781
          [1655374218.456045][35023:35028] CHIP:DMG:             Product Id = 32782
          [1655374218.456082][35023:35028] CHIP:DMG:             Product Id = 32783
          [1655374218.456120][35023:35028] CHIP:DMG:             Product Id = 32784
          [1655374218.456158][35023:35028] CHIP:DMG:             Product Id = 32785
          [1655374218.456196][35023:35028] CHIP:DMG:             Product Id = 32786
          [1655374218.456234][35023:35028] CHIP:DMG:             Product Id = 32787
          [1655374218.456271][35023:35028] CHIP:DMG:             Product Id = 32788
          [1655374218.456309][35023:35028] CHIP:DMG:             Product Id = 32789
          [1655374218.456347][35023:35028] CHIP:DMG:             Product Id = 32790
          [1655374218.456385][35023:35028] CHIP:DMG:             Product Id = 32791
          [1655374218.456423][35023:35028] CHIP:DMG:             Product Id = 32792
          [1655374218.456461][35023:35028] CHIP:DMG:             Product Id = 32793
          [1655374218.456498][35023:35028] CHIP:DMG:             Product Id = 32794
          [1655374218.456536][35023:35028] CHIP:DMG:             Product Id = 32795
          [1655374218.456573][35023:35028] CHIP:DMG:             Product Id = 32796
          [1655374218.456611][35023:35028] CHIP:DMG:             Product Id = 32797
          [1655374218.456649][35023:35028] CHIP:DMG:             Product Id = 32798
          [1655374218.456687][35023:35028] CHIP:DMG:             Product Id = 32799
          [1655374218.456724][35023:35028] CHIP:DMG:             Product Id = 32800
          [1655374218.456761][35023:35028] CHIP:DMG:             Product Id = 32801
          [1655374218.456799][35023:35028] CHIP:DMG:             Product Id = 32802
          [1655374218.456836][35023:35028] CHIP:DMG:             Product Id = 32803
          [1655374218.456874][35023:35028] CHIP:DMG:             Product Id = 32804
          [1655374218.456912][35023:35028] CHIP:DMG:             Product Id = 32805
          [1655374218.456949][35023:35028] CHIP:DMG:             Product Id = 32806
          [1655374218.456987][35023:35028] CHIP:DMG:             Product Id = 32807
          [1655374218.457024][35023:35028] CHIP:DMG:             Product Id = 32808
          [1655374218.457061][35023:35028] CHIP:DMG:             Product Id = 32809
          [1655374218.457099][35023:35028] CHIP:DMG:             Product Id = 32810
          [1655374218.457138][35023:35028] CHIP:DMG:             Product Id = 32811
          [1655374218.457175][35023:35028] CHIP:DMG:             Product Id = 32812
          [1655374218.457212][35023:35028] CHIP:DMG:             Product Id = 32813
          [1655374218.457250][35023:35028] CHIP:DMG:             Product Id = 32814
          [1655374218.457288][35023:35028] CHIP:DMG:             Product Id = 32815
          [1655374218.457326][35023:35028] CHIP:DMG:             Product Id = 32816
          [1655374218.457363][35023:35028] CHIP:DMG:             Product Id = 32817
          [1655374218.457401][35023:35028] CHIP:DMG:             Product Id = 32818
          [1655374218.457439][35023:35028] CHIP:DMG:             Product Id = 32819
          [1655374218.457476][35023:35028] CHIP:DMG:             Product Id = 32820
          [1655374218.457514][35023:35028] CHIP:DMG:             Product Id = 32821
          [1655374218.457552][35023:35028] CHIP:DMG:             Product Id = 32822
          [1655374218.457590][35023:35028] CHIP:DMG:             Product Id = 32823
          [1655374218.457627][35023:35028] CHIP:DMG:             Product Id = 32824
          [1655374218.457665][35023:35028] CHIP:DMG:             Product Id = 32825
          [1655374218.457702][35023:35028] CHIP:DMG:             Product Id = 32826
          [1655374218.457740][35023:35028] CHIP:DMG:             Product Id = 32827
          [1655374218.457777][35023:35028] CHIP:DMG:             Product Id = 32828
          [1655374218.457833][35023:35028] CHIP:DMG:             Product Id = 32829
          [1655374218.457874][35023:35028] CHIP:DMG:             Product Id = 32830
          [1655374218.457912][35023:35028] CHIP:DMG:             Product Id = 32831
          [1655374218.457950][35023:35028] CHIP:DMG:             Product Id = 32832
          [1655374218.457987][35023:35028] CHIP:DMG:             Product Id = 32833
          [1655374218.458026][35023:35028] CHIP:DMG:             Product Id = 32834
          [1655374218.458063][35023:35028] CHIP:DMG:             Product Id = 32835
          [1655374218.458101][35023:35028] CHIP:DMG:             Product Id = 32836
          [1655374218.458139][35023:35028] CHIP:DMG:             Product Id = 32837
          [1655374218.458177][35023:35028] CHIP:DMG:             Product Id = 32838
          [1655374218.458215][35023:35028] CHIP:DMG:             Product Id = 32839
          [1655374218.458253][35023:35028] CHIP:DMG:             Product Id = 32840
          [1655374218.458291][35023:35028] CHIP:DMG:             Product Id = 32841
          [1655374218.458328][35023:35028] CHIP:DMG:             Product Id = 32842
          [1655374218.458366][35023:35028] CHIP:DMG:             Product Id = 32843
          [1655374218.458404][35023:35028] CHIP:DMG:             Product Id = 32844
          [1655374218.458441][35023:35028] CHIP:DMG:             Product Id = 32845
          [1655374218.458480][35023:35028] CHIP:DMG:             Product Id = 32846
          [1655374218.458517][35023:35028] CHIP:DMG:             Product Id = 32847
          [1655374218.458555][35023:35028] CHIP:DMG:             Product Id = 32848
          [1655374218.458592][35023:35028] CHIP:DMG:             Product Id = 32849
          [1655374218.458630][35023:35028] CHIP:DMG:             Product Id = 32850
          [1655374218.458667][35023:35028] CHIP:DMG:             Product Id = 32851
          [1655374218.458706][35023:35028] CHIP:DMG:             Product Id = 32852
          [1655374218.458743][35023:35028] CHIP:DMG:             Product Id = 32853
          [1655374218.458781][35023:35028] CHIP:DMG:             Product Id = 32854
          [1655374218.458818][35023:35028] CHIP:DMG:             Product Id = 32855
          [1655374218.458856][35023:35028] CHIP:DMG:             Product Id = 32856
          [1655374218.458893][35023:35028] CHIP:DMG:             Product Id = 32857
          [1655374218.458932][35023:35028] CHIP:DMG:             Product Id = 32858
          [1655374218.458969][35023:35028] CHIP:DMG:             Product Id = 32859
          [1655374218.459007][35023:35028] CHIP:DMG:             Product Id = 32860
          [1655374218.459045][35023:35028] CHIP:DMG:             Product Id = 32861
          [1655374218.459082][35023:35028] CHIP:DMG:             Product Id = 32862
          [1655374218.459120][35023:35028] CHIP:DMG:             Product Id = 32863
          [1655374218.459159][35023:35028] CHIP:DMG:             Product Id = 32864
          [1655374218.459196][35023:35028] CHIP:DMG:             Product Id = 32865
          [1655374218.459234][35023:35028] CHIP:DMG:             Product Id = 32866
          [1655374218.459271][35023:35028] CHIP:DMG:             Product Id = 32867
          [1655374218.459309][35023:35028] CHIP:DMG:         }
          [1655374218.459347][35023:35028] CHIP:DMG:         Device Type Id = 22
          [1655374218.459390][35023:35028] CHIP:DMG:         Certificate Id (19) = ZIG20142ZB330003-24
          [1655374218.459430][35023:35028] CHIP:DMG:         Security Level = 0
          [1655374218.459470][35023:35028] CHIP:DMG:         Security Information = 0
          [1655374218.459508][35023:35028] CHIP:DMG:         Version Number = 9876
          [1655374218.459546][35023:35028] CHIP:DMG:         Certification Type = 0
      disabled: true

    - label:
          "Verify that the attestation_elements_message structure fields satisfy
          the following conditions:"
      verification: |
          Verify that the attestation_elements_message structure fields satisfy the following conditions on TH(chip-tool) Log
          1. AttestationElements field size should not be greater than RESP_MAX(900 bytes)
          2. certification_declaration is present and is an octet string

          [1655374218.453303][35023:35028] CHIP:DMG: Attestation Elements (585 bytes) =
          [1655374218.453366][35023:35028] CHIP:DMG: {
          [1655374218.453431][35023:35028] CHIP:DMG:     Certification Declaration =
          [1655374218.453483][35023:35028] CHIP:DMG:     {
          [1655374218.455342][35023:35028] CHIP:DMG:         Format Version = 1
          [1655374218.455398][35023:35028] CHIP:DMG:         Vendor Id = 65521
          [1655374218.455438][35023:35028] CHIP:DMG:         Product Ids =
          [1655374218.455474][35023:35028] CHIP:DMG:         {
          [1655374218.455512][35023:35028] CHIP:DMG:             Product Id = 32768
          [1655374218.455552][35023:35028] CHIP:DMG:             Product Id = 32769
          [1655374218.455590][35023:35028] CHIP:DMG:             Product Id = 32770
          [1655374218.455628][35023:35028] CHIP:DMG:             Product Id = 32771
          [1655374218.455666][35023:35028] CHIP:DMG:             Product Id = 32772
          [1655374218.455704][35023:35028] CHIP:DMG:             Product Id = 32773
          [1655374218.455742][35023:35028] CHIP:DMG:             Product Id = 32774
          [1655374218.455780][35023:35028] CHIP:DMG:             Product Id = 32775
          [1655374218.455818][35023:35028] CHIP:DMG:             Product Id = 32776
          [1655374218.455855][35023:35028] CHIP:DMG:             Product Id = 32777
          [1655374218.455893][35023:35028] CHIP:DMG:             Product Id = 32778
          [1655374218.455931][35023:35028] CHIP:DMG:             Product Id = 32779
          [1655374218.455969][35023:35028] CHIP:DMG:             Product Id = 32780
          [1655374218.456007][35023:35028] CHIP:DMG:             Product Id = 32781
          [1655374218.456045][35023:35028] CHIP:DMG:             Product Id = 32782
          [1655374218.456082][35023:35028] CHIP:DMG:             Product Id = 32783
          [1655374218.456120][35023:35028] CHIP:DMG:             Product Id = 32784
          [1655374218.456158][35023:35028] CHIP:DMG:             Product Id = 32785
          [1655374218.456196][35023:35028] CHIP:DMG:             Product Id = 32786
          [1655374218.456234][35023:35028] CHIP:DMG:             Product Id = 32787
          [1655374218.456271][35023:35028] CHIP:DMG:             Product Id = 32788
          [1655374218.456309][35023:35028] CHIP:DMG:             Product Id = 32789
          [1655374218.456347][35023:35028] CHIP:DMG:             Product Id = 32790
          [1655374218.456385][35023:35028] CHIP:DMG:             Product Id = 32791
          [1655374218.456423][35023:35028] CHIP:DMG:             Product Id = 32792
          [1655374218.456461][35023:35028] CHIP:DMG:             Product Id = 32793
          [1655374218.456498][35023:35028] CHIP:DMG:             Product Id = 32794
          [1655374218.456536][35023:35028] CHIP:DMG:             Product Id = 32795
          [1655374218.456573][35023:35028] CHIP:DMG:             Product Id = 32796
          [1655374218.456611][35023:35028] CHIP:DMG:             Product Id = 32797
          [1655374218.456649][35023:35028] CHIP:DMG:             Product Id = 32798
          [1655374218.456687][35023:35028] CHIP:DMG:             Product Id = 32799
          [1655374218.456724][35023:35028] CHIP:DMG:             Product Id = 32800
          [1655374218.456761][35023:35028] CHIP:DMG:             Product Id = 32801
          [1655374218.456799][35023:35028] CHIP:DMG:             Product Id = 32802
          [1655374218.456836][35023:35028] CHIP:DMG:             Product Id = 32803
          [1655374218.456874][35023:35028] CHIP:DMG:             Product Id = 32804
          [1655374218.456912][35023:35028] CHIP:DMG:             Product Id = 32805
          [1655374218.456949][35023:35028] CHIP:DMG:             Product Id = 32806
          [1655374218.456987][35023:35028] CHIP:DMG:             Product Id = 32807
          [1655374218.457024][35023:35028] CHIP:DMG:             Product Id = 32808
          [1655374218.457061][35023:35028] CHIP:DMG:             Product Id = 32809
          [1655374218.457099][35023:35028] CHIP:DMG:             Product Id = 32810
          [1655374218.457138][35023:35028] CHIP:DMG:             Product Id = 32811
          [1655374218.457175][35023:35028] CHIP:DMG:             Product Id = 32812
          [1655374218.457212][35023:35028] CHIP:DMG:             Product Id = 32813
          [1655374218.457250][35023:35028] CHIP:DMG:             Product Id = 32814
          [1655374218.457288][35023:35028] CHIP:DMG:             Product Id = 32815
          [1655374218.457326][35023:35028] CHIP:DMG:             Product Id = 32816
          [1655374218.457363][35023:35028] CHIP:DMG:             Product Id = 32817
          [1655374218.457401][35023:35028] CHIP:DMG:             Product Id = 32818
          [1655374218.457439][35023:35028] CHIP:DMG:             Product Id = 32819
          [1655374218.457476][35023:35028] CHIP:DMG:             Product Id = 32820
          [1655374218.457514][35023:35028] CHIP:DMG:             Product Id = 32821
          [1655374218.457552][35023:35028] CHIP:DMG:             Product Id = 32822
          [1655374218.457590][35023:35028] CHIP:DMG:             Product Id = 32823
          [1655374218.457627][35023:35028] CHIP:DMG:             Product Id = 32824
          [1655374218.457665][35023:35028] CHIP:DMG:             Product Id = 32825
          [1655374218.457702][35023:35028] CHIP:DMG:             Product Id = 32826
          [1655374218.457740][35023:35028] CHIP:DMG:             Product Id = 32827
          [1655374218.457777][35023:35028] CHIP:DMG:             Product Id = 32828
          [1655374218.457833][35023:35028] CHIP:DMG:             Product Id = 32829
          [1655374218.457874][35023:35028] CHIP:DMG:             Product Id = 32830
          [1655374218.457912][35023:35028] CHIP:DMG:             Product Id = 32831
          [1655374218.457950][35023:35028] CHIP:DMG:             Product Id = 32832
          [1655374218.457987][35023:35028] CHIP:DMG:             Product Id = 32833
          [1655374218.458026][35023:35028] CHIP:DMG:             Product Id = 32834
          [1655374218.458063][35023:35028] CHIP:DMG:             Product Id = 32835
          [1655374218.458101][35023:35028] CHIP:DMG:             Product Id = 32836
          [1655374218.458139][35023:35028] CHIP:DMG:             Product Id = 32837
          [1655374218.458177][35023:35028] CHIP:DMG:             Product Id = 32838
          [1655374218.458215][35023:35028] CHIP:DMG:             Product Id = 32839
          [1655374218.458253][35023:35028] CHIP:DMG:             Product Id = 32840
          [1655374218.458291][35023:35028] CHIP:DMG:             Product Id = 32841
          [1655374218.458328][35023:35028] CHIP:DMG:             Product Id = 32842
          [1655374218.458366][35023:35028] CHIP:DMG:             Product Id = 32843
          [1655374218.458404][35023:35028] CHIP:DMG:             Product Id = 32844
          [1655374218.458441][35023:35028] CHIP:DMG:             Product Id = 32845
          [1655374218.458480][35023:35028] CHIP:DMG:             Product Id = 32846
          [1655374218.458517][35023:35028] CHIP:DMG:             Product Id = 32847
          [1655374218.458555][35023:35028] CHIP:DMG:             Product Id = 32848
          [1655374218.458592][35023:35028] CHIP:DMG:             Product Id = 32849
          [1655374218.458630][35023:35028] CHIP:DMG:             Product Id = 32850
          [1655374218.458667][35023:35028] CHIP:DMG:             Product Id = 32851
          [1655374218.458706][35023:35028] CHIP:DMG:             Product Id = 32852
          [1655374218.458743][35023:35028] CHIP:DMG:             Product Id = 32853
          [1655374218.458781][35023:35028] CHIP:DMG:             Product Id = 32854
          [1655374218.458818][35023:35028] CHIP:DMG:             Product Id = 32855
          [1655374218.458856][35023:35028] CHIP:DMG:             Product Id = 32856
          [1655374218.458893][35023:35028] CHIP:DMG:             Product Id = 32857
          [1655374218.458932][35023:35028] CHIP:DMG:             Product Id = 32858
          [1655374218.458969][35023:35028] CHIP:DMG:             Product Id = 32859
          [1655374218.459007][35023:35028] CHIP:DMG:             Product Id = 32860
          [1655374218.459045][35023:35028] CHIP:DMG:             Product Id = 32861
          [1655374218.459082][35023:35028] CHIP:DMG:             Product Id = 32862
          [1655374218.459120][35023:35028] CHIP:DMG:             Product Id = 32863
          [1655374218.459159][35023:35028] CHIP:DMG:             Product Id = 32864
          [1655374218.459196][35023:35028] CHIP:DMG:             Product Id = 32865
          [1655374218.459234][35023:35028] CHIP:DMG:             Product Id = 32866
          [1655374218.459271][35023:35028] CHIP:DMG:             Product Id = 32867
          [1655374218.459309][35023:35028] CHIP:DMG:         }
          [1655374218.459347][35023:35028] CHIP:DMG:         Device Type Id = 22
          [1655374218.459390][35023:35028] CHIP:DMG:         Certificate Id (19) = ZIG20142ZB330003-24
          [1655374218.459430][35023:35028] CHIP:DMG:         Security Level = 0
          [1655374218.459470][35023:35028] CHIP:DMG:         Security Information = 0
          [1655374218.459508][35023:35028] CHIP:DMG:         Version Number = 9876
          [1655374218.459546][35023:35028] CHIP:DMG:         Certification Type = 0
      disabled: true

    - label:
          "AttestationElements field size should not be greater than
          RESP_MAX(900 bytes)"
      verification: |
          Verify AttestationElements field size should not be greater than RESP_MAX(900 bytes) on TH(chip-tool) log from step 5

          Attestation Elements (585 bytes) =
          [1655374218.453366][35023:35028] CHIP:DMG: {
          [1655374218.453431][35023:35028] CHIP:DMG:     Certification Declaration =
          [1655374218.453483][35023:35028] CHIP:DMG:     {
          [1655374218.455342][35023:35028] CHIP:DMG:         Format Version = 1
          [1655374218.455398][35023:35028] CHIP:DMG:         Vendor Id = 65521
          [1655374218.455438][35023:35028] CHIP:DMG:         Product Ids =
      disabled: true

    - label:
          "certification_declaration is present and is an octet string
          representation CMS-format certification declaration, as described in
          section 6.3.1"
      verification: |
          Verify  certification_declaration is present and is an octet string in TH(chip-tool) log:

          [1655374218.453303][35023:35028] CHIP:DMG: Attestation Elements (585 bytes) =
          [1655374218.453366][35023:35028] CHIP:DMG: {
          [1655374218.453431][35023:35028] CHIP:DMG:     Certification Declaration =
          [1655374218.453483][35023:35028] CHIP:DMG:     {
          [1655374218.455342][35023:35028] CHIP:DMG:         Format Version = 1
          [1655374218.455398][35023:35028] CHIP:DMG:         Vendor Id = 65521
          [1655374218.455438][35023:35028] CHIP:DMG:         Product Ids =
          [1655374218.455474][35023:35028] CHIP:DMG:         {
          [1655374218.455512][35023:35028] CHIP:DMG:             Product Id = 32768
          [1655374218.455552][35023:35028] CHIP:DMG:             Product Id = 32769
          [1655374218.455590][35023:35028] CHIP:DMG:             Product Id = 32770
          [1655374218.455628][35023:35028] CHIP:DMG:             Product Id = 32771
          [1655374218.455666][35023:35028] CHIP:DMG:             Product Id = 32772
          [1655374218.455704][35023:35028] CHIP:DMG:             Product Id = 32773
          [1655374218.455742][35023:35028] CHIP:DMG:             Product Id = 32774
          [1655374218.455780][35023:35028] CHIP:DMG:             Product Id = 32775
          [1655374218.455818][35023:35028] CHIP:DMG:             Product Id = 32776
          [1655374218.455855][35023:35028] CHIP:DMG:             Product Id = 32777
          [1655374218.455893][35023:35028] CHIP:DMG:             Product Id = 32778
          [1655374218.455931][35023:35028] CHIP:DMG:             Product Id = 32779
          [1655374218.455969][35023:35028] CHIP:DMG:             Product Id = 32780
          [1655374218.456007][35023:35028] CHIP:DMG:             Product Id = 32781
          [1655374218.456045][35023:35028] CHIP:DMG:             Product Id = 32782
          [1655374218.456082][35023:35028] CHIP:DMG:             Product Id = 32783
          [1655374218.456120][35023:35028] CHIP:DMG:             Product Id = 32784
          [1655374218.456158][35023:35028] CHIP:DMG:             Product Id = 32785
          [1655374218.456196][35023:35028] CHIP:DMG:             Product Id = 32786
          [1655374218.456234][35023:35028] CHIP:DMG:             Product Id = 32787
          [1655374218.456271][35023:35028] CHIP:DMG:             Product Id = 32788
          [1655374218.456309][35023:35028] CHIP:DMG:             Product Id = 32789
          [1655374218.456347][35023:35028] CHIP:DMG:             Product Id = 32790
          [1655374218.456385][35023:35028] CHIP:DMG:             Product Id = 32791
          [1655374218.456423][35023:35028] CHIP:DMG:             Product Id = 32792
          [1655374218.456461][35023:35028] CHIP:DMG:             Product Id = 32793
          [1655374218.456498][35023:35028] CHIP:DMG:             Product Id = 32794
          [1655374218.456536][35023:35028] CHIP:DMG:             Product Id = 32795
          [1655374218.456573][35023:35028] CHIP:DMG:             Product Id = 32796
          [1655374218.456611][35023:35028] CHIP:DMG:             Product Id = 32797
          [1655374218.456649][35023:35028] CHIP:DMG:             Product Id = 32798
          [1655374218.456687][35023:35028] CHIP:DMG:             Product Id = 32799
          [1655374218.456724][35023:35028] CHIP:DMG:             Product Id = 32800
          [1655374218.456761][35023:35028] CHIP:DMG:             Product Id = 32801
          [1655374218.456799][35023:35028] CHIP:DMG:             Product Id = 32802
          [1655374218.456836][35023:35028] CHIP:DMG:             Product Id = 32803
          [1655374218.456874][35023:35028] CHIP:DMG:             Product Id = 32804
          [1655374218.456912][35023:35028] CHIP:DMG:             Product Id = 32805
          [1655374218.456949][35023:35028] CHIP:DMG:             Product Id = 32806
          [1655374218.456987][35023:35028] CHIP:DMG:             Product Id = 32807
          [1655374218.457024][35023:35028] CHIP:DMG:             Product Id = 32808
          [1655374218.457061][35023:35028] CHIP:DMG:             Product Id = 32809
          [1655374218.457099][35023:35028] CHIP:DMG:             Product Id = 32810
          [1655374218.457138][35023:35028] CHIP:DMG:             Product Id = 32811
          [1655374218.457175][35023:35028] CHIP:DMG:             Product Id = 32812
          [1655374218.457212][35023:35028] CHIP:DMG:             Product Id = 32813
          [1655374218.457250][35023:35028] CHIP:DMG:             Product Id = 32814
          [1655374218.457288][35023:35028] CHIP:DMG:             Product Id = 32815
          [1655374218.457326][35023:35028] CHIP:DMG:             Product Id = 32816
          [1655374218.457363][35023:35028] CHIP:DMG:             Product Id = 32817
          [1655374218.457401][35023:35028] CHIP:DMG:             Product Id = 32818
          [1655374218.457439][35023:35028] CHIP:DMG:             Product Id = 32819
          [1655374218.457476][35023:35028] CHIP:DMG:             Product Id = 32820
          [1655374218.457514][35023:35028] CHIP:DMG:             Product Id = 32821
          [1655374218.457552][35023:35028] CHIP:DMG:             Product Id = 32822
          [1655374218.457590][35023:35028] CHIP:DMG:             Product Id = 32823
          [1655374218.457627][35023:35028] CHIP:DMG:             Product Id = 32824
          [1655374218.457665][35023:35028] CHIP:DMG:             Product Id = 32825
          [1655374218.457702][35023:35028] CHIP:DMG:             Product Id = 32826
          [1655374218.457740][35023:35028] CHIP:DMG:             Product Id = 32827
          [1655374218.457777][35023:35028] CHIP:DMG:             Product Id = 32828
          [1655374218.457833][35023:35028] CHIP:DMG:             Product Id = 32829
          [1655374218.457874][35023:35028] CHIP:DMG:             Product Id = 32830
          [1655374218.457912][35023:35028] CHIP:DMG:             Product Id = 32831
          [1655374218.457950][35023:35028] CHIP:DMG:             Product Id = 32832
          [1655374218.457987][35023:35028] CHIP:DMG:             Product Id = 32833
          [1655374218.458026][35023:35028] CHIP:DMG:             Product Id = 32834
          [1655374218.458063][35023:35028] CHIP:DMG:             Product Id = 32835
          [1655374218.458101][35023:35028] CHIP:DMG:             Product Id = 32836
          [1655374218.458139][35023:35028] CHIP:DMG:             Product Id = 32837
          [1655374218.458177][35023:35028] CHIP:DMG:             Product Id = 32838
          [1655374218.458215][35023:35028] CHIP:DMG:             Product Id = 32839
          [1655374218.458253][35023:35028] CHIP:DMG:             Product Id = 32840
          [1655374218.458291][35023:35028] CHIP:DMG:             Product Id = 32841
          [1655374218.458328][35023:35028] CHIP:DMG:             Product Id = 32842
          [1655374218.458366][35023:35028] CHIP:DMG:             Product Id = 32843
          [1655374218.458404][35023:35028] CHIP:DMG:             Product Id = 32844
          [1655374218.458441][35023:35028] CHIP:DMG:             Product Id = 32845
          [1655374218.458480][35023:35028] CHIP:DMG:             Product Id = 32846
          [1655374218.458517][35023:35028] CHIP:DMG:             Product Id = 32847
          [1655374218.458555][35023:35028] CHIP:DMG:             Product Id = 32848
          [1655374218.458592][35023:35028] CHIP:DMG:             Product Id = 32849
          [1655374218.458630][35023:35028] CHIP:DMG:             Product Id = 32850
          [1655374218.458667][35023:35028] CHIP:DMG:             Product Id = 32851
          [1655374218.458706][35023:35028] CHIP:DMG:             Product Id = 32852
          [1655374218.458743][35023:35028] CHIP:DMG:             Product Id = 32853
          [1655374218.458781][35023:35028] CHIP:DMG:             Product Id = 32854
          [1655374218.458818][35023:35028] CHIP:DMG:             Product Id = 32855
          [1655374218.458856][35023:35028] CHIP:DMG:             Product Id = 32856
          [1655374218.458893][35023:35028] CHIP:DMG:             Product Id = 32857
          [1655374218.458932][35023:35028] CHIP:DMG:             Product Id = 32858
          [1655374218.458969][35023:35028] CHIP:DMG:             Product Id = 32859
          [1655374218.459007][35023:35028] CHIP:DMG:             Product Id = 32860
          [1655374218.459045][35023:35028] CHIP:DMG:             Product Id = 32861
          [1655374218.459082][35023:35028] CHIP:DMG:             Product Id = 32862
          [1655374218.459120][35023:35028] CHIP:DMG:             Product Id = 32863
          [1655374218.459159][35023:35028] CHIP:DMG:             Product Id = 32864
          [1655374218.459196][35023:35028] CHIP:DMG:             Product Id = 32865
          [1655374218.459234][35023:35028] CHIP:DMG:             Product Id = 32866
          [1655374218.459271][35023:35028] CHIP:DMG:             Product Id = 32867
          [1655374218.459309][35023:35028] CHIP:DMG:         }
          [1655374218.459347][35023:35028] CHIP:DMG:         Device Type Id = 22
          [1655374218.459390][35023:35028] CHIP:DMG:         Certificate Id (19) = ZIG20142ZB330003-24
          [1655374218.459430][35023:35028] CHIP:DMG:         Security Level = 0
          [1655374218.459470][35023:35028] CHIP:DMG:         Security Information = 0
          [1655374218.459508][35023:35028] CHIP:DMG:         Version Number = 9876
          [1655374218.459546][35023:35028] CHIP:DMG:         Certification Type = 0
      disabled: true

    - label:
          "Verify for the following contents of CD: format_version = 1 ,The
          vendor_id field matches the one saved as basic_info_vendor_id saved
          earlier ,The vendor_id field is in range [0x0001 .. 0xFFF0] ,The
          product_id_array field contains the value of basic_info_product_id
          saved earlier ,device_type_id has a value between 0 and (2^31 - 1)
          ,security level = 0 ,security_information = 0 ,version_number is an
          integer in range 0..65535 ,certification_type has a value between 1..2"
      verification: |
          Verify Verify for the following contents of CD (certificate declaration) in TH (chip-tool) log:
          format_version = 1,
          vendor_id matches the basic_info_vendor_id,
          product_id_array matches the basic_info_product_id saved earlier,
          device_type_id value should between 0 and (2^31 - 1),
          certificate_id,
          security level = 0,
          security_information = 0,
          version_number should be in range 0..65535,
          certification_type should be  between 1..2

          Verify if the VID PID info in here matches with the steps above

          [1655374218.453303][35023:35028] CHIP:DMG: Attestation Elements (585 bytes) =
          [1655374218.453366][35023:35028] CHIP:DMG: {
          [1655374218.453431][35023:35028] CHIP:DMG:     Certification Declaration =
          [1655374218.453483][35023:35028] CHIP:DMG:     {
          [1655374218.455342][35023:35028] CHIP:DMG:         Format Version = 1
          [1655374218.455398][35023:35028] CHIP:DMG:         Vendor Id = 65521
          [1655374218.455438][35023:35028] CHIP:DMG:         Product Ids =
          [1655374218.455474][35023:35028] CHIP:DMG:         {
          [1655374218.455512][35023:35028] CHIP:DMG:             Product Id = 32768
          [1655374218.455552][35023:35028] CHIP:DMG:             Product Id = 32769
          [1655374218.455590][35023:35028] CHIP:DMG:             Product Id = 32770
          [1655374218.455628][35023:35028] CHIP:DMG:             Product Id = 32771
          [1655374218.455666][35023:35028] CHIP:DMG:             Product Id = 32772
          [1655374218.455704][35023:35028] CHIP:DMG:             Product Id = 32773
          [1655374218.455742][35023:35028] CHIP:DMG:             Product Id = 32774
          [1655374218.455780][35023:35028] CHIP:DMG:             Product Id = 32775
          [1655374218.455818][35023:35028] CHIP:DMG:             Product Id = 32776
          [1655374218.455855][35023:35028] CHIP:DMG:             Product Id = 32777
          [1655374218.455893][35023:35028] CHIP:DMG:             Product Id = 32778
          [1655374218.455931][35023:35028] CHIP:DMG:             Product Id = 32779
          [1655374218.455969][35023:35028] CHIP:DMG:             Product Id = 32780
          [1655374218.456007][35023:35028] CHIP:DMG:             Product Id = 32781
          [1655374218.456045][35023:35028] CHIP:DMG:             Product Id = 32782
          [1655374218.456082][35023:35028] CHIP:DMG:             Product Id = 32783
          [1655374218.456120][35023:35028] CHIP:DMG:             Product Id = 32784
          [1655374218.456158][35023:35028] CHIP:DMG:             Product Id = 32785
          [1655374218.456196][35023:35028] CHIP:DMG:             Product Id = 32786
          [1655374218.456234][35023:35028] CHIP:DMG:             Product Id = 32787
          [1655374218.456271][35023:35028] CHIP:DMG:             Product Id = 32788
          [1655374218.456309][35023:35028] CHIP:DMG:             Product Id = 32789
          [1655374218.456347][35023:35028] CHIP:DMG:             Product Id = 32790
          [1655374218.456385][35023:35028] CHIP:DMG:             Product Id = 32791
          [1655374218.456423][35023:35028] CHIP:DMG:             Product Id = 32792
          [1655374218.456461][35023:35028] CHIP:DMG:             Product Id = 32793
          [1655374218.456498][35023:35028] CHIP:DMG:             Product Id = 32794
          [1655374218.456536][35023:35028] CHIP:DMG:             Product Id = 32795
          [1655374218.456573][35023:35028] CHIP:DMG:             Product Id = 32796
          [1655374218.456611][35023:35028] CHIP:DMG:             Product Id = 32797
          [1655374218.456649][35023:35028] CHIP:DMG:             Product Id = 32798
          [1655374218.456687][35023:35028] CHIP:DMG:             Product Id = 32799
          [1655374218.456724][35023:35028] CHIP:DMG:             Product Id = 32800
          [1655374218.456761][35023:35028] CHIP:DMG:             Product Id = 32801
          [1655374218.456799][35023:35028] CHIP:DMG:             Product Id = 32802
          [1655374218.456836][35023:35028] CHIP:DMG:             Product Id = 32803
          [1655374218.456874][35023:35028] CHIP:DMG:             Product Id = 32804
          [1655374218.456912][35023:35028] CHIP:DMG:             Product Id = 32805
          [1655374218.456949][35023:35028] CHIP:DMG:             Product Id = 32806
          [1655374218.456987][35023:35028] CHIP:DMG:             Product Id = 32807
          [1655374218.457024][35023:35028] CHIP:DMG:             Product Id = 32808
          [1655374218.457061][35023:35028] CHIP:DMG:             Product Id = 32809
          [1655374218.457099][35023:35028] CHIP:DMG:             Product Id = 32810
          [1655374218.457138][35023:35028] CHIP:DMG:             Product Id = 32811
          [1655374218.457175][35023:35028] CHIP:DMG:             Product Id = 32812
          [1655374218.457212][35023:35028] CHIP:DMG:             Product Id = 32813
          [1655374218.457250][35023:35028] CHIP:DMG:             Product Id = 32814
          [1655374218.457288][35023:35028] CHIP:DMG:             Product Id = 32815
          [1655374218.457326][35023:35028] CHIP:DMG:             Product Id = 32816
          [1655374218.457363][35023:35028] CHIP:DMG:             Product Id = 32817
          [1655374218.457401][35023:35028] CHIP:DMG:             Product Id = 32818
          [1655374218.457439][35023:35028] CHIP:DMG:             Product Id = 32819
          [1655374218.457476][35023:35028] CHIP:DMG:             Product Id = 32820
          [1655374218.457514][35023:35028] CHIP:DMG:             Product Id = 32821
          [1655374218.457552][35023:35028] CHIP:DMG:             Product Id = 32822
          [1655374218.457590][35023:35028] CHIP:DMG:             Product Id = 32823
          [1655374218.457627][35023:35028] CHIP:DMG:             Product Id = 32824
          [1655374218.457665][35023:35028] CHIP:DMG:             Product Id = 32825
          [1655374218.457702][35023:35028] CHIP:DMG:             Product Id = 32826
          [1655374218.457740][35023:35028] CHIP:DMG:             Product Id = 32827
          [1655374218.457777][35023:35028] CHIP:DMG:             Product Id = 32828
          [1655374218.457833][35023:35028] CHIP:DMG:             Product Id = 32829
          [1655374218.457874][35023:35028] CHIP:DMG:             Product Id = 32830
          [1655374218.457912][35023:35028] CHIP:DMG:             Product Id = 32831
          [1655374218.457950][35023:35028] CHIP:DMG:             Product Id = 32832
          [1655374218.457987][35023:35028] CHIP:DMG:             Product Id = 32833
          [1655374218.458026][35023:35028] CHIP:DMG:             Product Id = 32834
          [1655374218.458063][35023:35028] CHIP:DMG:             Product Id = 32835
          [1655374218.458101][35023:35028] CHIP:DMG:             Product Id = 32836
          [1655374218.458139][35023:35028] CHIP:DMG:             Product Id = 32837
          [1655374218.458177][35023:35028] CHIP:DMG:             Product Id = 32838
          [1655374218.458215][35023:35028] CHIP:DMG:             Product Id = 32839
          [1655374218.458253][35023:35028] CHIP:DMG:             Product Id = 32840
          [1655374218.458291][35023:35028] CHIP:DMG:             Product Id = 32841
          [1655374218.458328][35023:35028] CHIP:DMG:             Product Id = 32842
          [1655374218.458366][35023:35028] CHIP:DMG:             Product Id = 32843
          [1655374218.458404][35023:35028] CHIP:DMG:             Product Id = 32844
          [1655374218.458441][35023:35028] CHIP:DMG:             Product Id = 32845
          [1655374218.458480][35023:35028] CHIP:DMG:             Product Id = 32846
          [1655374218.458517][35023:35028] CHIP:DMG:             Product Id = 32847
          [1655374218.458555][35023:35028] CHIP:DMG:             Product Id = 32848
          [1655374218.458592][35023:35028] CHIP:DMG:             Product Id = 32849
          [1655374218.458630][35023:35028] CHIP:DMG:             Product Id = 32850
          [1655374218.458667][35023:35028] CHIP:DMG:             Product Id = 32851
          [1655374218.458706][35023:35028] CHIP:DMG:             Product Id = 32852
          [1655374218.458743][35023:35028] CHIP:DMG:             Product Id = 32853
          [1655374218.458781][35023:35028] CHIP:DMG:             Product Id = 32854
          [1655374218.458818][35023:35028] CHIP:DMG:             Product Id = 32855
          [1655374218.458856][35023:35028] CHIP:DMG:             Product Id = 32856
          [1655374218.458893][35023:35028] CHIP:DMG:             Product Id = 32857
          [1655374218.458932][35023:35028] CHIP:DMG:             Product Id = 32858
          [1655374218.458969][35023:35028] CHIP:DMG:             Product Id = 32859
          [1655374218.459007][35023:35028] CHIP:DMG:             Product Id = 32860
          [1655374218.459045][35023:35028] CHIP:DMG:             Product Id = 32861
          [1655374218.459082][35023:35028] CHIP:DMG:             Product Id = 32862
          [1655374218.459120][35023:35028] CHIP:DMG:             Product Id = 32863
          [1655374218.459159][35023:35028] CHIP:DMG:             Product Id = 32864
          [1655374218.459196][35023:35028] CHIP:DMG:             Product Id = 32865
          [1655374218.459234][35023:35028] CHIP:DMG:             Product Id = 32866
          [1655374218.459271][35023:35028] CHIP:DMG:             Product Id = 32867
          [1655374218.459309][35023:35028] CHIP:DMG:         }
          [1655374218.459347][35023:35028] CHIP:DMG:         Device Type Id = 22
          [1655374218.459390][35023:35028] CHIP:DMG:         Certificate Id (19) = ZIG20142ZB330003-24
          [1655374218.459430][35023:35028] CHIP:DMG:         Security Level = 0
          [1655374218.459470][35023:35028] CHIP:DMG:         Security Information = 0
          [1655374218.459508][35023:35028] CHIP:DMG:         Version Number = 9876
          [1655374218.459546][35023:35028] CHIP:DMG:         Certification Type = 0
      disabled: true

    - label:
          "Confirm that either both the fields dac_origin_vendor_id and
          dac_origin_product_id are present in Certification Declaration ,Or
          confirm both the fields dac_origin_vendor_id and dac_origin_product_id
          are not present in the Certification Declaration"
      PICS:
          MCORE.DA.CERTDECL_ORIGIN_VENDORID &&
          MCORE.DA.CERTDECL_ORIGIN_PRODUCTID
      verification: |
          Verify dac_origin_vendor_id and dac_origin_product_id  are present in Certification Declaration in TH(chip-tool) log: , These are optional parameters, we need not fail the test step if those are not present

          [1655374218.453303][35023:35028] CHIP:DMG: Attestation Elements (585 bytes) =
          [1655374218.453366][35023:35028] CHIP:DMG: {
          [1655374218.453431][35023:35028] CHIP:DMG:     Certification Declaration =
          [1655374218.453483][35023:35028] CHIP:DMG:     {
          [1655374218.455342][35023:35028] CHIP:DMG:         Format Version = 1
          [1655374218.455398][35023:35028] CHIP:DMG:         Vendor Id = 65521
          [1655374218.455438][35023:35028] CHIP:DMG:         Product Ids =
          [1655374218.455474][35023:35028] CHIP:DMG:         {
          [1655374218.455512][35023:35028] CHIP:DMG:             Product Id = 32768
          [1655374218.455552][35023:35028] CHIP:DMG:             Product Id = 32769
          [1655374218.455590][35023:35028] CHIP:DMG:             Product Id = 32770
          [1655374218.455628][35023:35028] CHIP:DMG:             Product Id = 32771
          [1655374218.455666][35023:35028] CHIP:DMG:             Product Id = 32772
          [1655374218.455704][35023:35028] CHIP:DMG:             Product Id = 32773
          [1655374218.455742][35023:35028] CHIP:DMG:             Product Id = 32774
          [1655374218.455780][35023:35028] CHIP:DMG:             Product Id = 32775
          [1655374218.455818][35023:35028] CHIP:DMG:             Product Id = 32776
          [1655374218.455855][35023:35028] CHIP:DMG:             Product Id = 32777
          [1655374218.455893][35023:35028] CHIP:DMG:             Product Id = 32778
          [1655374218.455931][35023:35028] CHIP:DMG:             Product Id = 32779
          [1655374218.455969][35023:35028] CHIP:DMG:             Product Id = 32780
          [1655374218.456007][35023:35028] CHIP:DMG:             Product Id = 32781
          [1655374218.456045][35023:35028] CHIP:DMG:             Product Id = 32782
          [1655374218.456082][35023:35028] CHIP:DMG:             Product Id = 32783
          [1655374218.456120][35023:35028] CHIP:DMG:             Product Id = 32784
          [1655374218.456158][35023:35028] CHIP:DMG:             Product Id = 32785
          [1655374218.456196][35023:35028] CHIP:DMG:             Product Id = 32786
          [1655374218.456234][35023:35028] CHIP:DMG:             Product Id = 32787
          [1655374218.456271][35023:35028] CHIP:DMG:             Product Id = 32788
          [1655374218.456309][35023:35028] CHIP:DMG:             Product Id = 32789
          [1655374218.456347][35023:35028] CHIP:DMG:             Product Id = 32790
          [1655374218.456385][35023:35028] CHIP:DMG:             Product Id = 32791
          [1655374218.456423][35023:35028] CHIP:DMG:             Product Id = 32792
          [1655374218.456461][35023:35028] CHIP:DMG:             Product Id = 32793
          [1655374218.456498][35023:35028] CHIP:DMG:             Product Id = 32794
          [1655374218.456536][35023:35028] CHIP:DMG:             Product Id = 32795
          [1655374218.456573][35023:35028] CHIP:DMG:             Product Id = 32796
          [1655374218.456611][35023:35028] CHIP:DMG:             Product Id = 32797
          [1655374218.456649][35023:35028] CHIP:DMG:             Product Id = 32798
          [1655374218.456687][35023:35028] CHIP:DMG:             Product Id = 32799
          [1655374218.456724][35023:35028] CHIP:DMG:             Product Id = 32800
          [1655374218.456761][35023:35028] CHIP:DMG:             Product Id = 32801
          [1655374218.456799][35023:35028] CHIP:DMG:             Product Id = 32802
          [1655374218.456836][35023:35028] CHIP:DMG:             Product Id = 32803
          [1655374218.456874][35023:35028] CHIP:DMG:             Product Id = 32804
          [1655374218.456912][35023:35028] CHIP:DMG:             Product Id = 32805
          [1655374218.456949][35023:35028] CHIP:DMG:             Product Id = 32806
          [1655374218.456987][35023:35028] CHIP:DMG:             Product Id = 32807
          [1655374218.457024][35023:35028] CHIP:DMG:             Product Id = 32808
          [1655374218.457061][35023:35028] CHIP:DMG:             Product Id = 32809
          [1655374218.457099][35023:35028] CHIP:DMG:             Product Id = 32810
          [1655374218.457138][35023:35028] CHIP:DMG:             Product Id = 32811
          [1655374218.457175][35023:35028] CHIP:DMG:             Product Id = 32812
          [1655374218.457212][35023:35028] CHIP:DMG:             Product Id = 32813
          [1655374218.457250][35023:35028] CHIP:DMG:             Product Id = 32814
          [1655374218.457288][35023:35028] CHIP:DMG:             Product Id = 32815
          [1655374218.457326][35023:35028] CHIP:DMG:             Product Id = 32816
          [1655374218.457363][35023:35028] CHIP:DMG:             Product Id = 32817
          [1655374218.457401][35023:35028] CHIP:DMG:             Product Id = 32818
          [1655374218.457439][35023:35028] CHIP:DMG:             Product Id = 32819
          [1655374218.457476][35023:35028] CHIP:DMG:             Product Id = 32820
          [1655374218.457514][35023:35028] CHIP:DMG:             Product Id = 32821
          [1655374218.457552][35023:35028] CHIP:DMG:             Product Id = 32822
          [1655374218.457590][35023:35028] CHIP:DMG:             Product Id = 32823
          [1655374218.457627][35023:35028] CHIP:DMG:             Product Id = 32824
          [1655374218.457665][35023:35028] CHIP:DMG:             Product Id = 32825
          [1655374218.457702][35023:35028] CHIP:DMG:             Product Id = 32826
          [1655374218.457740][35023:35028] CHIP:DMG:             Product Id = 32827
          [1655374218.457777][35023:35028] CHIP:DMG:             Product Id = 32828
          [1655374218.457833][35023:35028] CHIP:DMG:             Product Id = 32829
          [1655374218.457874][35023:35028] CHIP:DMG:             Product Id = 32830
          [1655374218.457912][35023:35028] CHIP:DMG:             Product Id = 32831
          [1655374218.457950][35023:35028] CHIP:DMG:             Product Id = 32832
          [1655374218.457987][35023:35028] CHIP:DMG:             Product Id = 32833
          [1655374218.458026][35023:35028] CHIP:DMG:             Product Id = 32834
          [1655374218.458063][35023:35028] CHIP:DMG:             Product Id = 32835
          [1655374218.458101][35023:35028] CHIP:DMG:             Product Id = 32836
          [1655374218.458139][35023:35028] CHIP:DMG:             Product Id = 32837
          [1655374218.458177][35023:35028] CHIP:DMG:             Product Id = 32838
          [1655374218.458215][35023:35028] CHIP:DMG:             Product Id = 32839
          [1655374218.458253][35023:35028] CHIP:DMG:             Product Id = 32840
          [1655374218.458291][35023:35028] CHIP:DMG:             Product Id = 32841
          [1655374218.458328][35023:35028] CHIP:DMG:             Product Id = 32842
          [1655374218.458366][35023:35028] CHIP:DMG:             Product Id = 32843
          [1655374218.458404][35023:35028] CHIP:DMG:             Product Id = 32844
          [1655374218.458441][35023:35028] CHIP:DMG:             Product Id = 32845
          [1655374218.458480][35023:35028] CHIP:DMG:             Product Id = 32846
          [1655374218.458517][35023:35028] CHIP:DMG:             Product Id = 32847
          [1655374218.458555][35023:35028] CHIP:DMG:             Product Id = 32848
          [1655374218.458592][35023:35028] CHIP:DMG:             Product Id = 32849
          [1655374218.458630][35023:35028] CHIP:DMG:             Product Id = 32850
          [1655374218.458667][35023:35028] CHIP:DMG:             Product Id = 32851
          [1655374218.458706][35023:35028] CHIP:DMG:             Product Id = 32852
          [1655374218.458743][35023:35028] CHIP:DMG:             Product Id = 32853
          [1655374218.458781][35023:35028] CHIP:DMG:             Product Id = 32854
          [1655374218.458818][35023:35028] CHIP:DMG:             Product Id = 32855
          [1655374218.458856][35023:35028] CHIP:DMG:             Product Id = 32856
          [1655374218.458893][35023:35028] CHIP:DMG:             Product Id = 32857
          [1655374218.458932][35023:35028] CHIP:DMG:             Product Id = 32858
          [1655374218.458969][35023:35028] CHIP:DMG:             Product Id = 32859
          [1655374218.459007][35023:35028] CHIP:DMG:             Product Id = 32860
          [1655374218.459045][35023:35028] CHIP:DMG:             Product Id = 32861
          [1655374218.459082][35023:35028] CHIP:DMG:             Product Id = 32862
          [1655374218.459120][35023:35028] CHIP:DMG:             Product Id = 32863
          [1655374218.459159][35023:35028] CHIP:DMG:             Product Id = 32864
          [1655374218.459196][35023:35028] CHIP:DMG:             Product Id = 32865
          [1655374218.459234][35023:35028] CHIP:DMG:             Product Id = 32866
          [1655374218.459271][35023:35028] CHIP:DMG:             Product Id = 32867
          [1655374218.459309][35023:35028] CHIP:DMG:         }
          [1655374218.459347][35023:35028] CHIP:DMG:         Device Type Id = 22
          [1655374218.459390][35023:35028] CHIP:DMG:         Certificate Id (19) = ZIG20142ZB330003-24
          [1655374218.459430][35023:35028] CHIP:DMG:         Security Level = 0
          [1655374218.459470][35023:35028] CHIP:DMG:         Security Information = 0
          [1655374218.459508][35023:35028] CHIP:DMG:         Version Number = 9876
          [1655374218.459546][35023:35028] CHIP:DMG:         Certification Type = 0
      disabled: true

    - label:
          "If the Certification Declaration has both the dac_origin_vendor_id
          and the dac_origin_product_id fields then check for the following
          conditions: ,The Vendor ID (VID) in the DAC subject and PAI subject
          are the same as the dac_origin_vendor_id field in the Certification
          Declaration. ,The Product ID (PID) in the DAC subject is same as the
          dac_origin_product_id field in the Certification Declaration. ,If it
          is present in the PAI certificate, the Product ID (PID) in the subject
          is same as the dac_origin_product_id field in the Certification
          Declaration"
      PICS:
          MCORE.DA.CERTDECL_ORIGIN_VENDORID &&
          MCORE.DA.CERTDECL_ORIGIN_PRODUCTID
      verification: |
          Print the DAC and PAI that you saved earlier using

          openssl x509 -in dac.pem -text
          openssl x509 -in pai.pem -text

          The output looks like something below. Pls verify if the VID and PIDs mentioned here are matching with information in CD
          Certificate:
              Data:
                  Version: 3 (0x2)
                  Serial Number: 7624014786269105873 (0x69cdf10de9e54ed1)
                  Signature Algorithm: ecdsa-with-SHA256
                  Issuer: CN = Matter Dev PAI 0xFFF1 no PID, 1.3.6.1.4.1.37244.2.1 = FFF1
                  Validity
                      Not Before: Feb  5 00:00:00 2022 GMT
                      Not After : Dec 31 23:59:59 9999 GMT
                  Subject: CN = Matter Dev DAC 0xFFF1/0x8001, 1.3.6.1.4.1.37244.2.1 = FFF1, 1.3.6.1.4.1.37244.2.2 = 8001
                  Subject Public Key Info:
                      Public Key Algorithm: id-ecPublicKey
                          Public-Key: (256 bit)
                          pub:
                              04:46:3a:c6:93:42:91:0a:0e:55:88:fc:6f:f5:6b:
                              b6:3e:62:ec:ce:cb:14:8f:7d:4e:b0:3e:e5:52:60:
                              14:15:76:7d:16:a5:c6:63:f7:93:e4:91:23:26:0b:
                              82:97:a7:cd:7e:7c:fc:7b:31:6b:39:d9:8e:90:d2:
                              93:77:73:8e:82
                          ASN1 OID: prime256v1
                          NIST CURVE: P-256
                  X509v3 extensions:
      disabled: true

    - label:
          "If the Certification Declaration has neither the dac_origin_vendor_id
          nor the dac_origin_product_id fields then check for the following
          conditions: ,The Vendor ID (VID) in the DAC subject and PAI subject
          are the same as the vendor_id field in the Certification
          Declaration.,The Product ID (PID) subject DN in the DAC is contained
          in the product_id_array field in the Certification Declaration. ,If it
          is present in the PAI certificate, the Product ID (PID) in the subject
          is contained in the product_id_array field in the Certification
          Declaration."
      PICS:
          MCORE.DA.CERTDECL_ORIGIN_VENDORID &&
          MCORE.DA.CERTDECL_ORIGIN_PRODUCTID
      verification: |
          Verify The Vendor ID (VID) in the DAC subject and PAI subject are the same as the vendor_id field in the Certification Declaration.
          To decode the DAC/PAI subject, refer TC-DA-1.7 - step 6 & then verify the vendorID and ProductID is same from the previous step log output.


          Certificate:
              Data:
                  Version: 3 (0x2)
                  Serial Number: 7624014786269105873 (0x69cdf10de9e54ed1)
                  Signature Algorithm: ecdsa-with-SHA256
                  Issuer: CN = Matter Dev PAI 0xFFF1 no PID, 1.3.6.1.4.1.37244.2.1 = FFF1
                  Validity
                      Not Before: Feb  5 00:00:00 2022 GMT
                      Not After : Dec 31 23:59:59 9999 GMT
                  Subject: CN = Matter Dev DAC 0xFFF1/0x8001, 1.3.6.1.4.1.37244.2.1 = FFF1, 1.3.6.1.4.1.37244.2.2 = 8001
                  Subject Public Key Info:
                      Public Key Algorithm: id-ecPublicKey
                          Public-Key: (256 bit)
                          pub:
                              04:46:3a:c6:93:42:91:0a:0e:55:88:fc:6f:f5:6b:
                              b6:3e:62:ec:ce:cb:14:8f:7d:4e:b0:3e:e5:52:60:
                              14:15:76:7d:16:a5:c6:63:f7:93:e4:91:23:26:0b:
                              82:97:a7:cd:7e:7c:fc:7b:31:6b:39:d9:8e:90:d2:
                              93:77:73:8e:82
                          ASN1 OID: prime256v1
                          NIST CURVE: P-256
                  X509v3 extensions:
      disabled: true

    - label:
          "If the Certification Declaration has authorized_paa_list then check
          for the following conditions: The authority key id extension of the
          PAI certificate matches the one found in the authorized_paa_list"
      PICS: MCORE.DA.CERTDECL_AUTH_PAA
      verification: |
          The reference applications (all-cluster-app..etc) do not have the authorized_paa_list as it is optional.

          If the authorized_paa_list is available, verify if the PAI chains to PAA using the commands
          1. openssl x509 -in pai.pem -text
          2. openssl x509 -in <PAAListinTH>.pem -text
          compare the Authority Key Identifier printed in step1 with the printed in step2. Repeat this to verify on all PAAs.
      disabled: true

    - label:
          "Verify that the certification_declaration CMS enveloped can be
          verified with the well-known Certification Declaration public key used
          to originally sign the Certification Declaration"
      verification: |
          Out of scope for V1.0,
      disabled: true

    - label:
          "attestation_nonce is present in the attestation_elements_message
          structure ,attestation_nonce value matches the AttestationNonce field
          value sent in the AttestationRequest Command sent by the commissioner
          ,attestation_nonce is a 32 byte-long octet string"
      verification: |
          Verify Attestation Nonce in TH Log:
          [1655374218.459470][35023:35028] CHIP:DMG:         Security Information = 0
          [1655374218.459508][35023:35028] CHIP:DMG:         Version Number = 9876
          [1655374218.459546][35023:35028] CHIP:DMG:         Certification Type = 0
          [1655374218.459584][35023:35028] CHIP:DMG:     }
          [1655374218.459627][35023:35028] CHIP:DMG:     Attestation Nonce (32) = 762B6B9DA08F7FC63BB693E38634EC6F87CEFF28AB1554A16AD43DCEC24C2466
          [1655374218.459664][35023:35028] CHIP:DMG:     Timestamp = 0
          [1655374218.459699][35023:35028] CHIP:DMG: }
      disabled: true

    - label:
          "firmware_information is optional, may be present ,if
          firmware_information field is present it is a octet string"
      PICS: MCORE.DA.ATTESTELEMENT_FW_INFO
      verification: |
          firmware_information is optional, may be present
      disabled: true

    - label:
          "Using Crypto_Verify cryptographic primitive, validate that the
          AttestationSignature from the AttestationResponse Command is valid if
          verified against a message constructed by concatenating
          AttestationElements with the attestation challenge associated with the
          secure session over which the AttestationResponse was obtained, using
          the subject public key found in the DAC."
      verification: |
          Out of scope for V1.0, which requires a specific decode tool in chip-cert tool to decode the signature & construct a new message.
      disabled: true

    - label:
          "Verify that the PAA subject public key and subject match one of the
          official PAA certificates found in the Distributed Compliance Ledger."
      verification: |
          For SVE-2, verify if the PAA subject key matches with the list of PAA stored in the TH. For 1.0 certification, verify the PAA subject matches one of the official PAA certificates found in DCL.  To get the PAA subject public key from the test PAA stored in TH, use the command below. For 1.0 cert, Extract the subject public key in similar way and compare if it matches with the certs stored in DCL.

          $openssl x509 -in credentials/development/paa-root-certs/Chip-Test-PAA-FFF1-Cert.pem -text
          Certificate:
              Data:
                  Version: 3 (0x2)
                  Serial Number: 5668035430391749660 (0x4ea8e83182d41c1c)
                  Signature Algorithm: ecdsa-with-SHA256
                  Issuer: CN = Matter Test PAA, 1.3.6.1.4.1.37244.2.1 = FFF1
                  Validity
                      Not Before: Jun 28 14:23:43 2021 GMT
                      Not After : Dec 31 23:59:59 9999 GMT
                  Subject: CN = Matter Test PAA, 1.3.6.1.4.1.37244.2.1 = FFF1
                  Subject Public Key Info:
                      Public Key Algorithm: id-ecPublicKey
                          Public-Key: (256 bit)
                          pub:
                              04:b6:cb:63:72:88:7f:29:28:f5:ba:c8:1a:a9:d9:
                              3a:e2:43:1c:ad:a9:d7:9e:24:2f:65:17:7e:f9:ce:
                              d9:32:a2:8e:cd:03:ba:af:6a:8f:ca:18:4a:1a:50:
                              35:42:96:0d:45:3f:30:3f:1f:19:42:1d:75:1e:8f:
                              8f:1a:9a:9b:75
                          ASN1 OID: prime256v1
                          NIST CURVE: P-256
                  X509v3 extensions:
                      X509v3 Basic Constraints: critical
                          CA:TRUE, pathlen:1
                      X509v3 Key Usage: critical
                          Certificate Sign, CRL Sign
                      X509v3 Subject Key Identifier:
                          6A:FD:22:77:1F:51:1F:EC:BF:16:41:97:67:10:DC:DC:31:A1:71:7E
                      X509v3 Authority Key Identifier:
                          keyid:6A:FD:22:77:1F:51:1F:EC:BF:16:41:97:67:10:DC:DC:31:A1:71:7E

              Signature Algorithm: ecdsa-with-SHA256
                   30:44:02:20:50:aa:80:02:f4:d9:32:a9:a0:05:38:f6:53:68:
                   ad:0f:ff:c8:ef:bb:c9:be:b7:da:56:98:35:cf:9a:a7:51:0e:
                   02:20:23:ba:c8:fe:0f:23:e7:54:45:b6:53:39:08:1a:47:99:
                   49:29:c7:2a:af:0a:15:48:d4:0d:03:4d:51:4b:25:de
      disabled: true

    - label:
          "TH1 sends AttestationRequestCommand with Invalid AttestationNonce
          (size> 32 bytes) as the field to the DUT."
      verification: |
          Verify INVALID_COMMAND error when Attestation Request sent with attestation nonce >32 byte  in TH(chip-tool) Log:

           ./chip-tool operationalcredentials attestation-request   762B6B9DA08F7FC63BB693E38634EC6F87CEFF28AB1554A16AD43DCEC24C2466A16AD43DCEC24C2466   1 0  --trace_decode 1

          [1655984597.150863][23339:23344] CHIP:DMG: InvokeResponseMessage =
          [1655984597.150923][23339:23344] CHIP:DMG: {
          [1655984597.150981][23339:23344] CHIP:DMG:         suppressResponse = false,
          [1655984597.151042][23339:23344] CHIP:DMG:         InvokeResponseIBs =
          [1655984597.151117][23339:23344] CHIP:DMG:         [
          [1655984597.151177][23339:23344] CHIP:DMG:                 InvokeResponseIB =
          [1655984597.151255][23339:23344] CHIP:DMG:                 {
          [1655984597.151318][23339:23344] CHIP:DMG:                         CommandStatusIB =
          [1655984597.151404][23339:23344] CHIP:DMG:                         {
          [1655984597.151475][23339:23344] CHIP:DMG:                                 CommandPathIB =
          [1655984597.151561][23339:23344] CHIP:DMG:                                 {
          [1655984597.151644][23339:23344] CHIP:DMG:                                         EndpointId = 0x0,
          [1655984597.151729][23339:23344] CHIP:DMG:                                         ClusterId = 0x3e,
          [1655984597.151812][23339:23344] CHIP:DMG:                                         CommandId = 0x0,
          [1655984597.151890][23339:23344] CHIP:DMG:                                 },
          [1655984597.151978][23339:23344] CHIP:DMG:
          [1655984597.152050][23339:23344] CHIP:DMG:                                 StatusIB =
          [1655984597.152127][23339:23344] CHIP:DMG:                                 {
          [1655984597.152216][23339:23344] CHIP:DMG:                                         status = 0x85 (INVALID_COMMAND),
          [1655984597.152297][23339:23344] CHIP:DMG:                                 },
          [1655984597.152377][23339:23344] CHIP:DMG:
          [1655984597.152449][23339:23344] CHIP:DMG:                         },
          [1655984597.152527][23339:23344] CHIP:DMG:
          [1655984597.152593][23339:23344] CHIP:DMG:                 },
          [1655984597.152666][23339:23344] CHIP:DMG:
          [1655984597.152723][23339:23344] CHIP:DMG:         ],
          [1655984597.152794][23339:23344] CHIP:DMG:
          [1655984597.152852][23339:23344] CHIP:DMG:         InteractionModelRevision = 1
          [1655984597.152908][23339:23344] CHIP:DMG: },
          [1655984597.153037][23339:23344] CHIP:DMG: Received Command Response Status for Endpoint=0 Cluster=0x0000_003E Command=0x0000_0000 Status=0x85
          [1655984597.153112][23339:23344] CHIP:TOO: Error: IM Error 0x00000585: General error: 0x85 (INVALID_COMMAND)
          [1655984597.153256][23339:23344] CHIP:DMG: ICR moving to [AwaitingDe]
      disabled: true

    - label:
          "TH1 sends AttestationRequestCommand with invalid AttestationNonce
          (size < 32 bytes) as the field to the DUT."
      verification: |
          Verify INVALID_COMMAND error when Attestation Request sent with attestation nonce <32 byte  in TH(chip-tool) Log:

          ./chip-tool operationalcredentials attestation-request   762B6B9DA08F7FC63BB693E38634EC6F87CEFF28AB1554A1   1 0  --trace_decode 1


          [1655984597.150863][23339:23344] CHIP:DMG: InvokeResponseMessage =
          [1655984597.150923][23339:23344] CHIP:DMG: {
          [1655984597.150981][23339:23344] CHIP:DMG:         suppressResponse = false,
          [1655984597.151042][23339:23344] CHIP:DMG:         InvokeResponseIBs =
          [1655984597.151117][23339:23344] CHIP:DMG:         [
          [1655984597.151177][23339:23344] CHIP:DMG:                 InvokeResponseIB =
          [1655984597.151255][23339:23344] CHIP:DMG:                 {
          [1655984597.151318][23339:23344] CHIP:DMG:                         CommandStatusIB =
          [1655984597.151404][23339:23344] CHIP:DMG:                         {
          [1655984597.151475][23339:23344] CHIP:DMG:                                 CommandPathIB =
          [1655984597.151561][23339:23344] CHIP:DMG:                                 {
          [1655984597.151644][23339:23344] CHIP:DMG:                                         EndpointId = 0x0,
          [1655984597.151729][23339:23344] CHIP:DMG:                                         ClusterId = 0x3e,
          [1655984597.151812][23339:23344] CHIP:DMG:                                         CommandId = 0x0,
          [1655984597.151890][23339:23344] CHIP:DMG:                                 },
          [1655984597.151978][23339:23344] CHIP:DMG:
          [1655984597.152050][23339:23344] CHIP:DMG:                                 StatusIB =
          [1655984597.152127][23339:23344] CHIP:DMG:                                 {
          [1655984597.152216][23339:23344] CHIP:DMG:                                         status = 0x85 (INVALID_COMMAND),
          [1655984597.152297][23339:23344] CHIP:DMG:                                 },
          [1655984597.152377][23339:23344] CHIP:DMG:
          [1655984597.152449][23339:23344] CHIP:DMG:                         },
          [1655984597.152527][23339:23344] CHIP:DMG:
          [1655984597.152593][23339:23344] CHIP:DMG:                 },
          [1655984597.152666][23339:23344] CHIP:DMG:
          [1655984597.152723][23339:23344] CHIP:DMG:         ],
          [1655984597.152794][23339:23344] CHIP:DMG:
          [1655984597.152852][23339:23344] CHIP:DMG:         InteractionModelRevision = 1
          [1655984597.152908][23339:23344] CHIP:DMG: },
          [1655984597.153037][23339:23344] CHIP:DMG: Received Command Response Status for Endpoint=0 Cluster=0x0000_003E Command=0x0000_0000 Status=0x85
          [1655984597.153112][23339:23344] CHIP:TOO: Error: IM Error 0x00000585: General error: 0x85 (INVALID_COMMAND)
          [1655984597.153256][23339:23344] CHIP:DMG: ICR moving to [AwaitingDe]
      disabled: true
