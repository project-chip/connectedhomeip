# Copyright (c) 2024 Project CHIP Authors
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

name:
    4.1.13. [TC-DRLK-2.13] Verification for ALIRO feature [DUT-Server]

PICS:
    - DRLK.S.F0d

config:
    nodeId: 0x12344321
    cluster: "Door Lock"
    endpoint: 1
    PINCredentialData:
        type: octet_string
        defaultValue: "123456"
    RFIDCredentialData:
        type: octet_string
        defaultValue: "123456789A"
    FingerVeinCredentialData:
        type: octet_string
        defaultValue: "123456789A"
    signingkey:
        type:
        defaultValue: "89d085fc302ca53e279bfcdecdf3c4adb2f5d9bc9ea6c49e9566d144367df3ff"
    verificationkey:
        type:
        defaultValue: "047a4c992d753924cdf3779a3c84fec2debaa6f0b3084450878acc7ddcce7856ae57b1ebbe2561015103dd7474c2a183675378ec55f1e465ac3436bf3dd5ca54d4"
    groupidentifier:
        type:
        defaultValue: "89d085fc302ca53e279bfcdecdf3c4ad"
    groupresolvingkey:
        type:
        defaultValue: "89d0859bfcdecdf3c4adfc302ca53e27"
    aliroverifykey1:
        type:
        defaultValue: "047a4c442d753924cdf3779a3c84fec2debaa6f0b3084450878acc7ddcce7856ae57b1ebbe2561015103dd7474c2a183675378ec55f1e465ac3436bf3dd5ca54d4"
    alirocredentialissuerkey:
        type:
        defaultValue: "047a4c882d753924cdf3779a3c84fec2debaa6f0b3084450878acc7ddcce7856ae57b1ebbe2561015103dd7474c2a183675378ec55f1e465ac3436bf3dd5ca54d4"
    aliroevictableendpointkey:
        type:
        defaultValue: "047a4c772d753924cdf3779a3c84fec2debaa6f0b3084450878acc7ddcce7856ae57b1ebbe2561015103dd7474c2a183675378ec55f1e465ac3436bf3dd5ca54d4"
    alirononevictableendpointkey:
        type:
        defaultValue: "047a4c662d753924cdf3779a3c84fec2debaa6f0b3084450878acc7ddcce7856ae57b1ebbe2561015103dd7474c2a183675378ec55f1e465ac3436bf3dd5ca54d4"
    alirononevictableendpointkey1:
        type:
        defaultValue: "047a4c552d753924cdf3779a3c84fec2debaa6f0b3084450878acc7ddcce7856ae57b1ebbe2561015103dd7474c2a183675378ec55f1e465ac3436bf3dd5ca54d4"
    alirouser:
        type:
        defaultValue: "AliroUser"


tests:
    - label: "Wait for the commissioned device to be retrieved"
      cluster: "DelayCommands"
      command: "WaitForCommissionee"
      arguments:
          values:
              - name: "nodeId"
                value: nodeId
    
    - label: "Pre-condition : Read the commissioner node ID. Save THâ€™s node ID as node-id"
      cluster: "CommissionerCommands"
      command: "GetCommissionerNodeId"
      response:
          values:
              - name: "nodeId"
                saveAs: node-id

    - label:
          "Step 1a: TH reads DUT Endpoint 0 OperationalCredentials cluster CurrentFabricIndex attribute"
      command: "readAttribute"
      endpoint: 0
      cluster: "Operational Credentials"
      attribute: "CurrentFabricIndex"
      response:
          saveAs: fabric-idx
    
    - label: "Step 1b: TH sends ClearUser Command to DUT with the UserIndex as 0xFFFE to clear all the users"
      command: "ClearUser"
      timedInteractionTimeoutMs: 1000
      arguments:
          values:
              - name: "UserIndex"
                value: 0xFFFE
    
    - label: "Step 1c: TH sends ClearCredential Command to DUT to clear all the credentials. Credential as null, 0xFFFE (CredentialType,CredentialIndex)"
      command: "ClearCredential"
      timedInteractionTimeoutMs: 1000
      arguments:
          values:
              - name: "CredentialType"
                value: null
              - name: "CredentialIndex"
                value: 0xFFFE

    - label: "Step 2a: TH sends ClearAliroReaderConfig Command to DUT to clear any existing Aliro Configuration"
      command: "ClearAliroReaderConfig"

    - label: "Step 2b: TH sends SetAliroReaderConfig Command to DUT with the following fields, SigningKey as signingkey, VerificationKey as verificationkey, GroupIdentifier as groupidentifier, GroupResolvingKey not present."
      PICS: DRLK.S.F0d && !DRLK.S.F0e && DRLK.S.C28.Rsp
      command: "SetAliroReaderConfig"
      arguments:
          values:
              - name: "SigningKey"
                value: signingkey
              - name: "VerificationKey"
                value: verificationkey
              - name: "GroupIdentifier "
                value: groupidentifier
              - name: "GroupResolvingKey"
                value: ""
    
    - label: "Step 2c: TH sends SetAliroReaderConfig Command to DUT with the following fields, SigningKey as signingkey, VerificationKey as verificationkey, GroupIdentifier as groupidentifier, GroupResolvingKey as groupresolvingkey."
      PICS: DRLK.S.F0e && DRLK.S.C28.Rsp
      command: "SetAliroReaderConfig"
      arguments:
          values:
              - name: "SigningKey"
                value: signingkey
              - name: "VerificationKey"
                value: verificationkey
              - name: "GroupIdentifier "
                value: groupidentifier
              - name: "GroupResolvingKey"
                value: groupresolvingkey

    - label: "Step 3: TH reads AliroReaderVerificationKey attribute from DUT"
      PICS: DRLK.S.F0d && DRLK.S.A0080
      command: "readAttribute"
      attribute: "AliroReaderVerificationKey"
      response:
          value: verificationkey
    
    - label: "Step 4: TH reads AliroReaderGroupIdentifier attribute from DUT"
      PICS: DRLK.S.F0d && DRLK.S.A0081
      command: "readAttribute"
      attribute: "AliroReaderGroupIdentifier"
      response:
          value: groupidentifier
    
    - label: "Step 5: TH reads AliroGroupResolvingKey attribute from DUT"
      PICS: DRLK.S.F0d && DRLK.S.F0e && DRLK.S.A0084
      command: "readAttribute"
      attribute: "AliroGroupResolvingKey"
      response:
          value: groupresolvingkey
    
    - label: "Step 6a: TH sends SetAliroReaderConfig Command to DUT with the following fields (with the same keys), SigningKey as signingkey, VerificationKey as verificationkey, GroupIdentifier as groupidentifier, GroupResolvingKey not present."
      PICS: DRLK.S.F0d && !DRLK.S.F0e && DRLK.S.C28.Rsp
      command: "SetAliroReaderConfig"
      arguments:
          values:
              - name: "SigningKey"
                value: signingkey
              - name: "VerificationKey"
                value: verificationkey
              - name: "GroupIdentifier "
                value: groupidentifier
              - name: "GroupResolvingKey"
                value: ""
      response:
          value: INVALID_IN_STATE
    
    - label: "Step 6b: TH sends SetAliroReaderConfig Command to DUT with the following fields (with the same keys), SigningKey as signingkey, VerificationKey as verificationkey, GroupIdentifier as groupidentifier, GroupResolvingKey as groupresolvingkey."
      PICS: DRLK.S.F0e && DRLK.S.C28.Rsp
      command: "SetAliroReaderConfig"
      arguments:
          values:
              - name: "SigningKey"
                value: signingkey
              - name: "VerificationKey"
                value: verificationkey
              - name: "GroupIdentifier "
                value: groupidentifier
              - name: "GroupResolvingKey"
                value: groupresolvingkey
      response:
          value: INVALID_IN_STATE
    
    - label: "Step 7: TH sends ClearAliroReaderConfig Command to DUT"
      PICS: DRLK.S.C29.Rsp
      command: "ClearAliroReaderConfig"
    
    - label: "Step 8: TH reads AliroReaderVerificationKey attribute from DUT"
      PICS: DRLK.S.F0d && DRLK.S.A0080
      command: "readAttribute"
      attribute: "AliroReaderVerificationKey"
      response:
          value: null
    
    - label: "Step 9: TH reads AliroReaderGroupIdentifier attribute from DUT"
      PICS: DRLK.S.F0d && DRLK.S.A0081
      command: "readAttribute"
      attribute: "AliroReaderGroupIdentifier"
      response:
          value: null
    
    - label: "Step 10: TH reads AliroGroupResolvingKey attribute from DUT"
      PICS: DRLK.S.F0d && DRLK.S.F0e && DRLK.S.A0084
      command: "readAttribute"
      attribute: "AliroGroupResolvingKey"
      response:
          value: null
    
    - label: "Step 11a: TH sends SetAliroReaderConfig Command to DUT with the following fields, SigningKey as signingkey, VerificationKey as verificationkey, GroupIdentifier as groupidentifier, GroupResolvingKey not present."
      PICS: DRLK.S.F0d && !DRLK.S.F0e && DRLK.S.C28.Rsp
      command: "SetAliroReaderConfig"
      arguments:
          values:
              - name: "SigningKey"
                value: signingkey
              - name: "VerificationKey"
                value: verificationkey
              - name: "GroupIdentifier "
                value: groupidentifier
              - name: "GroupResolvingKey"
                value: ""
    
    - label: "Step 11b: TH sends SetAliroReaderConfig Command to DUT with the following fields, SigningKey as signingkey, VerificationKey as verificationkey, GroupIdentifier as groupidentifier, GroupResolvingKey as groupresolvingkey."
      PICS: DRLK.S.F0e && DRLK.S.C28.Rsp
      command: "SetAliroReaderConfig"
      arguments:
          values:
              - name: "SigningKey"
                value: signingkey
              - name: "VerificationKey"
                value: verificationkey
              - name: "GroupIdentifier "
                value: groupidentifier
              - name: "GroupResolvingKey"
                value: groupresolvingkey
    
    - label: "Step 12: TH sends SetUser Command to DUT to create an Aliro user with the following values: OperationType as 0( DataOperationTypeEnum.Add), UserIndex as 1, UserName as alirouser, UserUniqueID as 111, UserStatus as 1(UserStatusEnum.OccupiedEnabled), UserType as 0(UserTypeEnum.UnrestrictedUser), CredentialRule as 0(CredentialRuleEnum.Single)"
      PICS: DRLK.S.F08 && DRLK.S.C1a.Rsp
      command: "SetUser"
      timedInteractionTimeoutMs: 1000
      arguments:
          values:
              - name: "OperationType"
                value: 0
              - name: "UserIndex"
                value: 1
              - name: "UserName"
                value: alirouser
              - name: "UserUniqueID"
                value: 111
              - name: "UserStatus"
                value: 1
              - name: "UserType"
                value: 0
              - name: "CredentialRule"
                value: 0
    
    - label: "Step 13: TH sends SetCredential Command to DUT with CredentialType as AliroCredentialIssuerKey and CredentialData as alirocredentialissuerkey for the alirouser, OperationType as 0(DataOperationTypeEnum.Add), Credential as 6 1(CredentialType.AliroCredentialIssuerKey,CredentialIndex), CredentialData as alirocredentialissuerkey, UserIndex as 1, UserStatus as null, UserType as null"
      PICS: DRLK.S.F0d && DRLK.S.C22.Rsp && DRLK.S.C23.Tx
      command: "SetCredential"
      timedInteractionTimeoutMs: 1000
      arguments:
          values:
              - name: "OperationType"
                value: 0
              - name: "Credential"
                value: { CredentialType: 6, CredentialIndex: 1 }
              - name: "CredentialData"
                value: alirocredentialissuerkey
              - name: "UserIndex"
                value: 1
              - name: "UserStatus"
                value: null
              - name: "UserType"
                value: null
      response:
          values:
              - name: "Status"
                value: 0
    
    #NEED TO CHECK WITH VALUES
    - label: "Step 14: TH reads the LockUserChange event list from DUT"
      PICS: DRLK.S.F0d || DRLK.S.E04
      command: "readEvent"
      event: "LockUserChange"
      response:
          value:
              {
                  LockDataType: LockDataTypeEnum.AliroCredentialIssuerKey,
                  DataOperationType: DataOperationTypeEnum.Add,
                  OperationSource: OperationSourceEnum.Remote,
                  UserIndex: 1,
                  FabricIndex: fabric-idx,
                  SourceNode: node-id,
                  DataIndex: 2,
              }
    
    - label: "Step 15: TH sends GetCredentialStatus Command with Credential as 6 1 (CredentialTypeEnum.AliroCredentialIssuerKey,CredentialIndex)"
      PICS: DRLK.S.F0d && DRLK.S.C24.Rsp && DRLK.S.C25.Tx
      command: "GetCredentialStatus"
      arguments:
          values:
              - name: "Credential"
                value: { CredentialType: 6, CredentialIndex: 1 }
      response:
          values:
              - name: "CredentialExists"
                value: true
                constraints:
                    type: boolean
              - name: "UserIndex"
                value: 1

    - label:
          "Step 16: TH sends ClearCredential Command to DUT to clear the CredentialType of AliroCredentialIssuerKey Credential as 6 1 (CredentialTypeEnum.AliroCredentialIssuerKey,CredentialIndex)"
      PICS: DRLK.S.F0d && DRLK.S.C26.Rsp
      command: "ClearCredential"
      timedInteractionTimeoutMs: 1000
      arguments:
          values:
              - name: "Credential"
                value: { CredentialType: 6, CredentialIndex: 1 }
    
    #NEED TO CHECK WITH VALUES
    - label: "Step 17: TH reads the LockUserChange event list from DUT"
      PICS: DRLK.S.F0d && DRLK.S.E04
      command: "readEvent"
      event: "LockUserChange"
      response:
          value:
              {
                  LockDataType: LockDataTypeEnum.AliroCredentialIssuerKey,
                  DataOperationType: DataOperationTypeEnum.Clear,
                  OperationSource: OperationSourceEnum.Remote,
                  UserIndex: 1,
                  FabricIndex: fabric-idx,
                  SourceNode: node-id,
                  DataIndex: 1,
              }
    
    - label: "Step 18: TH sends SetCredential Command to DUT with CredentialType as AliroEvictableEndpointKey and CredentialData as aliroevictableendpointkey for the alirouser, OperationType as 0(DataOperationTypeEnum.Add), Credential as 7 1(CredentialType.AliroEvictableEndpointKey,CredentialIndex), CredentialData as aliroevictableendpointkey, UserIndex as 1, UserStatus as null, UserType as null"
      PICS: DRLK.S.F0d && DRLK.S.C22.Rsp && DRLK.S.C23.Tx
      command: "SetCredential"
      timedInteractionTimeoutMs: 1000
      arguments:
          values:
              - name: "OperationType"
                value: 0
              - name: "Credential"
                value: { CredentialType: 7, CredentialIndex: 1 }
              - name: "CredentialData"
                value: aliroevictableendpointkey
              - name: "UserIndex"
                value: 1
              - name: "UserStatus"
                value: null
              - name: "UserType"
                value: null
      response:
          values:
              - name: "Status"
                value: 0
    
    #NEED TO CHECK WITH VALUES
    - label: "Step 19: TH reads the LockUserChange event list from DUT"
      PICS: DRLK.S.F0d && DRLK.S.E04
      command: "readEvent"
      event: "LockUserChange"
      response:
          value:
              {
                  LockDataType: LockDataTypeEnum.AliroEvictableEndpointKey,
                  DataOperationType: DataOperationTypeEnum.Add,
                  OperationSource: OperationSourceEnum.Remote,
                  UserIndex: 1,
                  FabricIndex: fabric-idx,
                  SourceNode: node-id,
                  DataIndex: 2,
              }
    
    - label: "Step 20: TH sends GetCredentialStatus Command with Credential as 7 1 (CredentialTypeEnum.AliroEvictableEndpointKey,CredentialIndex)"
      PICS: DRLK.S.F0d && DRLK.S.C24.Rsp && DRLK.S.C25.Tx
      command: "GetCredentialStatus"
      arguments:
          values:
              - name: "Credential"
                value: { CredentialType: 7, CredentialIndex: 1 }
      response:
          values:
              - name: "CredentialExists"
                value: true
                constraints:
                    type: boolean
              - name: "UserIndex"
                value: 1
    
    - label:
          "Step 21: TH sends ClearCredential Command to DUT to clear the CredentialType of AliroEvictableEndpointKey Credential as 7 1 (CredentialTypeEnum.AliroEvictableEndpointKey,CredentialIndex)"
      PICS: DRLK.S.F0d && DRLK.S.C26.Rsp
      command: "ClearCredential"
      timedInteractionTimeoutMs: 1000
      arguments:
          values:
              - name: "Credential"
                value: { CredentialType: 7, CredentialIndex: 1 }
    
    #NEED TO CHECK WITH VALUES
    - label: "Step 22: TH reads the LockUserChange event list from DUT"
      PICS: DRLK.S.F0d && DRLK.S.E04
      command: "readEvent"
      event: "LockUserChange"
      response:
          value:
              {
                  LockDataType: LockDataTypeEnum.AliroEvictableEndpointKey,
                  DataOperationType: DataOperationTypeEnum.Clear,
                  OperationSource: OperationSourceEnum.Remote,
                  UserIndex: 1,
                  FabricIndex: fabric-idx,
                  SourceNode: node-id,
                  DataIndex: 1,
              }
    
    - label: "Step 23: TH sends SetCredential Command to DUT with CredentialType as alirononevictableendpointkey for the alirouser and CredentialData as aliroevictableendpointkey for the alirouser, OperationType as 0(DataOperationTypeEnum.Add), Credential as 8 1(CredentialType.AliroEvictableEndpointKey,CredentialIndex), CredentialData as alirononevictableendpointkey, UserIndex as 1, UserStatus as null, UserType as null"
      PICS: DRLK.S.F0d && DRLK.S.C22.Rsp && DRLK.S.C23.Tx
      command: "SetCredential"
      timedInteractionTimeoutMs: 1000
      arguments:
          values:
              - name: "OperationType"
                value: 0
              - name: "Credential"
                value: { CredentialType: 8, CredentialIndex: 1 }
              - name: "CredentialData"
                value: alirononevictableendpointkey
              - name: "UserIndex"
                value: 1
              - name: "UserStatus"
                value: null
              - name: "UserType"
                value: null
      response:
          values:
              - name: "Status"
                value: 0
    
    #NEED TO CHECK WITH VALUES
    - label: "Step 24: TH reads the LockUserChange event list from DUT"
      PICS: DRLK.S.F0d && DRLK.S.E04
      command: "readEvent"
      event: "LockUserChange"
      response:
          value:
              {
                  LockDataType: LockDataTypeEnum.AliroNonEvictableEndpointKey,
                  DataOperationType: DataOperationTypeEnum.Add,
                  OperationSource: OperationSourceEnum.Remote,
                  UserIndex: 1,
                  FabricIndex: fabric-idx,
                  SourceNode: node-id,
                  DataIndex: 2,
              }
    
    - label: "Step 25: TH sends GetCredentialStatus Command with Credential as 8 1 (CredentialTypeEnum.AliroNonEvictableEndpointKey,CredentialIndex)"
      PICS: DRLK.S.F0d && DRLK.S.C24.Rsp && DRLK.S.C25.Tx
      command: "GetCredentialStatus"
      arguments:
          values:
              - name: "Credential"
                value: { CredentialType: 8, CredentialIndex: 1 }
      response:
          values:
              - name: "CredentialExists"
                value: true
                constraints:
                    type: boolean
              - name: "UserIndex"
                value: 1
    
    - label:
          "Step 26: TH sends ClearCredential Command to DUT to clear the CredentialType of AliroEvictableEndpointKey Credential as 8 1 (CredentialTypeEnum.AliroNonEvictableEndpointKey,CredentialIndex)"
      PICS: DRLK.S.F0d && DRLK.S.C26.Rsp
      command: "ClearCredential"
      timedInteractionTimeoutMs: 1000
      arguments:
          values:
              - name: "Credential"
                value: { CredentialType: 8, CredentialIndex: 1 }
    
    #NEED TO CHECK WITH VALUES
    - label: "Step 27: TH reads the LockUserChange event list from DUT"
      PICS: DRLK.S.F0d && DRLK.S.E04
      command: "readEvent"
      event: "LockUserChange"
      response:
          value:
              {
                  LockDataType: LockDataTypeEnum.AliroNonEvictableEndpointKey,
                  DataOperationType: DataOperationTypeEnum.Clear,
                  OperationSource: OperationSourceEnum.Remote,
                  UserIndex: 1,
                  FabricIndex: fabric-idx,
                  SourceNode: node-id,
                  DataIndex: 1,
              }
    
    - label: "Step 28a: TH reads NumberOfAliroEndpointKeysSupported attribute and saves the value as max_aliro_keys_supported"
      PICS: DRLK.S.A0088
      command: "readAttribute"
      attribute: "NumberOfAliroEndpointKeysSupported"
      response:
          saveAs: max_aliro_keys_supported
    
    - label:
          "Step 28b: TH reads NumberOfCredentialsSupportedPerUser attribute and saves the value as numberofcredentialsupportedperuser"
      PICS: DRLK.S.A001c
      command: "readAttribute"
      attribute: "NumberOfCredentialsSupportedPerUser"
      response:
          saveAs: numberofcredentialsupportedperuser

    #############
    #STEP 28c IF LOOP
    #############
    
    #############
    #STEP 29, 30, 31, 32, 33: startcredentialindex
    #############


    - label: "Step 34a: TH sends ClearCredential Command to DUT to clear the ALIRO CredentialType Credential as 6 1(CredentialTypeEnum.AliroCredentialIssuerKey,CredentialIndex)"
      command: "ClearCredential"
      timedInteractionTimeoutMs: 1000
      arguments:
          values:
              - name: "Credential"
                value: { CredentialType: 6, CredentialIndex: 1 }
    
    - label: "Step 34b: TH sends ClearCredential Command to DUT to clear the ALIRO CredentialType Credential as 7 1(CredentialTypeEnum.AliroEvictableEndpointKey)"
      command: "ClearCredential"
      timedInteractionTimeoutMs: 1000
      arguments:
          values:
              - name: "Credential"
                value: { CredentialType: 7, CredentialIndex: 1 }
    
    - label: "Step 34c: TH sends ClearCredential Command to DUT to clear the ALIRO CredentialType Credential as 8 1(CredentialTypeEnum.AliroNonEvictableEndpointKey)"
      command: "ClearCredential"
      timedInteractionTimeoutMs: 1000
      arguments:
          values:
              - name: "Credential"
                value: { CredentialType: 8, CredentialIndex: 1 }
    
    - label: "Step 35: TH sends ClearUser Command to DUT with the UserIndex as 1"
      command: "ClearUser"
      timedInteractionTimeoutMs: 1000
      arguments:
          values:
              - name: "UserIndex"
                value: 1
    
    # - label: "Step 30: TH sends SetCredential Command to DUT with CredentialType as AliroEvictableEndpointKey for the alirouser, OperationType as 0(DataOperationTypeEnum.Add), Credential as 7 startcredentialindex+1 (CredentialTypeEnum.AliroEvictableEndpointKey,CredentialIndex), CredentialData as aliroevictableendpointkey, UserIndex as 1, UserStatus as null, UserType as null"
    #   PICS: DRLK.S.F0d && DRLK.S.C22.Rsp && DRLK.S.C23.Tx
    #   command: "SetCredential"
    #   timedInteractionTimeoutMs: 1000
    #   arguments:
    #       values:
    #           - name: "OperationType"
    #             value: 0
    #           - name: "Credential"
    #             value: { CredentialType: 8, CredentialIndex: 2 }
    #           - name: "CredentialData"
    #             value: aliroevictableendpointkey
    #           - name: "UserIndex"
    #             value: 1
    #           - name: "UserStatus"
    #             value: null
    #           - name: "UserType"
    #             value: null
    #   response:
    #       values:
    #           - name: "Status"
    #             value: 0
    
    # - label: "Step 31: TH sends SetCredential Command to DUT with CredentialType as AliroNonEvictableEndpointKey and number of credentials for alirouser exceeds the max_aliro_keys_supported CredentialData as aliroevictableendpointkey for the alirouser, OperationType as 0(DataOperationTypeEnum.Add), Credential as 8 startcredentialindex+1 (CredentialTypeEnum.AliroNonEvictableEndpointKey,CredentialIndex), CredentialData as alirononevictableendpointkey1, UserIndex as 1, UserStatus as null, UserType as null"
    #   PICS: DRLK.S.F0d && DRLK.S.C22.Rsp && DRLK.S.C23.Tx
    #   command: "SetCredential"
    #   timedInteractionTimeoutMs: 1000
    #   arguments:
    #       values:
    #           - name: "OperationType"
    #             value: 0
    #           - name: "Credential"
    #             value: { CredentialType: 8, CredentialIndex: 1 }
    #           - name: "CredentialData"
    #             value: alirononevictableendpointkey1
    #           - name: "UserIndex"
    #             value: 1
    #           - name: "UserStatus"
    #             value: null
    #           - name: "UserType"
    #             value: null
    #   response:
    #       values:
    #           - name: "Status"
    #             value: 0