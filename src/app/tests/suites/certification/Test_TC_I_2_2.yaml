# Copyright (c) 2021 Project CHIP Authors
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# Auto-generated scripts for harness use only, please review before automation. The endpoints and cluster names are currently set to default

name: 58.2.2. [TC-I-2.2] Primary functionality with server as DUT

config:
    nodeId: 0x12344321
    cluster: "Basic"
    endpoint: 0

tests:
    - label: "Commission DUT to TH"
      verification: |

      disabled: true

    - label:
          "TH sends Identify command to DUT, with the identify time field set to
          0x003c (60s)."
      verification: |
          ./chip-tool identify identify 60 1 1

          StatusIB =
          [1649333282.734258][3517:3522] CHIP:DMG:                                 {
          [1649333282.734305][3517:3522] CHIP:DMG:                                         status = 0x00 (SUCCESS),
          [1649333282.734351][3517:3522] CHIP:DMG:                                 },

          [1649333282.734804][3517:3522] CHIP:DMG: Received Command Response Status for Endpoint=1 Cluster=0x0000_0003 Command=0x0000_0000 Status=0x0
          [1649333282.734865][3517:3522] CHIP:DMG: ICR moving to [AwaitingDe]
          [1649333282.734941][3517:3522] CHIP:EM: Sending Standalone Ack for MessageCounter:15738020 on exchange 54
      disabled: true

    - label: "TH reads immediately IdentifyTime attribute from DUT"
      verification: |
          ./chip-tool identify read identify-time 1 1
          Send this commnad imediately

          [1649333433.610115][3555:3560] CHIP:TOO: Endpoint: 1 Cluster: 0x0000_0003 Attribute 0x0000_0000 DataVersion: 3084568564
          [1649333433.610227][3555:3560] CHIP:TOO:   identify time: 58
          [1649333433.610330][3555:3560] CHIP:EM: Sending Standalone Ack for MessageCounter:1576038 on exchange 10267i
      disabled: true

    - label: "After 10 seconds, the TH reads IdentifyTime attribute from DUT"
      verification: |
          ./chip-tool identify read identify-time 1 1


          [1649333475.255843][3569:3574] CHIP:TOO: Endpoint: 1 Cluster: 0x0000_0003 Attribute 0x0000_0000 DataVersion: 3084568606
          [1649333475.255942][3569:3574] CHIP:TOO:   identify time: 51
          [1649333475.256064][3569:3574] CHIP:EM: Sending Standalone Ack for MessageCounter:2216240 on exchange 19670i
      disabled: true

    - label:
          "TH sends IdentifyQuery command to DUT Note: IdentifyQuery is not
          supported by Matter"
      verification: |
          IdentifyQuery is not supported by Matter
      disabled: true

    - label:
          "TH sends Identify command to DUT, with the identify time field set to
          0x0000 (stop identifying)."
      verification: |
          ./chip-tool identify identify 0 1 1

          [1649333614.063864][3584:3589] CHIP:DMG:                                 StatusIB =
          [1649333614.063900][3584:3589] CHIP:DMG:                                 {
          [1649333614.063942][3584:3589] CHIP:DMG:                                         status = 0x00 (SUCCESS),
          [1649333614.063988][3584:3589] CHIP:DMG:                                 },

          [1649333614.064413][3584:3589] CHIP:DMG: Received Command Response Status for Endpoint=1 Cluster=0x0000_0003 Command=0x0000_0000 Status=0x0
          [1649333614.064467][3584:3589] CHIP:DMG: ICR moving to [AwaitingDe]
          [1649333614.064538][3584:3589] CHIP:EM: Sending Standalone Ack for MessageCounter:12122461 on exchange 46231i
      disabled: true

    - label: "TH reads immediately IdentifyTime attribute from DUT"
      verification: |
          ./chip-tool identify read identify-time 1 1
          Send this commnad imediately

          [1649333664.183225][3592:3597] CHIP:TOO: Endpoint: 1 Cluster: 0x0000_0003 Attribute 0x0000_0000 DataVersion: 3084568658
          [1649333664.183335][3592:3597] CHIP:TOO:   identify time: 0
          [1649333664.183436][3592:3597] CHIP:EM: Sending Standalone Ack for MessageCounter:2240340 on exchange 57317i
      disabled: true

    - label:
          "TH sends IdentifyQuery command to DUT Note: IdentifyQuery is not
          supported by Matter"
      verification: |
          IdentifyQuery is not supported by Matter
      disabled: true

    - label:
          "TH writes a value of 0x000f (15s) to IdentifyTime attribute of DUT"
      verification: |
          ./chip-tool identify write identify-time 15 1 1

          [1649333697.541195][3600:3605] CHIP:DMG:                                 StatusIB =
          [1649333697.541279][3600:3605] CHIP:DMG:                                 {
          [1649333697.541362][3600:3605] CHIP:DMG:                                         status = 0x00 (SUCCESS),
          [1649333697.541449][3600:3605] CHIP:DMG:                                 },

          [1649333697.542102][3600:3605] CHIP:DMG: Received Command Response Status for Endpoint=0 Cluster=0x0000_0003 Command=0x0000_0001 Status=0x0
          [1649333697.542199][3600:3605] CHIP:DMG: ICR moving to [AwaitingDe]
          [1649333697.542272][3600:3605] CHIP:EM: Sending Standalone Ack for MessageCounter:3645728 on exchange 17695i
      disabled: true

    - label: "After 5 seconds, the TH reads IdentifyTime attribute from DUT"
      verification: |
          ./chip-tool identify read identify-time 1 1
          Send this command after 5 seconds

          [1649333664.183225][3592:3597] CHIP:TOO: Endpoint: 1 Cluster: 0x0000_0003 Attribute 0x0000_0000 DataVersion: 3084568658
          [1649333664.183335][3592:3597] CHIP:TOO:   identify time: 9
          [1649333664.183436][3592:3597] CHIP:EM: Sending Standalone Ack for MessageCounter:2240340 on exchange 57317i
      disabled: true
