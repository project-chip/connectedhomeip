# Copyright (c) 2021 Project CHIP Authors
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# Auto-generated scripts for harness use only, please review before automation. The endpoints and cluster names are currently set to default

name:
    125.2.2. [TC-G-2.2] Commands - AddGroup, ViewGroup, RemoveGroup,
    RemoveAllGroups [DUT-Server]

PICS:
    - G.S

config:
    nodeId: 0x12344321
    cluster: "Basic Information"
    endpoint: 0

tests:
    - label: "Precondition"
      verification: |
          TH is commissioned with DUT
      disabled: true

    - label:
          "Precondition: TH reads the MaxGroupsPerFabric from Group key
          Management Cluster and saves it as maxgroups"
      verification: |
          ./chip-tool groupkeymanagement read max-groups-per-fabric 1 0

          Verify the "MaxGroupsPerFabric value" on the TH(Chip-tool)  Log  and below is the sample log provided for the raspi platform:

          [1674543469.443764][19260:19262] CHIP:DMG: }
          [1674543469.443889][19260:19262] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003F Attribute 0x0000_0002 DataVersion: 3217277214
          [1674543469.444257][19260:19262] CHIP:TOO:   MaxGroupsPerFabric: 4
      disabled: true

    - label: |
          Precondition: If maxgroups>1, proceed with the following steps,

          TH generates fabric-unique GroupID, GroupName, random key, EpochKey0
          and GroupKeySetID.

          TH generates an EpochKey and saves as epoch_key_set1_epoch0

          TH sends a KeySetWriteCommand to the Group Key Management cluster with
          the following fields set in the GroupKeySet struct:

          GroupKeySetId is 1

          EpochKey0 is epoch_key_set0_epoch0

          GroupKeySecurityPolicy = TrustFirst (1)

          GroupKeyMulticastPolicy = PerGroupID (0)

          EpochStartTime0 = 0

          TH binds GroupId(0x0001 to (maxgroups+1)) with GroupKeySetID in the
          GroupKeyMap attribute list on GroupKeyManagement cluster with the
          values provided in the above steps
      verification: |
          Execute the following command in TH to generate the pre-condition to execute this test case:

          ./chip-tool groupkeymanagement key-set-write '{"groupKeySetID": 1,
          "groupKeySecurityPolicy": 1, "epochKey0":
          "d0d1d2d3d4d5d6d7d8d9dadbdcdddedf", "epochStartTime0": 2220000,"epochKey1":
          "d1d1d2d3d4d5d6d7d8d9dadbdcdddedf", "epochStartTime1": 2220001,"epochKey2":
          "d2d1d2d3d4d5d6d7d8d9dadbdcdddedf", "epochStartTime2": 2220002 }' 1 0

          Verify the "status is success" on the TH(Chip-tool)  Log  and below is the sample log provided for the raspi platform:


          [1658316948.574526][4039:4044] CHIP:DMG:                                StatusIB =
          [1658316948.574561][4039:4044] CHIP:DMG:                                {
          [1658316948.574597][4039:4044] CHIP:DMG:                                   status = 0x00 (SUCCESS),
          [1658316948.574632][4039:4044] CHIP:DMG:                                },

          Before adding the Groups (0x0001,0x0002) execute this command

          ./chip-tool groupkeymanagement write group-key-map '[{"groupId": 1, "groupKeySetID": 1, "fabricIndex": 1},{"groupId":2, "groupKeySetID": 1, "fabricIndex": 1} ]' 1 0

          Verify the "status is success" on the TH(Chip-tool)  Log  and below is the sample log provided for the raspi platform:


          [1663071507.364542][23693:23698] CHIP:DMG: WriteClient moving to [ResponseRe]
          [1663071507.364603][23693:23698] CHIP:DMG: WriteResponseMessage =
          [1663071507.364635][23693:23698] CHIP:DMG: {
          [1663071507.364661][23693:23698] CHIP:DMG:         AttributeStatusIBs =
          [1663071507.364699][23693:23698] CHIP:DMG:         [
          [1663071507.364728][23693:23698] CHIP:DMG:                 AttributeStatusIB =
          [1663071507.364768][23693:23698] CHIP:DMG:                 {
          [1663071507.364799][23693:23698] CHIP:DMG:                         AttributePathIB =
          [1663071507.364838][23693:23698] CHIP:DMG:                         {
          [1663071507.364876][23693:23698] CHIP:DMG:                                 Endpoint = 0x0,
          [1663071507.364921][23693:23698] CHIP:DMG:                                 Cluster = 0x3f,
          [1663071507.364961][23693:23698] CHIP:DMG:                                 Attribute = 0x0000_0000,
          [1663071507.365002][23693:23698] CHIP:DMG:                         }
          [1663071507.365044][23693:23698] CHIP:DMG:
          [1663071507.365079][23693:23698] CHIP:DMG:                         StatusIB =
          [1663071507.365121][23693:23698] CHIP:DMG:                         {
          [1663071507.365164][23693:23698] CHIP:DMG:                                 status = 0x00 (SUCCESS),
          [1663071507.365201][23693:23698] CHIP:DMG:                         },
          [1663071507.365243][23693:23698] CHIP:DMG:
          [1663071507.365275][23693:23698] CHIP:DMG:                 },
          [1663071507.365320][23693:23698] CHIP:DMG:
          [1663071507.365351][23693:23698] CHIP:DMG:                 AttributeStatusIB =
          [1663071507.365385][23693:23698] CHIP:DMG:                 {
          [1663071507.365417][23693:23698] CHIP:DMG:                         AttributePathIB =
          [1663071507.365453][23693:23698] CHIP:DMG:                         {
          [1663071507.365489][23693:23698] CHIP:DMG:                                 Endpoint = 0x0,
          [1663071507.365532][23693:23698] CHIP:DMG:                                 Cluster = 0x3f,
          [1663071507.365574][23693:23698] CHIP:DMG:                                 Attribute = 0x0000_0000,
          [1663071507.365612][23693:23698] CHIP:DMG:                                 ListIndex = Null,
          [1663071507.365652][23693:23698] CHIP:DMG:                         }
          [1663071507.365696][23693:23698] CHIP:DMG:
          [1663071507.365735][23693:23698] CHIP:DMG:                         StatusIB =
          [1663071507.365773][23693:23698] CHIP:DMG:                         {
          [1663071507.365810][23693:23698] CHIP:DMG:                                 status = 0x00 (SUCCESS),
          [1663071507.365846][23693:23698] CHIP:DMG:                         },
          [1663071507.365883][23693:23698] CHIP:DMG:
          [1663071507.365915][23693:23698] CHIP:DMG:                 },
          [1663071507.365958][23693:23698] CHIP:DMG:
          [1663071507.365987][23693:23698] CHIP:DMG:                 AttributeStatusIB =
          [1663071507.366017][23693:23698] CHIP:DMG:                 {
          [1663071507.366047][23693:23698] CHIP:DMG:                         AttributePathIB =
          [1663071507.366082][23693:23698] CHIP:DMG:                         {
          [1663071507.366121][23693:23698] CHIP:DMG:                                 Endpoint = 0x0,
          [1663071507.366164][23693:23698] CHIP:DMG:                                 Cluster = 0x3f,
          [1663071507.366204][23693:23698] CHIP:DMG:                                 Attribute = 0x0000_0000,
          [1663071507.366243][23693:23698] CHIP:DMG:                                 ListIndex = Null,
          [1663071507.366280][23693:23698] CHIP:DMG:                         }
          [1663071507.366319][23693:23698] CHIP:DMG:
          [1663071507.366355][23693:23698] CHIP:DMG:                         StatusIB =
          [1663071507.366390][23693:23698] CHIP:DMG:                         {
          [1663071507.366428][23693:23698] CHIP:DMG:                                 status = 0x00 (SUCCESS),
          [1663071507.366466][23693:23698] CHIP:DMG:                         },


          Before adding the Groups (0x0003,0x0004) execute this command

          ./chip-tool groupkeymanagement write group-key-map '[{"groupId": 3, "groupKeySetID": 1, "fabricIndex": 1},{"groupId":4, "groupKeySetID": 1, "fabricIndex": 1} ]' 1 0

          Verify the "status is success" on the TH(Chip-tool)  Log  and below is the sample log provided for the raspi platform:

          [1674546137.239871][19959:19961] CHIP:DMG: WriteResponseMessage =
          [1674546137.239875][19959:19961] CHIP:DMG: {
          [1674546137.239877][19959:19961] CHIP:DMG:         AttributeStatusIBs =
          [1674546137.239882][19959:19961] CHIP:DMG:         [
          [1674546137.239885][19959:19961] CHIP:DMG:                 AttributeStatusIB =
          [1674546137.239888][19959:19961] CHIP:DMG:                 {
          [1674546137.239891][19959:19961] CHIP:DMG:                         AttributePathIB =
          [1674546137.239895][19959:19961] CHIP:DMG:                         {
          [1674546137.239898][19959:19961] CHIP:DMG:                                 Endpoint = 0x0,
          [1674546137.239901][19959:19961] CHIP:DMG:                                 Cluster = 0x3f,
          [1674546137.239905][19959:19961] CHIP:DMG:                                 Attribute = 0x0000_0000,
          [1674546137.239908][19959:19961] CHIP:DMG:                         }
          [1674546137.239912][19959:19961] CHIP:DMG:
          [1674546137.239915][19959:19961] CHIP:DMG:                         StatusIB =
          [1674546137.239919][19959:19961] CHIP:DMG:                         {
          [1674546137.239922][19959:19961] CHIP:DMG:                                 status = 0x00 (SUCCESS),
          [1674546137.239925][19959:19961] CHIP:DMG:                         },
          [1674546137.239928][19959:19961] CHIP:DMG:
          [1674546137.239931][19959:19961] CHIP:DMG:                 },
          [1674546137.239938][19959:19961] CHIP:DMG:
          [1674546137.239940][19959:19961] CHIP:DMG:                 AttributeStatusIB =
          [1674546137.239943][19959:19961] CHIP:DMG:                 {
          [1674546137.239946][19959:19961] CHIP:DMG:                         AttributePathIB =
          [1674546137.239948][19959:19961] CHIP:DMG:                         {
          [1674546137.239951][19959:19961] CHIP:DMG:                                 Endpoint = 0x0,
          [1674546137.239955][19959:19961] CHIP:DMG:                                 Cluster = 0x3f,
          [1674546137.239959][19959:19961] CHIP:DMG:                                 Attribute = 0x0000_0000,
          [1674546137.239962][19959:19961] CHIP:DMG:                                 ListIndex = Null,
          [1674546137.239965][19959:19961] CHIP:DMG:                         }
          [1674546137.239970][19959:19961] CHIP:DMG:
          [1674546137.239972][19959:19961] CHIP:DMG:                         StatusIB =
          [1674546137.239975][19959:19961] CHIP:DMG:                         {
          [1674546137.239979][19959:19961] CHIP:DMG:                                 status = 0x00 (SUCCESS),
          [1674546137.239982][19959:19961] CHIP:DMG:                         },
          [1674546137.239985][19959:19961] CHIP:DMG:
          [1674546137.239988][19959:19961] CHIP:DMG:                 },
          [1674546137.239994][19959:19961] CHIP:DMG:
          [1674546137.239997][19959:19961] CHIP:DMG:                 AttributeStatusIB =
          [1674546137.240000][19959:19961] CHIP:DMG:                 {
          [1674546137.240002][19959:19961] CHIP:DMG:                         AttributePathIB =
          [1674546137.240005][19959:19961] CHIP:DMG:                         {
          [1674546137.240009][19959:19961] CHIP:DMG:                                 Endpoint = 0x0,
          [1674546137.240012][19959:19961] CHIP:DMG:                                 Cluster = 0x3f,
          [1674546137.240015][19959:19961] CHIP:DMG:                                 Attribute = 0x0000_0000,
          [1674546137.240018][19959:19961] CHIP:DMG:                                 ListIndex = Null,
          [1674546137.240021][19959:19961] CHIP:DMG:                         }
          [1674546137.240026][19959:19961] CHIP:DMG:
          [1674546137.240028][19959:19961] CHIP:DMG:                         StatusIB =
          [1674546137.240033][19959:19961] CHIP:DMG:                         {
          [1674546137.240036][19959:19961] CHIP:DMG:                                 status = 0x00 (SUCCESS),
          [1674546137.240039][19959:19961] CHIP:DMG:                         },
          [1674546137.240042][19959:19961] CHIP:DMG:
          [1674546137.240044][19959:19961] CHIP:DMG:                 },
          [1674546137.240049][19959:19961] CHIP:DMG:
          [1674546137.240051][19959:19961] CHIP:DMG:         ],
          [1674546137.240059][19959:19961] CHIP:DMG:
          [1674546137.240062][19959:19961] CHIP:DMG:         InteractionModelRevision = 1
          [1674546137.240064][19959:19961] CHIP:DMG: }




          After executing all commands related to the above four groups, execute the below command before adding the Group 0x0007 to check the Resource_Exhausted Condition


          ./chip-tool groupkeymanagement write group-key-map '[{"groupId": 7, "groupKeySetID": 1, "fabricIndex": 1}]' 1 0

          Verify the "status is success" on the TH(Chip-tool)  Log  and below is the sample log provided for the raspi platform:
          [1674546896.141697][20084:20086] CHIP:DMG: WriteResponseMessage =
          [1674546896.141700][20084:20086] CHIP:DMG: {
          [1674546896.141702][20084:20086] CHIP:DMG:         AttributeStatusIBs =
          [1674546896.141707][20084:20086] CHIP:DMG:         [
          [1674546896.141708][20084:20086] CHIP:DMG:                 AttributeStatusIB =
          [1674546896.141711][20084:20086] CHIP:DMG:                 {
          [1674546896.141713][20084:20086] CHIP:DMG:                         AttributePathIB =
          [1674546896.141716][20084:20086] CHIP:DMG:                         {
          [1674546896.141719][20084:20086] CHIP:DMG:                                 Endpoint = 0x0,
          [1674546896.141721][20084:20086] CHIP:DMG:                                 Cluster = 0x3f,
          [1674546896.141724][20084:20086] CHIP:DMG:                                 Attribute = 0x0000_0000,
          [1674546896.141726][20084:20086] CHIP:DMG:                         }
          [1674546896.141730][20084:20086] CHIP:DMG:
          [1674546896.141732][20084:20086] CHIP:DMG:                         StatusIB =
          [1674546896.141734][20084:20086] CHIP:DMG:                         {
          [1674546896.141737][20084:20086] CHIP:DMG:                                 status = 0x00 (SUCCESS),
          [1674546896.141739][20084:20086] CHIP:DMG:                         },
          [1674546896.141742][20084:20086] CHIP:DMG:
          [1674546896.141743][20084:20086] CHIP:DMG:                 },
          [1674546896.141750][20084:20086] CHIP:DMG:
          [1674546896.141752][20084:20086] CHIP:DMG:                 AttributeStatusIB =
          [1674546896.141755][20084:20086] CHIP:DMG:                 {
          [1674546896.141758][20084:20086] CHIP:DMG:                         AttributePathIB =
          [1674546896.141760][20084:20086] CHIP:DMG:                         {
          [1674546896.141763][20084:20086] CHIP:DMG:                                 Endpoint = 0x0,
          [1674546896.141766][20084:20086] CHIP:DMG:                                 Cluster = 0x3f,
          [1674546896.141769][20084:20086] CHIP:DMG:                                 Attribute = 0x0000_0000,
          [1674546896.141773][20084:20086] CHIP:DMG:                                 ListIndex = Null,
          [1674546896.141776][20084:20086] CHIP:DMG:                         }
          [1674546896.141781][20084:20086] CHIP:DMG:
          [1674546896.141783][20084:20086] CHIP:DMG:                         StatusIB =
          [1674546896.141786][20084:20086] CHIP:DMG:                         {
          [1674546896.141789][20084:20086] CHIP:DMG:                                 status = 0x00 (SUCCESS),
          [1674546896.141792][20084:20086] CHIP:DMG:                         },
          [1674546896.141795][20084:20086] CHIP:DMG:
          [1674546896.141798][20084:20086] CHIP:DMG:                 },
          [1674546896.141802][20084:20086] CHIP:DMG:
          [1674546896.141805][20084:20086] CHIP:DMG:         ],
          [1674546896.141811][20084:20086] CHIP:DMG:
          [1674546896.141813][20084:20086] CHIP:DMG:         InteractionModelRevision = 1
          [1674546896.141816][20084:20086] CHIP:DMG: }
      disabled: true

    - label:
          "If maxgroups>0, TH sends AddGroup command to DUT as unicast with the
          following fields : GroupID as 0x0001 GroupName as Gp1"
      PICS: G.S.C00.Rsp && G.S.C00.Tx
      verification: |
          ./chip-tool groups add-group 0x0001 grp1 1 0

          Verify the "status is success" on the TH(Chip-tool)  Log  and  Group ID is in the inclusive range of 0x0001 to 0xffff ,below is the sample log provided for the raspi platform:


          [1651218084.427102][2526:2531] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_0004 Command 0x0000_0000
          [1651218084.427203][2526:2531] CHIP:TOO:   AddGroupResponse: {
          [1651218084.427241][2526:2531] CHIP:TOO:     status: 0
          [1651218084.427264][2526:2531] CHIP:TOO:     groupId: 1
          [1651218084.427314][2526:2531] CHIP:TOO:    }
      disabled: true

    - label:
          "If maxgroups > 0, TH reads GroupTable attribute from the
          GroupKeyManagement cluster from DUT on PIXIT.G.ENDPOINT"
      PICS: GRPKEY.S.A0001
      verification: |
          ./chip-tool groupkeymanagement read group-table 1 0

          Verify the "grouptable entries" on the TH(Chip-tool)  Log  ,GroupId as 0x0001 and below is the sample log provided for the raspi platform:


          1674543470.475997][19273:19275] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003F Attribute 0x0000_0001 DataVersion: 3217277217
          [1674543470.476009][19273:19275] CHIP:TOO:   GroupTable: 1 entries
          [1674543470.476023][19273:19275] CHIP:TOO:     [1]: {
          [1674543470.476026][19273:19275] CHIP:TOO:       GroupId: 1
          [1674543470.476029][19273:19275] CHIP:TOO:       Endpoints: 1 entries
          [1674543470.476033][19273:19275] CHIP:TOO:         [1]: 0
          [1674543470.476037][19273:19275] CHIP:TOO:       GroupName: grp1
          [1674543470.476039][19273:19275] CHIP:TOO:       FabricIndex: 1
          [1674543470.476042][19273:19275] CHIP:TOO:      }
      disabled: true

    - label:
          "If maxgroups>1, TH sends AddGroup command to DUT as unicast with the
          following fields : GroupID as 0x0002 GroupName as Gp2"
      PICS: G.S.C00.Rsp && G.S.C00.Tx
      verification: |
          ./chip-tool groups add-group 0x0002 grp2 1 0

          Verify the "status is success" on the TH(Chip-tool)  Log  and Group ID is in the inclusive range of 0x0001 to 0xffff, below is the sample log provided for the raspi platform:


          [1653484028.897698][11275:11280] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_0004 Command 0x0000_0000
          [1653484028.897804][11275:11280] CHIP:TOO:   AddGroupResponse: {
          [1653484028.897851][11275:11280] CHIP:TOO:     status: 0
          [1653484028.897884][11275:11280] CHIP:TOO:     groupId: 2
          [1653484028.897917][11275:11280] CHIP:TOO:    }
      disabled: true

    - label:
          "If maxgroups > 1 TH reads GroupTable attribute from the
          GroupKeyManagement cluster from DUT on PIXIT.G.ENDPOINT"
      PICS: GRPKEY.S.A0001
      verification: |
          ./chip-tool groupkeymanagement read group-table 1 0

          Verify the "grouptable entries" on the TH(Chip-tool)  Log and GroupId as 0x0002, below is the sample log provided for the raspi platform:


          1674543470.993207][19279:19281] CHIP:DMG: }
          [1674543470.993358][19279:19281] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003F Attribute 0x0000_0001 DataVersion: 3217277217
          [1674543470.993380][19279:19281] CHIP:TOO:   GroupTable: 2 entries
          [1674543470.993397][19279:19281] CHIP:TOO:     [1]: {
          [1674543470.993400][19279:19281] CHIP:TOO:       GroupId: 1
          [1674543470.993404][19279:19281] CHIP:TOO:       Endpoints: 1 entries
          [1674543470.993408][19279:19281] CHIP:TOO:         [1]: 0
          [1674543470.993411][19279:19281] CHIP:TOO:       GroupName: grp1
          [1674543470.993414][19279:19281] CHIP:TOO:       FabricIndex: 1
          [1674543470.993417][19279:19281] CHIP:TOO:      }
          [1674543470.993423][19279:19281] CHIP:TOO:     [2]: {
          [1674543470.993426][19279:19281] CHIP:TOO:       GroupId: 2
          [1674543470.993429][19279:19281] CHIP:TOO:       Endpoints: 1 entries
          [1674543470.993432][19279:19281] CHIP:TOO:         [1]: 0
          [1674543470.993435][19279:19281] CHIP:TOO:       GroupName: grp2
          [1674543470.993437][19279:19281] CHIP:TOO:       FabricIndex: 1
          [1674543470.993439][19279:19281] CHIP:TOO:      }
      disabled: true

    - label:
          "If maxgroups>2, TH sends AddGroup command to DUT (n-2) more times,
          starting with GroupID 0x0003 and incrementing by 1 each time."
      PICS: G.S.C00.Rsp && G.S.C00.Tx
      verification: |
          ./chip-tool groups add-group 0x0003 grp3 1 0

          Verify the "status is success" on the TH(Chip-tool)  and Group ID is in the inclusive range of 0x0001 to 0xffff, below is the sample log provided for the raspi platform:


          [1653484116.857523][11289:11294] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_0004 Command 0x0000_0000
          [1653484116.857675][11289:11294] CHIP:TOO:   AddGroupResponse: {
          [1653484116.857739][11289:11294] CHIP:TOO:     status: 0
          [1653484116.857787][11289:11294] CHIP:TOO:     groupId: 3
          [1653484116.857834][11289:11294] CHIP:TOO:    }

          ./chip-tool groups add-group 0x0004 grp4 1 0

          Verify the "status is success" on the TH(Chip-tool)  and Group ID is in the inclusive range of 0x0001 to 0xffff, below is the sample log provided for the raspi platform:

          [1674546345.099827][19986:19988] CHIP:DMG: },
          [1674546345.099884][19986:19988] CHIP:DMG: Received Command Response Data, Endpoint=1 Cluster=0x0000_0004 Command=0x0000_0000
          [1674546345.099915][19986:19988] CHIP:TOO: Endpoint: 1 Cluster: 0x0000_0004 Command 0x0000_0000
          [1674546345.099956][19986:19988] CHIP:TOO:   AddGroupResponse: {
          [1674546345.099972][19986:19988] CHIP:TOO:     status: 0
          [1674546345.099983][19986:19988] CHIP:TOO:     groupID: 4
          [1674546345.099991][19986:19988] CHIP:TOO:    }
      disabled: true

    - label:
          "If maxgroups>2, TH reads GroupTable attribute from the
          GroupKeyManagement cluster from DUT on PIXIT.G.ENDPOINT"
      PICS: GRPKEY.S.A0001
      verification: |
          ./chip-tool groupkeymanagement read group-table 1 0

          Verify the "grouptable entries" on the TH(Chip-tool)  Log and below is the sample log provided for the raspi platform:

          [1674543471.793316][19288:19290] CHIP:DMG: }
          [1674543471.793466][19288:19290] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003F Attribute 0x0000_0001 DataVersion: 3217277219
          [1674546505.532342][20008:20010] CHIP:DMG: }
          [1674546505.533120][20008:20010] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003F Attribute 0x0000_0001 DataVersion: 1241587620
          [1674546505.533150][20008:20010] CHIP:TOO:   GroupTable: 4 entries
          [1674546505.533171][20008:20010] CHIP:TOO:     [1]: {
          [1674546505.533179][20008:20010] CHIP:TOO:       GroupId: 1
          [1674546505.533184][20008:20010] CHIP:TOO:       Endpoints: 1 entries
          [1674546505.533190][20008:20010] CHIP:TOO:         [1]: 0
          [1674546505.533198][20008:20010] CHIP:TOO:       GroupName: grp1
          [1674546505.533202][20008:20010] CHIP:TOO:       FabricIndex: 1
          [1674546505.533207][20008:20010] CHIP:TOO:      }
          [1674546505.533212][20008:20010] CHIP:TOO:     [2]: {
          [1674546505.533215][20008:20010] CHIP:TOO:       GroupId: 2
          [1674546505.533217][20008:20010] CHIP:TOO:       Endpoints: 1 entries
          [1674546505.533220][20008:20010] CHIP:TOO:         [1]: 0
          [1674546505.533224][20008:20010] CHIP:TOO:       GroupName: grp2
          [1674546505.533228][20008:20010] CHIP:TOO:       FabricIndex: 1
          [1674546505.533231][20008:20010] CHIP:TOO:      }
          [1674546505.533238][20008:20010] CHIP:TOO:     [3]: {
          [1674546505.533241][20008:20010] CHIP:TOO:       GroupId: 3
          [1674546505.533245][20008:20010] CHIP:TOO:       Endpoints: 1 entries
          [1674546505.533250][20008:20010] CHIP:TOO:         [1]: 0
          [1674546505.533254][20008:20010] CHIP:TOO:       GroupName: grp3
          [1674546505.533258][20008:20010] CHIP:TOO:       FabricIndex: 1
          [1674546505.533262][20008:20010] CHIP:TOO:      }
          [1674546505.533269][20008:20010] CHIP:TOO:     [4]: {
          [1674546505.533272][20008:20010] CHIP:TOO:       GroupId: 4
          [1674546505.533277][20008:20010] CHIP:TOO:       Endpoints: 1 entries
          [1674546505.533282][20008:20010] CHIP:TOO:         [1]: 0
          [1674546505.533286][20008:20010] CHIP:TOO:       GroupName: grp4
          [1674546505.533289][20008:20010] CHIP:TOO:       FabricIndex: 1
          [1674546505.533292][20008:20010] CHIP:TOO:      }
      disabled: true

    - label:
          "TH sends AddGroup command to DUT as unicast with the GroupID set to
          (maxgroups+1)"
      PICS: G.S.C00.Rsp
      verification: |
          ./chip-tool groups add-group 0x0007 grp7 1 0

          Verify the "status is RESOURCE_EXHAUSTED" on the TH(Chip-tool)  Log and below is the sample log provided for the raspi platform:

          [1674547293.989280][20162:20164] CHIP:DMG: },
          [1674547293.989297][20162:20164] CHIP:DMG: Received Command Response Data, Endpoint=0 Cluster=0x0000_0004 Command=0x0000_0000
          [1674547293.989307][20162:20164] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_0004 Command 0x0000_0000
          [1674547293.989316][20162:20164] CHIP:TOO:   AddGroupResponse: {
          [1674547293.989324][20162:20164] CHIP:TOO:     status: 137
          [1674547293.989328][20162:20164] CHIP:TOO:     groupID: 7
          [1674547293.989332][20162:20164] CHIP:TOO:    }
      disabled: true

    - label:
          "TH reads GroupTable attribute from the GroupKeyManagement cluster
          from DUT on PIXIT.G.ENDPOINT"
      PICS: GRPKEY.S.A0001
      verification: |
          ./chip-tool groupkeymanagement read group-table 1 0

          Verify the "grouptable entries" on the TH(Chip-tool)  Log and below is the sample log provided for the raspi platform:
          [1674546676.645814][20037:20039] CHIP:DMG: }
          [1674546676.646502][20037:20039] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003F Attribute 0x0000_0001 DataVersion: 1241587622
          [1674546676.646599][20037:20039] CHIP:TOO:   GroupTable: 4 entries
          [1674546676.646644][20037:20039] CHIP:TOO:     [1]: {
          [1674546676.646666][20037:20039] CHIP:TOO:       GroupId: 1
          [1674546676.646682][20037:20039] CHIP:TOO:       Endpoints: 1 entries
          [1674546676.646698][20037:20039] CHIP:TOO:         [1]: 0
          [1674546676.646710][20037:20039] CHIP:TOO:       GroupName: grp1
          [1674546676.646722][20037:20039] CHIP:TOO:       FabricIndex: 1
          [1674546676.646733][20037:20039] CHIP:TOO:      }
          [1674546676.646755][20037:20039] CHIP:TOO:     [2]: {
          [1674546676.646764][20037:20039] CHIP:TOO:       GroupId: 2
          [1674546676.646776][20037:20039] CHIP:TOO:       Endpoints: 1 entries
          [1674546676.646789][20037:20039] CHIP:TOO:         [1]: 0
          [1674546676.646799][20037:20039] CHIP:TOO:       GroupName: grp2
          [1674546676.646809][20037:20039] CHIP:TOO:       FabricIndex: 1
          [1674546676.646819][20037:20039] CHIP:TOO:      }
          [1674546676.646839][20037:20039] CHIP:TOO:     [3]: {
          [1674546676.646849][20037:20039] CHIP:TOO:       GroupId: 3
          [1674546676.646860][20037:20039] CHIP:TOO:       Endpoints: 1 entries
          [1674546676.646873][20037:20039] CHIP:TOO:         [1]: 0
          [1674546676.646884][20037:20039] CHIP:TOO:       GroupName: grp3
          [1674546676.646894][20037:20039] CHIP:TOO:       FabricIndex: 1
          [1674546676.646903][20037:20039] CHIP:TOO:      }
          [1674546676.646922][20037:20039] CHIP:TOO:     [4]: {
          [1674546676.646932][20037:20039] CHIP:TOO:       GroupId: 4
          [1674546676.646944][20037:20039] CHIP:TOO:       Endpoints: 1 entries
          [1674546676.646956][20037:20039] CHIP:TOO:         [1]: 0
          [1674546676.646967][20037:20039] CHIP:TOO:       GroupName: grp4
          [1674546676.646976][20037:20039] CHIP:TOO:       FabricIndex: 1
          [1674546676.646985][20037:20039] CHIP:TOO:      }
      disabled: true

    - label:
          "TH sends AddGroup command to DUT as unicast with the following fields
          : GroupID as 0x0000 GroupName as Gp6"
      PICS: G.S.C00.Rsp && G.S.C00.Tx
      verification: |
          ./chip-tool groups add-group 0x0000 grp6 1 0

          Verify the "status is CONSTRAINT_ERROR" on the TH(Chip-tool)  Log and GroupID is not in the inclusive range of 0x0001 to 0xffff,below is the sample log provided for the raspi platform:

          [1653484439.884144][11341:11346] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_0004 Command 0x0000_0000
          [1653484439.884258][11341:11346] CHIP:TOO:   AddGroupResponse: {
          [1653484439.884310][11341:11346] CHIP:TOO:     status: 135
          [1653484439.884346][11341:11346] CHIP:TOO:     groupId: 0
          [1653484439.884383][11341:11346] CHIP:TOO:    }
      disabled: true

    - label:
          "TH sends AddGroup command to DUT as unicast with the following fields
          : GroupID as 0x0005 GroupName as Gp5"
      PICS: G.S.C00.Rsp && G.S.C00.Tx
      verification: |
          ./chip-tool groups add-group 0x0005 grp5 1 0

          Verify the "status is UNSUPPORTED_ACCESS" on the TH(Chip-tool)  Log and ,below is the sample log provided for the raspi platform:


          [1658302176.951047][2747:2752] CHIP:TOO: Endpoint: 1 Cluster: 0x0000_0004 Command 0x0000_0000
          [1658302176.951103][2747:2752] CHIP:TOO:   AddGroupResponse: {
          [1658302176.951140][2747:2752] CHIP:TOO:     status: 126
          [1658302176.951166][2747:2752] CHIP:TOO:     groupId: 5
          [1658302176.951189][2747:2752] CHIP:TOO:    }
      disabled: true

    - label:
          "If maxgroups > 0, TH sends ViewGroup command to DUT as unicast with
          the following fields: GroupID as 0x0001"
      PICS: G.S.C01.Rsp && G.S.C01.Tx
      verification: |
          ./chip-tool groups view-group 0x0001 1 0

          Verify the "status is success" on the TH(Chip-tool)  Log and GroupID is in the inclusive range of 0x0001 to 0xffff,below is the sample log provided for the raspi platform:

          1653484504.667714][11349:11354] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_0004 Command 0x0000_0001
          [1653484504.667841][11349:11354] CHIP:TOO: ViewGroupResponse: {
          [1653484504.667927][11349:11354] CHIP:TOO: status: 0
          [1653484504.667974][11349:11354] CHIP:TOO: groupId: 1
          [1653484504.668018][11349:11354] CHIP:TOO: groupName: grp1
          [1653484504.668064][11349:11354] CHIP:TOO: }
      disabled: true

    - label:
          "TH sends ViewGroup command to DUT as unicast with the following
          fields: GroupID as 0x0000"
      PICS: G.S.C01.Rsp && G.S.C01.Tx
      verification: |
          ./chip-tool groups view-group 0x0000 1 0

          Verify the "status is CONSTRAINT_ERROR" on the TH(Chip-tool)  Log and GroupID is not in the inclusive range of 0x0001 to 0xffff, below is the sample log provided for the raspi platform:

          [1653484611.595344][11412:11417] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_0004 Command 0x0000_0001
          [1653484611.595454][11412:11417] CHIP:TOO:   ViewGroupResponse: {
          [1653484611.595501][11412:11417] CHIP:TOO:     status: 135
          [1653484611.595534][11412:11417] CHIP:TOO:     groupId: 0
          [1653484611.595565][11412:11417] CHIP:TOO:     groupName:
          [1653484611.595599][11412:11417] CHIP:TOO:    }
      disabled: true

    - label:
          "If maxgroups > 0, TH sends RemoveGroup command to DUT as unicast with
          the following field : GroupID as 0x0001"
      PICS: G.S.C03.Rsp && G.S.C03.Tx
      verification: |
          ./chip-tool groups remove-group 0x0001 1 0
          Verify the "status is success" on the TH(Chip-tool)  Log and below is the sample log provided for the raspi platform:


          [1653484876.432744][11451:11456] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_0004 Command 0x0000_0003
          [1653484876.432915][11451:11456] CHIP:TOO:   RemoveGroupResponse: {
          [1653484876.432989][11451:11456] CHIP:TOO:     status: 0
          [1653484876.433044][11451:11456] CHIP:TOO:     groupId: 1
          [1653484876.433098][11451:11456] CHIP:TOO:    }
      disabled: true

    - label:
          "If maxgroups > 0, TH sends ViewGroup command to DUT as unicast with
          the following field : GroupID as 0x0001"
      PICS: G.S.C01.Rsp && G.S.C01.Tx
      verification: |
          ./chip-tool groups view-group 0x0001 1 0

          Verify the "status is NOT_FOUND" on the TH(Chip-tool)  Log below is the sample log provided for the raspi platform:


          [1653484952.142387][11458:11463] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_0004 Command 0x0000_0001
          [1653484952.142476][11458:11463] CHIP:TOO:   ViewGroupResponse: {
          [1653484952.142516][11458:11463] CHIP:TOO:     status: 139
          [1653484952.142541][11458:11463] CHIP:TOO:     groupId: 1
          [1653484952.142566][11458:11463] CHIP:TOO:     groupName:
          [1653484952.142592][11458:11463] CHIP:TOO:    }
      disabled: true

    - label: "TH reads GroupTable attribute from the GroupKeyManagement cluster"
      PICS: GRPKEY.S.A0001
      verification: |
          ./chip-tool groupkeymanagement read group-table 1 0

          Verify the "grouptable entries" on the TH(Chip-tool)  Log below is the sample log provided for the raspi platform:

          [1674550642.445157][20620:20622] CHIP:DMG: }
          [1674550642.445302][20620:20622] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003F Attribute 0x0000_0001 DataVersion: 2738113270
          [1674550642.445326][20620:20622] CHIP:TOO:   GroupTable: 3 entries
          [1674550642.445342][20620:20622] CHIP:TOO:     [1]: {
          [1674550642.445348][20620:20622] CHIP:TOO:       GroupId: 2
          [1674550642.445352][20620:20622] CHIP:TOO:       Endpoints: 1 entries
          [1674550642.445356][20620:20622] CHIP:TOO:         [1]: 0
          [1674550642.445360][20620:20622] CHIP:TOO:       GroupName: grp2
          [1674550642.445363][20620:20622] CHIP:TOO:       FabricIndex: 1
          [1674550642.445366][20620:20622] CHIP:TOO:      }
          [1674550642.445371][20620:20622] CHIP:TOO:     [2]: {
          [1674550642.445374][20620:20622] CHIP:TOO:       GroupId: 3
          [1674550642.445377][20620:20622] CHIP:TOO:       Endpoints: 1 entries
          [1674550642.445380][20620:20622] CHIP:TOO:         [1]: 0
          [1674550642.445382][20620:20622] CHIP:TOO:       GroupName: grp3
          [1674550642.445385][20620:20622] CHIP:TOO:       FabricIndex: 1
          [1674550642.445387][20620:20622] CHIP:TOO:      }
          [1674550642.445393][20620:20622] CHIP:TOO:     [3]: {
          [1674550642.445395][20620:20622] CHIP:TOO:       GroupId: 4
          [1674550642.445398][20620:20622] CHIP:TOO:       Endpoints: 1 entries
          [1674550642.445401][20620:20622] CHIP:TOO:         [1]: 0
          [1674550642.445404][20620:20622] CHIP:TOO:       GroupName: grp4
          [1674550642.445407][20620:20622] CHIP:TOO:       FabricIndex: 1
          [1674550642.445409][20620:20622] CHIP:TOO:      }
      disabled: true

    - label:
          "TH sends RemoveGroup command to DUT as unicast with the following
          field : GroupID as 0x0000"
      PICS: G.S.C03.Rsp && G.S.C03.Tx
      verification: |
          ./chip-tool groups remove-group 0x0000 1 0

          Verify the "status as CONSTRAINT_ERROR" on the TH(Chip-tool)  Log and GroupID is not in the inclusive range of 0x0001 to 0xffff , below is the sample log provided for the raspi platform:

          [1653485045.328766][11473:11478] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_0004 Command 0x0000_0003
          [1653485045.328896][11473:11478] CHIP:TOO:   RemoveGroupResponse: {
          [1653485045.328954][11473:11478] CHIP:TOO:     status: 135
          [1653485045.328994][11473:11478] CHIP:TOO:     groupId: 0
          [1653485045.329036][11473:11478] CHIP:TOO:    }
      disabled: true

    - label:
          "TH sends RemoveGroup command to DUT as unicast with the following
          field : GroupID as 0x0001"
      PICS: G.S.C03.Rsp && G.S.C03.Tx
      verification: |
          ./chip-tool groups remove-group 0x0001 1 0

          Verify the "status is NOT_FOUND"  on the TH(Chip-tool)  Log and below is the sample log provided for the raspi platform:
          :

          [1653485126.672869][11483:11488] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_0004 Command 0x0000_0003
          [1653485126.672969][11483:11488] CHIP:TOO:   RemoveGroupResponse: {
          [1653485126.673015][11483:11488] CHIP:TOO:     status: 139
          [1653485126.673045][11483:11488] CHIP:TOO:     groupId: 1
          [1653485126.673075][11483:11488] CHIP:TOO:    }
      disabled: true

    - label: "TH reads GroupTable attribute from the GroupKeyManagement cluster"
      PICS: GRPKEY.S.A0001
      verification: |
          ./chip-tool groupkeymanagement read group-table 1 0

          Verify the "grouptable entries" on the TH(Chip-tool)  Log  and below is the sample log provided for the raspi platform:


          1674550693.202331][20637:20639] CHIP:DMG: }
          [1674550693.202481][20637:20639] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003F Attribute 0x0000_0001 DataVersion: 2738113270
          [1674550693.202503][20637:20639] CHIP:TOO:   GroupTable: 3 entries
          [1674550693.202517][20637:20639] CHIP:TOO:     [1]: {
          [1674550693.202525][20637:20639] CHIP:TOO:       GroupId: 2
          [1674550693.202530][20637:20639] CHIP:TOO:       Endpoints: 1 entries
          [1674550693.202536][20637:20639] CHIP:TOO:         [1]: 0
          [1674550693.202541][20637:20639] CHIP:TOO:       GroupName: grp2
          [1674550693.202544][20637:20639] CHIP:TOO:       FabricIndex: 1
          [1674550693.202547][20637:20639] CHIP:TOO:      }
          [1674550693.202554][20637:20639] CHIP:TOO:     [2]: {
          [1674550693.202558][20637:20639] CHIP:TOO:       GroupId: 3
          [1674550693.202562][20637:20639] CHIP:TOO:       Endpoints: 1 entries
          [1674550693.202567][20637:20639] CHIP:TOO:         [1]: 0
          [1674550693.202570][20637:20639] CHIP:TOO:       GroupName: grp3
          [1674550693.202572][20637:20639] CHIP:TOO:       FabricIndex: 1
          [1674550693.202574][20637:20639] CHIP:TOO:      }
          [1674550693.202580][20637:20639] CHIP:TOO:     [3]: {
          [1674550693.202582][20637:20639] CHIP:TOO:       GroupId: 4
          [1674550693.202586][20637:20639] CHIP:TOO:       Endpoints: 1 entries
          [1674550693.202591][20637:20639] CHIP:TOO:         [1]: 0
          [1674550693.202595][20637:20639] CHIP:TOO:       GroupName: grp4
          [1674550693.202599][20637:20639] CHIP:TOO:       FabricIndex: 1
          [1674550693.202602][20637:20639] CHIP:TOO:      }
      disabled: true

    - label: "TH sends RemoveAllGroups command to DUT as unicast method"
      PICS: G.S.C04.Rsp
      verification: |
          ./chip-tool groups remove-all-groups 1 0

          Verify the "status is success" on the TH(Chip-tool)  Log  and below is the sample log provided for the raspi platform:


          [1653485455.344097][11508:11513] CHIP:DMG:                              StatusIB =
          [1653485455.344141][11508:11513] CHIP:DMG:                              {
          [1653485455.344190][11508:11513] CHIP:DMG:                                 status = 0x00 (SUCCESS),
          [1653485455.344236][11508:11513] CHIP:DMG:                              },
      disabled: true

    - label:
          "TH sends ViewGroup command to DUT as unicast with the following
          fields: GroupID as 0x0001"
      PICS: G.S.C01.Rsp && G.S.C01.Tx
      verification: |
          ./chip-tool groups view-group 0x0001 1 0

          Verify the "status is NOT_FOUND" on the TH(Chip-tool)  Log and below is the sample log provided for the raspi platform:


          [1653559917.259920][3227:3232] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_0004 Command 0x0000_0001
          [1653559917.259993][3227:3232] CHIP:TOO:   ViewGroupResponse: {
          [1653559917.260040][3227:3232] CHIP:TOO:     status: 139
          [1653559917.260075][3227:3232] CHIP:TOO:     groupId: 1
          [1653559917.260107][3227:3232] CHIP:TOO:     groupName:
          [1653559917.260138][3227:3232] CHIP:TOO:    }
      disabled: true

    - label: "TH reads GroupTable attribute from the GroupKeyManagement cluster"
      PICS: GRPKEY.S.A0001
      verification: |
          ./chip-tool groupkeymanagement read group-table 1 0

          Verify the "grouptable entries" on the TH(Chip-tool)  Log and below is the sample log provided for the raspi platform:


          [1656332191.739327][27032:27037] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003F Attribute 0x0000_0001 DataVersion: 3761602970
          [1656332191.739391][27032:27037] CHIP:TOO:   GroupTable: 0 entries
      disabled: true
