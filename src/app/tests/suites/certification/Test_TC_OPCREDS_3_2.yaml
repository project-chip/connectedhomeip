# Copyright (c) 2021 Project CHIP Authors
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# Auto-generated scripts for harness use only, please review before automation. The endpoints and cluster names are currently set to default

name:
    11.3.2. [TC-OPCREDS-3.2] Attribute-CurrentFabricIndex validation
    [DUT-Server]

config:
    nodeId: 0x12344321
    cluster: "Basic"
    endpoint: 0

tests:
    - label: "Factory Reset DUT"
      verification: |
          On both DUT and TH side use the below command
          sudo rm -rf /tmp/chip_*
      disabled: true

    - label:
          "Commission DUT to TH1s Fabric When DUT sends NOC response save
          FabricIndex as FabricIndex_TH1"
      verification: |
          DUT side:
          sudo ./chip-all-clusters-app --wifi

          TH side:
          ./chip-tool pairing ble-wifi 1 zigbeehome matter123 20202021 3841 --trace_decode 1

          [1650455358.501816][4366:4371] CHIP:TOO: Device commissioning completed with success"


          After commissioning DUT to TH1"s fabric read nocs

          Verify the NOC and ICAC value during commissioning in TH Log

          NOC and ICAC value during commissioning

          [1658819330.489559][8295:8300] CHIP:DMG: InvokeRequestMessage =
          [1658819330.489587][8295:8300] CHIP:DMG: {
          [1658819330.489612][8295:8300] CHIP:DMG:         suppressResponse = false,
          [1658819330.489701][8295:8300] CHIP:DMG:         timedRequest = false,
          [1658819330.489730][8295:8300] CHIP:DMG:         InvokeRequests =
          [1658819330.489767][8295:8300] CHIP:DMG:         [
          [1658819330.489795][8295:8300] CHIP:DMG:                 CommandDataIB =
          [1658819330.489825][8295:8300] CHIP:DMG:                 {
          [1658819330.489854][8295:8300] CHIP:DMG:                         CommandPathIB =
          [1658819330.489888][8295:8300] CHIP:DMG:                         {
          [1658819330.489923][8295:8300] CHIP:DMG:                                 EndpointId = 0x0,
          [1658819330.489962][8295:8300] CHIP:DMG:                                 ClusterId = 0x3e,
          [1658819330.489999][8295:8300] CHIP:DMG:                                 CommandId = 0x6,
          [1658819330.490033][8295:8300] CHIP:DMG:                         },
          [1658819330.490069][8295:8300] CHIP:DMG:
          [1658819330.490099][8295:8300] CHIP:DMG:                         CommandFields =
          [1658819330.490133][8295:8300] CHIP:DMG:                         {
          [1658819330.490169][8295:8300] CHIP:DMG:                                 0x0 = [
          [1658819330.490291][8295:8300] CHIP:DMG:                                                 0x15, 0x30, 0x1, 0x1, 0x1, 0x24, 0x2, 0x1, 0x37, 0x3, 0x24, 0x13, 0x1, 0x18, 0x26, 0x4, 0x80, 0x22, 0x81, 0x27, 0x26, 0x5, 0x80, 0x25, 0x4d, 0x3a, 0x37, 0x6, 0x24, 0x15, 0x1, 0x24, 0x11, 0x1, 0x18, 0x24, 0x7, 0x1, 0x24, 0x8, 0x1, 0x30, 0x9, 0x41, 0x4, 0x94, 0x5b, 0xb6, 0xd3, 0x14, 0x0, 0x45, 0x35, 0xf0, 0x64, 0x25, 0x7d, 0xb7, 0x8a, 0x56, 0x9d, 0x5, 0x0, 0x56, 0xec, 0xbc, 0xa9, 0xb5, 0xdc, 0xfa, 0xa4, 0x93, 0x28, 0x14, 0x1d, 0x7, 0x3a, 0xc9, 0x7d, 0x1c, 0x9d, 0x21, 0x56, 0xf4, 0xec, 0xc8, 0x7d, 0x3c, 0x87, 0x6f, 0x51, 0xa3, 0x65, 0x89, 0x92, 0x4d, 0xcf, 0xd9, 0x11, 0x71, 0xab, 0x4e, 0x99, 0xcb, 0x90, 0x72, 0xb5, 0x45, 0xa9, 0x37, 0xa, 0x35, 0x1, 0x28, 0x1, 0x18, 0x24, 0x2, 0x1, 0x36, 0x3, 0x4, 0x2, 0x4, 0x1, 0x18, 0x30, 0x4, 0x14, 0xf2, 0x2d, 0x91, 0xb, 0xf2, 0xb1, 0xce, 0xdb, 0x60, 0x10, 0x23, 0x97, 0x31, 0xfd, 0x43, 0xc4, 0x40, 0x46, 0x5a, 0x99, 0x30, 0x5, 0x14, 0xf9, 0x94, 0xad, 0x9e, 0x2b, 0x0, 0x6b, 0xa9, 0xc1, 0x27, 0x6d, 0x20, 0xcb, 0x27, 0xa4, 0xf1, 0x21, 0x2b, 0xc9, 0x8b, 0x18, 0x30, 0xb, 0x40, 0xa1, 0xd2, 0x49, 0x5c, 0xa, 0xc1, 0x58, 0x12, 0x71, 0xd, 0x1a, 0x37, 0xe4, 0x7b, 0x3d, 0xbd, 0x19, 0xe, 0xe8, 0x86, 0xa8, 0x49, 0x4, 0x8, 0x7b, 0x20, 0x94, 0xfa, 0x21, 0xe8, 0x5b, 0xbf, 0x58, 0xc, 0x7d, 0x93, 0x4b, 0x89, 0x88, 0x78, 0xeb, 0xf2, 0x9, 0xf9, 0x3e, 0x6, 0xf7, 0x85, 0xbe, 0xa2, 0xa1, 0xf, 0xc8, 0x40, 0x64, 0xd5, 0xdf, 0x97, 0x6f, 0xef, 0x2c, 0xad, 0xbc, 0xcc, 0x18,
          [1658819330.490363][8295:8300] CHIP:DMG:                                 ] (241 bytes)
          [1658819330.490403][8295:8300] CHIP:DMG:                                 0x1 = [
          [1658819330.490521][8295:8300] CHIP:DMG:                                                 0x15, 0x30, 0x1, 0x1, 0x0, 0x24, 0x2, 0x1, 0x37, 0x3, 0x24, 0x14, 0x0, 0x18, 0x26, 0x4, 0x80, 0x22, 0x81, 0x27, 0x26, 0x5, 0x80, 0x25, 0x4d, 0x3a, 0x37, 0x6, 0x24, 0x13, 0x1, 0x18, 0x24, 0x7, 0x1, 0x24, 0x8, 0x1, 0x30, 0x9, 0x41, 0x4, 0x5c, 0x9d, 0x56, 0x1f, 0x53, 0xaa, 0xb6, 0xd9, 0x47, 0x3d, 0xf2, 0xee, 0x51, 0x70, 0xb0, 0x33, 0x32, 0xbc, 0x38, 0xef, 0x46, 0x18, 0x42, 0xc3, 0x79, 0x54, 0xce, 0x99, 0xad, 0xc4, 0xd5, 0x5b, 0x27, 0x2b, 0x3e, 0x54, 0x5b, 0xb9, 0xfb, 0x24, 0x40, 0xcb, 0x71, 0x2b, 0xa7, 0xb, 0xdd, 0xe2, 0x7a, 0x31, 0x8b, 0xee, 0x13, 0x48, 0xd5, 0xf8, 0xc2, 0xd2, 0xc9, 0x8c, 0xdb, 0xad, 0x63, 0xc9, 0x37, 0xa, 0x35, 0x1, 0x29, 0x1, 0x18, 0x24, 0x2, 0x60, 0x30, 0x4, 0x14, 0xf9, 0x94, 0xad, 0x9e, 0x2b, 0x0, 0x6b, 0xa9, 0xc1, 0x27, 0x6d, 0x20, 0xcb, 0x27, 0xa4, 0xf1, 0x21, 0x2b, 0xc9, 0x8b, 0x30, 0x5, 0x14, 0x90, 0x40, 0xfb, 0xaf, 0x6f, 0x57, 0xd4, 0xe3, 0x21, 0x88, 0xcd, 0x36, 0xd, 0xd4, 0x95, 0x92, 0x72, 0x74, 0x5d, 0x76, 0x18, 0x30, 0xb, 0x40, 0xc5, 0xef, 0xcc, 0x41, 0xa1, 0x8a, 0x4f, 0xad, 0x6b, 0x1d, 0xae, 0x6b, 0x12, 0x67, 0x5d, 0xc, 0x3f, 0xf1, 0x69, 0x7, 0x28, 0xc3, 0x1d, 0x1e, 0x95, 0x62, 0x95, 0x11, 0xf2, 0x3a, 0x43, 0x36, 0xdb, 0x53, 0x92, 0xe1, 0xfe, 0xf0, 0x5e, 0xf1, 0xba, 0x1d, 0xa4, 0x60, 0x80, 0xa2, 0x9b, 0xab, 0x60, 0xec, 0x61, 0x3d, 0xef, 0x3, 0x1e, 0x2e, 0xd9, 0x85, 0xb, 0xb2, 0xe3, 0xb4, 0x8b, 0x11, 0x18,
          [1658819330.490592][8295:8300] CHIP:DMG:                                 ] (231 bytes)
      disabled: true

    - label: "Save TH1s Fabric ID as FabricID1"
      verification: |
          Take the CurrentFabricIndex as fabindex1
      disabled: true

    - label:
          "Commission DUT to TH2s Fabric When DUT sends NOC response save
          FabricIndex as FabricIndex_TH2"
      verification: |
          To commission DUT to TH2 follow below procedure

          1. ./chip-tool  pairing open-commissioning-window 1 1 400 2000 3841  on TH

          CHIP:IN: Sending encrypted msg 0xaaaad3464d10 with MessageCounter:0 to 0x0000000000000001 at monotonic time: 5805157 msec
          [1635691999.946536][3822:3827] CHIP:DMG: ICR moving to [CommandSen]
          [1635691999.946586][3822:3827] CHIP:CTL: Manual pairing code: [35407541839]
          [1635691999.946650][3822:3827] CHIP:CTL: SetupQRCode: [MT:00000CQM00G6V851H10]
          [1635691999.946802][3822:3827] CHIP:EM: Sending Standalone Ack for MessageCounter:3234931243 on exchange 35324i
          [1635691999.946850][3822:3827] CHIP:IN: Prepared plaintext message 0xffffaa58a960 to 0x0000000000000000 of type 0x10 and protocolId (0, 0) on exchange 35324i with MessageCounter:1726016118.
          [1635691999.946895][3822:3827] CHIP:IN: Sending plaintext msg 0xffffaa58a960 with MessageCounter:1726016118 to 0x0000000000000000 at monotonic time: 5805158 msec
          [1635691999.946983][3822:3827] CHIP:EM: Flushed pending ack for MessageCounter:3234931243 on exchange 35324i

          2. On 2nd controller, using chip-tool connect using manual code.
          Below is the example when using chip tool as controller (considering 35998938564 as the manual code generated by 1st controller)
          ./chip-tool pairing code 2 35407541839
          Verify whether you got below message in the log of TH
          Device commissioning completed with success

          After commissioning DUT to TH2's fabric read nocs

          Verify in TH Log:
          NOC and ICAC value during commissioning is

          [1657692964.637112][93108:93113] CHIP:DMG:                         CommandFields =
          [1657692964.637117][93108:93113] CHIP:DMG:                         {
          [1657692964.637123][93108:93113] CHIP:DMG:                                 0x0 = [
          [1657692964.637158][93108:93113] CHIP:DMG:                                                 0x15, 0x30, 0x1, 0x1, 0x1, 0x24, 0x2, 0x1, 0x37, 0x3, 0x24, 0x13, 0x1, 0x18, 0x26, 0x4, 0x80, 0x22, 0x81, 0x27, 0x26, 0x5, 0x80, 0x25, 0x4d, 0x3a, 0x37, 0x6, 0x24, 0x15, 0x1, 0x24, 0x11, 0x2, 0x18, 0x24, 0x7, 0x1, 0x24, 0x8, 0x1, 0x30, 0x9, 0x41, 0x4, 0xc9, 0xc4, 0x4e, 0x8c, 0xbe, 0xed, 0xd4, 0x9c, 0x8f, 0x72, 0x3d, 0x77, 0x5a, 0x7, 0xad, 0x1d, 0xab, 0xe2, 0x79, 0x75, 0x5b, 0x5f, 0xfd, 0x34, 0xa7, 0x73, 0xed, 0x96, 0x1a, 0x88, 0xae, 0x37, 0x4c, 0xde, 0x63, 0x99, 0xd5, 0xe, 0xcd, 0x11, 0x1b, 0xd8, 0x9a, 0xcb, 0x6e, 0x36, 0x6a, 0x1f, 0xb8, 0x89, 0xc8, 0x61, 0x8e, 0xf1, 0xa, 0x19, 0xb1, 0xfb, 0xb9, 0x9b, 0x5b, 0x12, 0x66, 0x69, 0x37, 0xa, 0x35, 0x1, 0x28, 0x1, 0x18, 0x24, 0x2, 0x1, 0x36, 0x3, 0x4, 0x2, 0x4, 0x1, 0x18, 0x30, 0x4, 0x14, 0x47, 0x72, 0x3f, 0x5b, 0xaf, 0x16, 0x94, 0x4c, 0x3e, 0x45, 0x92, 0x26, 0xc9, 0x2f, 0x75, 0x48, 0x89, 0x94, 0x9b, 0x3d, 0x30, 0x5, 0x14, 0xa1, 0xe8, 0xff, 0x87, 0x3b, 0xd2, 0x8c, 0x5a, 0xb6, 0x89, 0xc0, 0x37, 0xc3, 0x19, 0x61, 0x99, 0xf6, 0x23, 0x50, 0xb6, 0x18, 0x30, 0xb, 0x40, 0x4f, 0x79, 0x94, 0x7, 0x18, 0x3c, 0x59, 0xb5, 0xcc, 0xf2, 0xa1, 0xa4, 0x2c, 0xa4, 0x40, 0xda, 0xea, 0x70, 0x92, 0x66, 0x88, 0x92, 0x78, 0x78, 0x6a, 0xa2, 0x73, 0x83, 0x13, 0x96, 0x16, 0xe, 0x72, 0xcc, 0x90, 0x77, 0xc0, 0x68, 0xc7, 0xd, 0xb0, 0x5f, 0x6f, 0x3e, 0x71, 0x29, 0xe7, 0x29, 0x39, 0xc8, 0x78, 0xd3, 0xa3, 0x2f, 0x5c, 0xa0, 0x62, 0xe0, 0xc7, 0xba, 0x48, 0x91, 0xa, 0xd6, 0x18,
          [1657692964.637175][93108:93113] CHIP:DMG:                                 ]
          [1657692964.637180][93108:93113] CHIP:DMG:                                 0x1 = [
          [1657692964.637214][93108:93113] CHIP:DMG:                                                 0x15, 0x30, 0x1, 0x1, 0x0, 0x24, 0x2, 0x1, 0x37, 0x3, 0x24, 0x14, 0x0, 0x18, 0x26, 0x4, 0x80, 0x22, 0x81, 0x27, 0x26, 0x5, 0x80, 0x25, 0x4d, 0x3a, 0x37, 0x6, 0x24, 0x13, 0x1, 0x18, 0x24, 0x7, 0x1, 0x24, 0x8, 0x1, 0x30, 0x9, 0x41, 0x4, 0xb4, 0xc, 0xdd, 0x16, 0x23, 0xfe, 0xe0, 0xe5, 0xd8, 0xfa, 0x1a, 0x2d, 0x9d, 0xf6, 0x13, 0xff, 0xe2, 0xc, 0x5b, 0xb9, 0xf5, 0x60, 0x25, 0x2c, 0x6, 0x13, 0x5c, 0x29, 0x67, 0xce, 0xee, 0xa0, 0x7c, 0x4b, 0x9, 0xf, 0x6c, 0x9b, 0xe, 0x4f, 0xe9, 0xa5, 0xa4, 0xb, 0x17, 0xa4, 0x1b, 0x6a, 0xae, 0xc4, 0x51, 0xfc, 0xed, 0x4b, 0xd4, 0x19, 0x2c, 0x7a, 0xe5, 0x58, 0xa4, 0x75, 0x48, 0x20, 0x37, 0xa, 0x35, 0x1, 0x29, 0x1, 0x18, 0x24, 0x2, 0x60, 0x30, 0x4, 0x14, 0xa1, 0xe8, 0xff, 0x87, 0x3b, 0xd2, 0x8c, 0x5a, 0xb6, 0x89, 0xc0, 0x37, 0xc3, 0x19, 0x61, 0x99, 0xf6, 0x23, 0x50, 0xb6, 0x30, 0x5, 0x14, 0x49, 0xfa, 0xf8, 0x8, 0x14, 0x7a, 0xeb, 0x16, 0xc5, 0x5, 0x6d, 0x50, 0xbe, 0x51, 0x98, 0x2e, 0xa, 0xcf, 0x54, 0xad, 0x18, 0x30, 0xb, 0x40, 0x34, 0xa4, 0x14, 0x92, 0xeb, 0x94, 0x9b, 0xb9, 0x19, 0x28, 0x44, 0x93, 0xae, 0x12, 0xae, 0xd5, 0x1d, 0xa7, 0x71, 0xe5, 0xa5, 0xea, 0xa5, 0xbf, 0xee, 0x90, 0x4e, 0x90, 0xea, 0xa9, 0x1, 0xf7, 0xa9, 0xb0, 0xae, 0x5c, 0xfa, 0x82, 0xbf, 0xe4, 0x71, 0x8e, 0x82, 0x75, 0x29, 0x64, 0x18, 0x23, 0xd7, 0x5e, 0xc1, 0xea, 0x2d, 0xeb, 0x6d, 0x63, 0x94, 0x78, 0x33, 0x91, 0xda, 0xcf, 0x99, 0xd6, 0x18,
      disabled: true

    - label: "Save TH2s Fabric ID as FabricID2"
      verification: |
          Take the CurrentFabricIndex as fabindex2
      disabled: true

    - label: "From TH1 read the CurrentFabricIndex"
      PICS: OPCREDS.S.A0005
      verification: |
          Verify in TH Log

          ./chip-tool operationalcredentials read   current-fabric-index   1 0

          CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Attribute 0x0000_0005 DataVersion: 2445178920
          CHIP:TOO:   CurrentFabricIndex: 1
          CHIP:EM: Sending Standalone Ack for MessageCounter:7141893 on exchange 26909i
      disabled: true

    - label:
          "From TH1 read the entire NOCs List attribute with a
          non-fabric-filtered read"
      verification: |
          ./chip-tool operationalcredentials read nocs 1 0

          Verify in TH Log

          [1657693116.110511][15039:15044] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Attribute 0x0000_0000 DataVersion: 908345149
          [1657693116.110594][15039:15044] CHIP:TOO:   NOCs: 1 entries
          [1657693116.110673][15039:15044] CHIP:TOO:     [1]: {
          [1657693116.110713][15039:15044] CHIP:TOO:       Noc: 1530010101240201370324130118260480228127260580254D3A370624150124110118240701240801300941041DEA2CF348149F1ABFC0E6F947059BB63B30C5A62E14D29482D1265D50E42B55B696D0E9FA32BA0960E6905BE93A89A2F4DE588E3C2C0B9A29FF8128D09BE439370A350128011824020136030402040118300414843A27FFF36C842402A9590F0975961A6A5F713B300514615818FAF5095121A4B8B0C567B0F287A4AB057B18300B406A23EC6EE12300976F0ECBB75882F37508F47DBEB01556771C229356C42ADC70D9E6B5E9F6E08D57CB05266A55348716D9F15B536791FBB62E59A7F46568770818
          [1657693116.110767][15039:15044] CHIP:TOO:       Icac: 1530010100240201370324140018260480228127260580254D3A3706241301182407012408013009410460C513458F1533F64B4F54EC65A154A9A65F4469880639AD504543DFCB551AC9E31BBF2A5E9056C1175F0A23297E08C1EDA898F256BF27CD5F5122F54DDBADBE370A3501290118240260300414615818FAF5095121A4B8B0C567B0F287A4AB057B300514B8434A311CA3AC9A0C9D5C1306A1F0F315ADF89518300B406EE87626E97912080B84988A7777C272B8CF2B3F43C3648E594031C0E40CD0BAEEF565840EF95AF1B4F8864EE9370AC07D71B4229B5B86100BC31865A606CE1E18
          [1657693116.110810][15039:15044] CHIP:TOO:       FabricIndex: 1
          [1657693116.110834][15039:15044] CHIP:TOO:      }
      disabled: true

    - label:
          "From TH1 read the entire NOCs List attribute with a fabric-filtered
          read"
      verification: |
          ./chip-tool operationalcredentials read nocs 1 0 --fabric-filtered 1

          Verify in TH Log

          [1657693140.680045][15047:15052] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Attribute 0x0000_0000 DataVersion: 908345149
          [1657693140.680128][15047:15052] CHIP:TOO:   NOCs: 1 entries
          [1657693140.680206][15047:15052] CHIP:TOO:     [1]: {
          [1657693140.680245][15047:15052] CHIP:TOO:       Noc: 1530010101240201370324130118260480228127260580254D3A370624150124110118240701240801300941041DEA2CF348149F1ABFC0E6F947059BB63B30C5A62E14D29482D1265D50E42B55B696D0E9FA32BA0960E6905BE93A89A2F4DE588E3C2C0B9A29FF8128D09BE439370A350128011824020136030402040118300414843A27FFF36C842402A9590F0975961A6A5F713B300514615818FAF5095121A4B8B0C567B0F287A4AB057B18300B406A23EC6EE12300976F0ECBB75882F37508F47DBEB01556771C229356C42ADC70D9E6B5E9F6E08D57CB05266A55348716D9F15B536791FBB62E59A7F46568770818
          [1657693140.680309][15047:15052] CHIP:TOO:       Icac: 1530010100240201370324140018260480228127260580254D3A3706241301182407012408013009410460C513458F1533F64B4F54EC65A154A9A65F4469880639AD504543DFCB551AC9E31BBF2A5E9056C1175F0A23297E08C1EDA898F256BF27CD5F5122F54DDBADBE370A3501290118240260300414615818FAF5095121A4B8B0C567B0F287A4AB057B300514B8434A311CA3AC9A0C9D5C1306A1F0F315ADF89518300B406EE87626E97912080B84988A7777C272B8CF2B3F43C3648E594031C0E40CD0BAEEF565840EF95AF1B4F8864EE9370AC07D71B4229B5B86100BC31865A606CE1E18
          [1657693140.680341][15047:15052] CHIP:TOO:       FabricIndex: 1
          [1657693140.680366][15047:15052] CHIP:TOO:      }
      disabled: true

    - label: "Read NOCStruct values from entry at index 0"
      verification: |
          ./chip-tool operationalcredentials read nocs 1 0 --fabric-filtered 1

          Verify in TH Log

          [1657693140.680045][15047:15052] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Attribute 0x0000_0000 DataVersion: 908345149
          [1657693140.680128][15047:15052] CHIP:TOO:   NOCs: 1 entries
          [1657693140.680206][15047:15052] CHIP:TOO:     [1]: {
          [1657693140.680245][15047:15052] CHIP:TOO:       Noc: 1530010101240201370324130118260480228127260580254D3A370624150124110118240701240801300941041DEA2CF348149F1ABFC0E6F947059BB63B30C5A62E14D29482D1265D50E42B55B696D0E9FA32BA0960E6905BE93A89A2F4DE588E3C2C0B9A29FF8128D09BE439370A350128011824020136030402040118300414843A27FFF36C842402A9590F0975961A6A5F713B300514615818FAF5095121A4B8B0C567B0F287A4AB057B18300B406A23EC6EE12300976F0ECBB75882F37508F47DBEB01556771C229356C42ADC70D9E6B5E9F6E08D57CB05266A55348716D9F15B536791FBB62E59A7F46568770818
          [1657693140.680309][15047:15052] CHIP:TOO:       Icac: 1530010100240201370324140018260480228127260580254D3A3706241301182407012408013009410460C513458F1533F64B4F54EC65A154A9A65F4469880639AD504543DFCB551AC9E31BBF2A5E9056C1175F0A23297E08C1EDA898F256BF27CD5F5122F54DDBADBE370A3501290118240260300414615818FAF5095121A4B8B0C567B0F287A4AB057B300514B8434A311CA3AC9A0C9D5C1306A1F0F315ADF89518300B406EE87626E97912080B84988A7777C272B8CF2B3F43C3648E594031C0E40CD0BAEEF565840EF95AF1B4F8864EE9370AC07D71B4229B5B86100BC31865A606CE1E18
          [1657693140.680341][15047:15052] CHIP:TOO:       FabricIndex: 1
          [1657693140.680366][15047:15052] CHIP:TOO:      }
      disabled: true

    - label:
          "Read the Fabrics List and get the FabricDescriptorStruct for the
          entry where FabricIndex = FabricIndex_TH1 from DUT"
      verification: |
          ./chip-tool operationalcredentials read fabrics 1 0

          Verify in TH Log

          [1657693240.722099][15129:15134] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Attribute 0x0000_0001 DataVersion: 908345149
          [1657693240.722200][15129:15134] CHIP:TOO:   Fabrics: 1 entries
          [1657693240.722273][15129:15134] CHIP:TOO:     [1]: {
          [1657693240.722316][15129:15134] CHIP:TOO:       RootPublicKey: 04038A93AE14428E9179C2ACC3BA1522D4D19BC20A3203BE97FEC0BE47EBC6CCCD4AD5F7B1CE0A02F85FF1B14216FAFCA034B3B312C16B0517267804D5B03582EF
          [1657693240.722368][15129:15134] CHIP:TOO:       VendorId: 65521
          [1657693240.722401][15129:15134] CHIP:TOO:       FabricId: 1
          [1657693240.722431][15129:15134] CHIP:TOO:       NodeId: 1
          [1657693240.722462][15129:15134] CHIP:TOO:       Label:
          [1657693240.722492][15129:15134] CHIP:TOO:       FabricIndex: 1
          [1657693240.722522][15129:15134] CHIP:TOO:      }
      disabled: true

    - label: "From TH2 read the CurrentFabricIndex"
      verification: |
          ./chip-tool operationalcredentials read   current-fabric-index 2 0

          Verify in TH Log

          CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Attribute 0x0000_0005 DataVersion: 2445178920
          CHIP:TOO:   CurrentFabricIndex: 2
          CHIP:EM: Sending Standalone Ack for MessageCounter:8900122 on exchange 26519i
      disabled: true

    - label:
          "From TH2 read the entire NOCs List attribute with a
          non-fabric-filtered read"
      verification: |
          ./chip-tool operationalcredentials read nocs 2 0

          Verify in TH Log

          Verify the NOCs List in TH2 Log

          [1658819643.546022][8397:8402] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Attribute 0x0000_0000 DataVersion: 2645922631
          [1658819643.546148][8397:8402] CHIP:TOO:   NOCs: 1 entries
          [1658819643.546258][8397:8402] CHIP:TOO:     [1]: {
          [1658819643.546307][8397:8402] CHIP:TOO:       Noc: 1530010101240201370324130118260480228127260580254D3A37062415012411021824070124080130094104FF8D28DB36902F674F4BF312985CDEA52231E0B3C4795E54E3EFC0D6DE9AED140DEF653EDE9160B10BF446D6E2FAC5DBD38BF85597E095136A209F0990E54394370A3501280118240201360304020401183004144F0F08EA1F5414C324914019EB74CA31C9819AC6300514FF5D080583B5B132C45F800B8D2E184E7D599F5118300B40D434A0D9DA1C7D61784D8BCBEE3E7179A4818499442DD23919A81933C0170673FF33D0E8654312388EE717161DF5E1B6E14402380602B873D551174B2BA0D8E718
          [1658819643.546407][8397:8402] CHIP:TOO:       Icac: 1530010100240201370324140018260480228127260580254D3A37062413011824070124080130094104A58C57E9D8919152DE03DAC991155D750A5D8C93093D75E166E1C5CF86381EA926E108BFE78DAD9FFFB4363A706DA88B9F3B8EF5D80F428F44EAE26472C81B47370A3501290118240260300414FF5D080583B5B132C45F800B8D2E184E7D599F513005143036AAD3B8EDBF6075364A85A96F9A0583EEC49718300B4014BEAF33C7B547857AC36A17AD1CDD4D90D7045889C5B576CA644C78F021B6C21498EDDC43730AFEAD6AF5A945728D1C4F7DF7EE37C313D5AE27E78F0509DB9918
          [1658819643.546447][8397:8402] CHIP:TOO:       FabricIndex: 2
          [1658819643.546478][8397:8402] CHIP:TOO:      }
      disabled: true

    - label:
          "Verify that there is only data for the entry whose FabricIndex field
          is equal to FabricIndex_TH2"
      verification: |
          ./chip-tool operationalcredentials read   current-fabric-index 2 0

          Verify current fabric index in TH2 Log

          CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Attribute 0x0000_0005 DataVersion: 2445178920
          CHIP:TOO:   CurrentFabricIndex: 2
          CHIP:EM: Sending Standalone Ack for MessageCounter:8900122 on exchange 26519i
      disabled: true

    - label:
          "From TH2 read the entire NOCs List attribute with a fabric-filtered
          read"
      verification: |
          ./chip-tool operationalcredentials read nocs 2 0 --fabric-filtered 1

          Verify in TH Log

          [1657693320.664710][93225:93230] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Attribute 0x0000_0000 DataVersion: 908345149
          [1657693320.664809][93225:93230] CHIP:TOO:   NOCs: 1 entries
          [1657693320.664889][93225:93230] CHIP:TOO:     [1]: {
          [1657693320.664942][93225:93230] CHIP:TOO:       Noc: 1530010101240201370324130118260480228127260580254D3A37062415012411021824070124080130094104C9C44E8CBEEDD49C8F723D775A07AD1DABE279755B5FFD34A773ED961A88AE374CDE6399D50ECD111BD89ACB6E366A1FB889C8618EF10A19B1FBB99B5B126669370A35012801182402013603040204011830041447723F5BAF16944C3E459226C92F754889949B3D300514A1E8FF873BD28C5AB689C037C3196199F62350B618300B404F799407183C59B5CCF2A1A42CA440DAEA709266889278786AA273831396160E72CC9077C068C70DB05F6F3E7129E72939C878D3A32F5CA062E0C7BA48910AD618
          [1657693320.665017][93225:93230] CHIP:TOO:       Icac: 1530010100240201370324140018260480228127260580254D3A37062413011824070124080130094104B40CDD1623FEE0E5D8FA1A2D9DF613FFE20C5BB9F560252C06135C2967CEEEA07C4B090F6C9B0E4FE9A5A40B17A41B6AAEC451FCED4BD4192C7AE558A4754820370A3501290118240260300414A1E8FF873BD28C5AB689C037C3196199F62350B630051449FAF808147AEB16C5056D50BE51982E0ACF54AD18300B4034A41492EB949BB919284493AE12AED51DA771E5A5EAA5BFEE904E90EAA901F7A9B0AE5CFA82BFE4718E827529641823D75EC1EA2DEB6D6394783391DACF99D618
          [1657693320.665057][93225:93230] CHIP:TOO:       FabricIndex: 2
          [1657693320.665079][93225:93230] CHIP:TOO:      }
      disabled: true

    - label: "Read NOCStruct values from entry at index 1"
      verification: |
          ./chip-tool operationalcredentials read nocs 2 0

          Verify in TH Log

          [1657693277.401266][93213:93218] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Attribute 0x0000_0000 DataVersion: 908345149
          [1657693277.401332][93213:93218] CHIP:TOO:   NOCs: 1 entries
          [1657693277.401428][93213:93218] CHIP:TOO:     [1]: {
          [1657693277.401470][93213:93218] CHIP:TOO:       Noc: 1530010101240201370324130118260480228127260580254D3A37062415012411021824070124080130094104C9C44E8CBEEDD49C8F723D775A07AD1DABE279755B5FFD34A773ED961A88AE374CDE6399D50ECD111BD89ACB6E366A1FB889C8618EF10A19B1FBB99B5B126669370A35012801182402013603040204011830041447723F5BAF16944C3E459226C92F754889949B3D300514A1E8FF873BD28C5AB689C037C3196199F62350B618300B404F799407183C59B5CCF2A1A42CA440DAEA709266889278786AA273831396160E72CC9077C068C70DB05F6F3E7129E72939C878D3A32F5CA062E0C7BA48910AD618
          [1657693277.401534][93213:93218] CHIP:TOO:       Icac: 1530010100240201370324140018260480228127260580254D3A37062413011824070124080130094104B40CDD1623FEE0E5D8FA1A2D9DF613FFE20C5BB9F560252C06135C2967CEEEA07C4B090F6C9B0E4FE9A5A40B17A41B6AAEC451FCED4BD4192C7AE558A4754820370A3501290118240260300414A1E8FF873BD28C5AB689C037C3196199F62350B630051449FAF808147AEB16C5056D50BE51982E0ACF54AD18300B4034A41492EB949BB919284493AE12AED51DA771E5A5EAA5BFEE904E90EAA901F7A9B0AE5CFA82BFE4718E827529641823D75EC1EA2DEB6D6394783391DACF99D618
          [1657693277.401566][93213:93218] CHIP:TOO:       FabricIndex: 2
          [1657693277.401581][93213:93218] CHIP:TOO:      }
      disabled: true
