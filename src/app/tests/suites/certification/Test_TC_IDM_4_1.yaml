# Copyright (c) 2021 Project CHIP Authors
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# Auto-generated scripts for harness use only, please review before automation. The endpoints and cluster names are currently set to default

name:
    3.4.1. [TC-IDM-4.1] SubscriptionRequestMessage from DUT test cases.
    [DUT_Client]

PICS:
    - MCORE.IDM.C.SubscribeRequest

config:
    nodeId: 0x12344321
    cluster: "Basic Information"
    endpoint: 0

tests:
    - label: "Note"
      verification: |
          1. Please use Interactive mode to Verify subscription test cases Here the command to enter interactive mode:--   ./chip-tool interactive start
          2. Chip-tool command used below are an example to verify the  DUT as client test cases. For certification test, we expect DUT should have a capability or way to run the equivalent command.
      disabled: true

    - label:
          "DUT sends a subscription request message to the target node/reference
          device for a single attribute of any data type supported."
      PICS: MCORE.IDM.C.SubscribeRequest
      verification: |
          Product maker needs to provide instructions for how to trigger the command on the DUT. For comparison, the DUT behavior for this test step can be simulated using chip-tool (when DUT is a commissioner/Client)

           Please use Interactive mode to Verify subscription test cases
          Here the command to enter interactive mode:--   ./chip-tool interactive start

          onoff subscribe on-off  10 80 1 1

          On the TH(reference app) verify the subscription message received has the following fields. KeepSubscriptions which is of type bool
           MinIntervalFloor which is of type uint16
           MaxIntervalCeiling which is of type uint16
           [Optional]AttributeRequests which is of type list and contains the attribute paths
           [Optional]DataVersionFilters which is of type list and contains the data versions of the attributes requested.+ [Optional]EventRequests which is of type list
           [Optional]EventFilters which is of type list
           [Optional]FabricFiltered which is of type bool

          [1657446108.596676][11525:11525] CHIP:IM: Received Subscribe request
          [1657446108.596832][11525:11525] CHIP:IM: Deleting previous subscription from NodeId: 000000000001B669, FabricIndex: 1
          [1657446108.596950][11525:11525] CHIP:DMG: SubscribeRequestMessage =
          [1657446108.597015][11525:11525] CHIP:DMG: {
          [1657446108.597075][11525:11525] CHIP:DMG:      KeepSubscriptions = false,
          [1657446108.597136][11525:11525] CHIP:DMG:      MinIntervalFloorSeconds = 0xa,
          [1657446108.597311][11525:11525] CHIP:DMG:      MaxIntervalCeilingSeconds = 0x50,[1657446108.597377][11525:11525] CHIP:DMG:      AttributePathIBs =
          [1657446108.597441][11525:11525] CHIP:DMG:      [
          [1657446108.597501][11525:11525] CHIP:DMG:              AttributePathIB =
          [1657446108.597567][11525:11525] CHIP:DMG:              {
          [1657446108.597635][11525:11525] CHIP:DMG:                      Endpoint = 0x1,
          [1657446108.597710][11525:11525] CHIP:DMG:                      Cluster = 0x6,
          [1657446108.597786][11525:11525] CHIP:DMG:                      Attribute = 0x0000_0000,
          [1657446108.597860][11525:11525] CHIP:DMG:              }
          [1657446108.597929][11525:11525] CHIP:DMG:
          [1657446108.597990][11525:11525] CHIP:DMG:      ],
          [1657446108.598058][11525:11525] CHIP:DMG:
          [1657446108.598122][11525:11525] CHIP:DMG:      isFabricFiltered = true,
          [1657446108.598184][11525:11525] CHIP:DMG:      InteractionModelRevision = 1
          [1657446108.598241][11525:11525] CHIP:DMG: },
          [1657446108.598388][11525:11525] CHIP:DMG: Final negotiated min/max parameters: Min = 10s, Max = 80s
          [1657446108.598559][11525:11525] CHIP:DMG: IM RH moving to [GeneratingReports]


          If the DUT has to provision to verify the logs,  verify that TH all-clusters-app sent Subscription report with unic subscriptionID
          [1657884469.617473][2938:2943] CHIP:DMG: ReportDataMessage =
          [1657884469.617508][2938:2943] CHIP:DMG: {
          [1657884469.617538][2938:2943] CHIP:DMG:         SubscriptionId = 0x2d030a2b,
          [1657884469.617572][2938:2943] CHIP:DMG:         AttributeReportIBs =
          [1657884469.617610][2938:2943] CHIP:DMG:         [
          [1657884469.617641][2938:2943] CHIP:DMG:                 AttributeReportIB =
          [1657884469.617680][2938:2943] CHIP:DMG:                 {
          [1657884469.617712][2938:2943] CHIP:DMG:                         AttributeDataIB =
          [1657884469.617749][2938:2943] CHIP:DMG:                         {
          [1657884469.617790][2938:2943] CHIP:DMG:                                 DataVersion = 0x42da0cab,
          [1657884469.617830][2938:2943] CHIP:DMG:                                 AttributePathIB =
          [1657884469.617875][2938:2943] CHIP:DMG:                                 {
          [1657884469.617918][2938:2943] CHIP:DMG:                                         Endpoint = 0x1,
          [1657884469.617961][2938:2943] CHIP:DMG:                                         Cluster = 0x6,
          [1657884469.618006][2938:2943] CHIP:DMG:                                         Attribute = 0x0000_0000,
          [1657884469.618051][2938:2943] CHIP:DMG:                                 }
          [1657884469.618094][2938:2943] CHIP:DMG:
          [1657884469.618137][2938:2943] CHIP:DMG:                                 Data = false,
          [1657884469.618176][2938:2943] CHIP:DMG:                         },
          [1657884469.618216][2938:2943] CHIP:DMG:
          [1657884469.618250][2938:2943] CHIP:DMG:                 },
          [1657884469.618288][2938:2943] CHIP:DMG:
          [1657884469.618317][2938:2943] CHIP:DMG:         ],
          [1657884469.618354][2938:2943] CHIP:DMG:
          [1657884469.618384][2938:2943] CHIP:DMG:         InteractionModelRevision = 1
          [1657884469.618413][2938:2943] CHIP:DMG: }
          [1657884469.618568][2938:2943] CHIP:TOO: Endpoint: 1 Cluster: 0x0000_0006 Attribute 0x0000_0000 DataVersion: 1121586347
          [1657884469.618632][2938:2943] CHIP:TOO:   OnOff: FALSE
          [1657884469.618690][2938:2943] CHIP:DMG: MoveToState ReadClient[0xffffa40091f0]: Moving to [AwaitingSu]
          [1657884469.618749][2938:2943] CHIP:EM: Piggybacking Ack for MessageCounter:137911467 on exchange: 45823i
          [1657884469.618817][2938:2943] CHIP:IN: Prepared secure message 0xffffa4000d48 to 0x0000000000000001 (1)  of type 0x1 and protocolId (0, 1) on exchange 45823i with MessageCounter:83158075.
          [1657884469.618860][2938:2943] CHIP:IN: Sending encrypted msg 0xffffa4000d48 with MessageCounter:83158075 to 0x0000000000000001 (1) at monotonic time: 00000000006D764A msec
          [1657884469.620359][2938:2943] CHIP:EM: Received message of type 0x4 with protocolId (0, 1) and MessageCounter:137911468 on exchange 45823i
          [1657884469.620401][2938:2943] CHIP:EM: Found matching exchange: 45823i, Delegate: 0xffffa40091f0
          [1657884469.620439][2938:2943] CHIP:EM: Rxd Ack; Removing MessageCounter:83158075 from Retrans Table on exchange 45823i
          [1657884469.620469][2938:2943] CHIP:EM: Removed CHIP MessageCounter:83158075 from RetransTable on exchange 45823i
          [1657884469.620523][2938:2943] CHIP:DMG: SubscribeResponseMessage =
          [1657884469.620557][2938:2943] CHIP:DMG: {
          [1657884469.620587][2938:2943] CHIP:DMG:         SubscriptionId = 0x2d030a2b,
          [1657884469.620619][2938:2943] CHIP:DMG:         MaxInterval = 0x50,
          [1657884469.620650][2938:2943] CHIP:DMG:         InteractionModelRevision = 1
          [1657884469.620679][2938:2943] CHIP:DMG: }
          [1657884469.620711][2938:2943] CHIP:DMG: Subscription established with SubscriptionID = 0x2d030a2b MinInterval = 10s MaxInterval = 80s Peer = 01:0000000000000001
      disabled: true

    - label:
          "DUT sends the subscription request message to TH TH sends a report
          data DUT sends the status response back to TH"
      PICS: MCORE.IDM.C.SubscribeRequest
      verification: |
          Product maker needs to provide instructions for how to trigger the command on the DUT. For comparison, the DUT behavior for this test step can be simulated using chip-tool (when DUT is a commissioner/Client)

           Please use Interactive mode to Verify subscription test cases
          Here the command to enter interactive mode:--   ./chip-tool interactive start

          onoff  subscribe on-off   10 80  1 1

          Verify on the TH(reference-app) that the status response received from the DUT is "Success"


          [1657446108.604270][11525:11525] CHIP:EM: Removed CHIP MessageCounter:79424297 from RetransTable on exchange 24r
          [1657446108.604371][11525:11525] CHIP:DMG: StatusResponseMessage =
          [1657446108.604435][11525:11525] CHIP:DMG: {
          [1657446108.604494][11525:11525] CHIP:DMG:      Status = 0x00 (SUCCESS),
          [1657446108.604557][11525:11525] CHIP:DMG:      InteractionModelRevision = 1
          [1657446108.604614][11525:11525] CHIP:DMG: }
          [1657446108.604672][11525:11525] CHIP:IM: Received status response, status is 0x00 (SUCCESS)
          [1657446108.604755][11525:11525] CHIP:DMG: Refresh Subscribe Sync Timer with max 80 seconds


          If the DUT has to provision to verify the logs, verify that TH all-clusters-app sent Subscription report with unic subscriptionID
          [1657884569.751004][2938:2943] CHIP:DMG: ReportDataMessage =
          [1657884569.751034][2938:2943] CHIP:DMG: {
          [1657884569.751059][2938:2943] CHIP:DMG:         SubscriptionId = 0x47cd6fdb,
          [1657884569.751111][2938:2943] CHIP:DMG:         AttributeReportIBs =
          [1657884569.751147][2938:2943] CHIP:DMG:         [
          [1657884569.751173][2938:2943] CHIP:DMG:                 AttributeReportIB =
          [1657884569.751219][2938:2943] CHIP:DMG:                 {
          [1657884569.751259][2938:2943] CHIP:DMG:                         AttributeDataIB =
          [1657884569.751304][2938:2943] CHIP:DMG:                         {
          [1657884569.751351][2938:2943] CHIP:DMG:                                 DataVersion = 0x42da0cab,
          [1657884569.751395][2938:2943] CHIP:DMG:                                 AttributePathIB =
          [1657884569.751441][2938:2943] CHIP:DMG:                                 {
          [1657884569.751493][2938:2943] CHIP:DMG:                                         Endpoint = 0x1,
          [1657884569.751544][2938:2943] CHIP:DMG:                                         Cluster = 0x6,
          [1657884569.751596][2938:2943] CHIP:DMG:                                         Attribute = 0x0000_0000,
          [1657884569.751645][2938:2943] CHIP:DMG:                                 }
          [1657884569.751696][2938:2943] CHIP:DMG:
          [1657884569.751749][2938:2943] CHIP:DMG:                                 Data = false,
          [1657884569.751796][2938:2943] CHIP:DMG:                         },
          [1657884569.751843][2938:2943] CHIP:DMG:
          [1657884569.751874][2938:2943] CHIP:DMG:                 },
          [1657884569.751915][2938:2943] CHIP:DMG:
          [1657884569.751941][2938:2943] CHIP:DMG:         ],
          [1657884569.751971][2938:2943] CHIP:DMG:
          [1657884569.751996][2938:2943] CHIP:DMG:         InteractionModelRevision = 1
          [1657884569.752022][2938:2943] CHIP:DMG: }
          [1657884569.752174][2938:2943] CHIP:TOO: Endpoint: 1 Cluster: 0x0000_0006 Attribute 0x0000_0000 DataVersion: 1121586347
          [1657884569.752217][2938:2943] CHIP:TOO:   OnOff: FALSE
          [1657884569.752255][2938:2943] CHIP:DMG: MoveToState ReadClient[0xffffa40092e0]: Moving to [AwaitingSu]
          [1657884569.752319][2938:2943] CHIP:EM: Piggybacking Ack for MessageCounter:137911471 on exchange: 45824i
          [1657884569.752393][2938:2943] CHIP:IN: Prepared secure message 0xaaaafe09b548 to 0x0000000000000001 (1)  of type 0x1 and protocolId (0, 1) on exchange 45824i with MessageCounter:83158079.
          [1657884569.752435][2938:2943] CHIP:IN: Sending encrypted msg 0xaaaafe09b548 with MessageCounter:83158079 to 0x0000000000000001 (1) at monotonic time: 00000000006EFD70 msec
          [1657884569.754254][2938:2943] CHIP:EM: Received message of type 0x4 with protocolId (0, 1) and MessageCounter:137911472 on exchange 45824i
          [1657884569.754333][2938:2943] CHIP:EM: Found matching exchange: 45824i, Delegate: 0xffffa40092e0
          [1657884569.754372][2938:2943] CHIP:EM: Rxd Ack; Removing MessageCounter:83158079 from Retrans Table on exchange 45824i
          [1657884569.754397][2938:2943] CHIP:EM: Removed CHIP MessageCounter:83158079 from RetransTable on exchange 45824i
          [1657884569.754449][2938:2943] CHIP:DMG: SubscribeResponseMessage =
          [1657884569.754478][2938:2943] CHIP:DMG: {
          [1657884569.754502][2938:2943] CHIP:DMG:         SubscriptionId = 0x47cd6fdb,
          [1657884569.754533][2938:2943] CHIP:DMG:         MaxInterval = 0x50,
          [1657884569.754559][2938:2943] CHIP:DMG:         InteractionModelRevision = 1
          [1657884569.754581][2938:2943] CHIP:DMG: }
          [1657884569.754610][2938:2943] CHIP:DMG: Subscription established with SubscriptionID = 0x47cd6fdb MinInterval = 10s MaxInterval = 80s Peer = 01:0000000000000001
      disabled: true

    - label:
          "[OPTIONAL] Activate the subscription between the DUT and the TH for
          an attribute of data type boolean. Modify that attribute on the TH. TH
          should send the modified data to the DUT. Modify the attribute
          multiple times (3 times)."
      PICS: MCORE.IDM.C.SubscribeRequest.Attribute.DataType_Bool
      verification: |
          Product maker needs to provide instructions for how to trigger the command on the DUT. For comparison, the DUT behavior for this test step can be simulated using chip-tool (when DUT is a commissioner/Client)


           Please use Interactive mode to Verify subscription test cases
          Here the command to enter interactive mode:--   ./chip-tool interactive start

          basicinformation subscribe local-config-disabled 10 100 1 0

          On TH (On the reference app) Verify if DUT is responding with the below status response for the above command
          [1657445852.161250][11525:11525] CHIP:DMG: StatusResponseMessage =
          [1657445852.161278][11525:11525] CHIP:DMG: {
          [1657445852.161301][11525:11525] CHIP:DMG:      Status = 0x00 (SUCCESS),
          [1657445852.161326][11525:11525] CHIP:DMG:      InteractionModelRevision = 1
          [1657445852.161348][11525:11525] CHIP:DMG: }
          [1657445852.161372][11525:11525] CHIP:IM: Received status response, status is 0x00 (SUCCESS)
          [1657445852.161412][11525:11525] CHIP:DMG: Refresh Subscribe Sync Timer with max 100 seconds



          In the case of chip tool as a client, here is an example command the client can write an attribute in the basic cluster in the TH to change the value that the client subscribed in the above command.

          basicinformation write local-config-disabled 1 1 0
          [1657445962.258847][11525:11525] CHIP:DMG: StatusResponseMessage =
          [1657445962.258876][11525:11525] CHIP:DMG: {
          [1657445962.258901][11525:11525] CHIP:DMG:      Status = 0x00 (SUCCESS),
          [1657445962.258926][11525:11525] CHIP:DMG:      InteractionModelRevision = 1
          [1657445962.258950][11525:11525] CHIP:DMG: }
          [1657445962.258975][11525:11525] CHIP:IM: Received status response, status is 0x00 (SUCCESS)
          [1657445962.259002][11525:11525] CHIP:DMG: <RE> OnReportConfirm: NumReports = 0




          If the DUT has to provision to verify the logs,  verify that TH all-clusters-app sent Subscription report with unic subscriptionID
          [1657884643.152038][2938:2943] CHIP:DMG: ReportDataMessage =
          [1657884643.152141][2938:2943] CHIP:DMG: {
          [1657884643.152206][2938:2943] CHIP:DMG:         SubscriptionId = 0x2e0592e3,
          [1657884643.152276][2938:2943] CHIP:DMG:         AttributeReportIBs =
          [1657884643.152353][2938:2943] CHIP:DMG:         [
          [1657884643.152414][2938:2943] CHIP:DMG:                 AttributeReportIB =
          [1657884643.152497][2938:2943] CHIP:DMG:                 {
          [1657884643.152565][2938:2943] CHIP:DMG:                         AttributeDataIB =
          [1657884643.152640][2938:2943] CHIP:DMG:                         {
          [1657884643.152722][2938:2943] CHIP:DMG:                                 DataVersion = 0xe411d149,
          [1657884643.152809][2938:2943] CHIP:DMG:                                 AttributePathIB =
          [1657884643.152898][2938:2943] CHIP:DMG:                                 {
          [1657884643.152989][2938:2943] CHIP:DMG:                                         Endpoint = 0x0,
          [1657884643.153069][2938:2943] CHIP:DMG:                                         Cluster = 0x28,
          [1657884643.153134][2938:2943] CHIP:DMG:                                         Attribute = 0x0000_0010,
          [1657884643.153282][2938:2943] CHIP:DMG:                                 }
          [1657884643.153349][2938:2943] CHIP:DMG:
          [1657884643.153412][2938:2943] CHIP:DMG:                                 Data = true,
          [1657884643.153471][2938:2943] CHIP:DMG:                         },
          [1657884643.153529][2938:2943] CHIP:DMG:
          [1657884643.153576][2938:2943] CHIP:DMG:                 },
          [1657884643.153631][2938:2943] CHIP:DMG:
          [1657884643.153675][2938:2943] CHIP:DMG:         ],
          [1657884643.153731][2938:2943] CHIP:DMG:
          [1657884643.153776][2938:2943] CHIP:DMG:         InteractionModelRevision = 1
          [1657884643.153821][2938:2943] CHIP:DMG: }
          [1657884643.153988][2938:2943] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_0028 Attribute 0x0000_0010 DataVersion: 3826372937
          [1657884643.154049][2938:2943] CHIP:TOO:   LocalConfigDisabled: TRUE
          [1657884643.154117][2938:2943] CHIP:DMG: MoveToState ReadClient[0xffffa40064f0]: Moving to [AwaitingSu]
          [1657884643.154200][2938:2943] CHIP:EM: Piggybacking Ack for MessageCounter:137911473 on exchange: 45825i
          [1657884643.154295][2938:2943] CHIP:IN: Prepared secure message 0xffffa4000d48 to 0x0000000000000001 (1)  of type 0x1 and protocolId (0, 1) on exchange 45825i with MessageCounter:83158082.
          [1657884643.154361][2938:2943] CHIP:IN: Sending encrypted msg 0xffffa4000d48 with MessageCounter:83158082 to 0x0000000000000001 (1) at monotonic time: 0000000000701C2A msec
          [1657884643.155638][2938:2943] CHIP:EM: Received message of type 0x4 with protocolId (0, 1) and MessageCounter:137911474 on exchange 45825i
          [1657884643.155696][2938:2943] CHIP:EM: Found matching exchange: 45825i, Delegate: 0xffffa40064f0
          [1657884643.155750][2938:2943] CHIP:EM: Rxd Ack; Removing MessageCounter:83158082 from Retrans Table on exchange 45825i
          [1657884643.155794][2938:2943] CHIP:EM: Removed CHIP MessageCounter:83158082 from RetransTable on exchange 45825i
          [1657884643.155865][2938:2943] CHIP:DMG: SubscribeResponseMessage =
          [1657884643.155913][2938:2943] CHIP:DMG: {
          [1657884643.155957][2938:2943] CHIP:DMG:         SubscriptionId = 0x2e0592e3,
          [1657884643.156005][2938:2943] CHIP:DMG:         MaxInterval = 0x64,
          [1657884643.156051][2938:2943] CHIP:DMG:         InteractionModelRevision = 1
          [1657884643.156093][2938:2943] CHIP:DMG: }
          [1657884643.156176][2938:2943] CHIP:DMG: Subscription established with SubscriptionID = 0x2e0592e3 MinInterval = 10s MaxInterval = 100s Peer = 01:0000000000000001
      disabled: true

    - label:
          "[OPTIONAL] Activate the subscription between the DUT and the TH for
          an attribute of data type string. Modify that attribute on the TH. TH
          should send the modified data to the DUT. Modify the attribute
          multiple times (3 times)."
      PICS: MCORE.IDM.C.SubscribeRequest.Attribute.DataType_String
      verification: |
          Product maker needs to provide instructions for how to trigger the command on the DUT. For comparison, the DUT behavior for this test step can be simulated using chip-tool (when DUT is a commissioner/Client)

           Please use Interactive mode to Verify subscription test cases
          Here the command to enter interactive mode:--   ./chip-tool interactive start
          In the case of chip tool as a client, here is an example command the client can write an attribute in the basic cluster in the TH to change the value that the client subscribed in the above command.


           Please use Interactive mode to Verify subscription test cases
          Here the command to enter interactive mode:--   ./chip-tool interactive start

          basicinformation subscribe node-label 30 200  1 0

          On TH (On the reference app) Verify if DUT is responding with the below status response for the above command

          [1657446489.135811][11525:11525] CHIP:EM: Removed CHIP MessageCounter:79424307 from RetransTable on exchange 25r
          [1657446489.135889][11525:11525] CHIP:DMG: StatusResponseMessage =
          [1657446489.135938][11525:11525] CHIP:DMG: {
          [1657446489.135982][11525:11525] CHIP:DMG:      Status = 0x00 (SUCCESS),
          [1657446489.136036][11525:11525] CHIP:DMG:      InteractionModelRevision = 1
          [1657446489.136080][11525:11525] CHIP:DMG: }
          [1657446489.136123][11525:11525] CHIP:IM: Received status response, status is 0x00 (SUCCESS)




          In the case of chip tool as a client, here is an example command the client can write an attribute in the basic cluster in the TH to change the value that the client subscribed in the above command.


           basicinformation write node-label label 1 0

          On TH (On the reference app) Verify if DUT is responding with the below status response for the above command
          [1657446721.226280][11525:11525] CHIP:DMG: StatusResponseMessage =
          [1657446721.226345][11525:11525] CHIP:DMG: {
          [1657446721.226431][11525:11525] CHIP:DMG:      Status = 0x00 (SUCCESS),
          [1657446721.226493][11525:11525] CHIP:DMG:      InteractionModelRevision = 1
          [1657446721.226569][11525:11525] CHIP:DMG: }
          [1657446721.226628][11525:11525] CHIP:IM: Received status response, status is 0x00 (SUCCESS)
          [1657446721.226711][11525:11525] CHIP:DMG: <RE> OnReportConfirm: NumReports = 0
          [1657446721.226773][11525:11525] CHIP:DMG: IM RH moving to [GeneratingReports]


          If the DUT has to provision to verify the logs,  verify that TH all-clusters-app sent Subscription report with unic subscriptionID
          [1657884902.175205][2938:2943] CHIP:DMG: ReportDataMessage =
          [1657884902.175255][2938:2943] CHIP:DMG: {
          [1657884902.175299][2938:2943] CHIP:DMG:         SubscriptionId = 0x6a6457a1,
          [1657884902.175343][2938:2943] CHIP:DMG:         AttributeReportIBs =
          [1657884902.175399][2938:2943] CHIP:DMG:         [
          [1657884902.175444][2938:2943] CHIP:DMG:                 AttributeReportIB =
          [1657884902.175509][2938:2943] CHIP:DMG:                 {
          [1657884902.175560][2938:2943] CHIP:DMG:                         AttributeDataIB =
          [1657884902.175615][2938:2943] CHIP:DMG:                         {
          [1657884902.175674][2938:2943] CHIP:DMG:                                 DataVersion = 0xe411d14c,
          [1657884902.175733][2938:2943] CHIP:DMG:                                 AttributePathIB =
          [1657884902.175798][2938:2943] CHIP:DMG:                                 {
          [1657884902.175866][2938:2943] CHIP:DMG:                                         Endpoint = 0x0,
          [1657884902.175936][2938:2943] CHIP:DMG:                                         Cluster = 0x28,
          [1657884902.176007][2938:2943] CHIP:DMG:                                         Attribute = 0x0000_0005,
          [1657884902.176067][2938:2943] CHIP:DMG:                                 }
          [1657884902.176147][2938:2943] CHIP:DMG:
          [1657884902.176215][2938:2943] CHIP:DMG:                                 Data = label,
          [1657884902.176265][2938:2943] CHIP:DMG:                         },
          [1657884902.176322][2938:2943] CHIP:DMG:
          [1657884902.176369][2938:2943] CHIP:DMG:                 },
          [1657884902.176424][2938:2943] CHIP:DMG:
          [1657884902.176467][2938:2943] CHIP:DMG:         ],
          [1657884902.176522][2938:2943] CHIP:DMG:
          [1657884902.176568][2938:2943] CHIP:DMG:         InteractionModelRevision = 1
          [1657884902.176610][2938:2943] CHIP:DMG: }
          [1657884902.176771][2938:2943] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_0028 Attribute 0x0000_0005 DataVersion: 3826372940
          [1657884902.176833][2938:2943] CHIP:TOO:   NodeLabel: label
          [1657884902.176910][2938:2943] CHIP:DMG: Refresh LivenessCheckTime for 225000 milliseconds with SubscriptionId = 0x6a6457a1 Peer = 01:0000000000000001

          Verify the above command multiple times by changing attribute value(3 times)
      disabled: true

    - label:
          "[OPTIONAL] Activate the subscription between the DUT and the TH for
          an attribute of data type unsigned integer. Modify that attribute on
          the TH. TH should send the modified data to the DUT. Modify the
          attribute multiple times (3 times)."
      PICS: MCORE.IDM.C.SubscribeRequest.Attribute.DataType_UnsignedInteger
      verification: |
          Product maker needs to provide instructions for how to trigger the command on the DUT. For comparison, the DUT behavior for this test step can be simulated using chip-tool (when DUT is a commissioner/Client)

           Please use Interactive mode to Verify subscription test cases
          Here the command to enter interactive mode:--   ./chip-tool interactive start

          any subscribe-by-id 0x0008 0x0010 10 100  1 1
          Verify on the TH(reference-app) that the status response received from the DUT for every report data sent is a "Success"
          [1657448410.108491][11525:11525] CHIP:EM: Removed CHIP MessageCounter:11055857 from RetransTable on exchange 33616r
          [1657448410.108543][11525:11525] CHIP:DMG: StatusResponseMessage =
          [1657448410.108571][11525:11525] CHIP:DMG: {
          [1657448410.108595][11525:11525] CHIP:DMG:      Status = 0x00 (SUCCESS),
          [1657448410.108626][11525:11525] CHIP:DMG:      InteractionModelRevision = 1
          [1657448410.108650][11525:11525] CHIP:DMG: }
          [1657448410.108674][11525:11525] CHIP:IM: Received status response, status is 0x00 (SUCCESS)

          On DUT as a client side, verify that TH all-clusters-app sent Subscription report with unic subscriptionID
          [1657884929.244585][2938:2943] CHIP:DMG: ReportDataMessage =
          [1657884929.244654][2938:2943] CHIP:DMG: {
          [1657884929.244716][2938:2943] CHIP:DMG:         SubscriptionId = 0x6cee9660,
          [1657884929.244791][2938:2943] CHIP:DMG:         AttributeReportIBs =
          [1657884929.244873][2938:2943] CHIP:DMG:         [
          [1657884929.244935][2938:2943] CHIP:DMG:                 AttributeReportIB =
          [1657884929.245032][2938:2943] CHIP:DMG:                 {
          [1657884929.245098][2938:2943] CHIP:DMG:                         AttributeDataIB =
          [1657884929.245170][2938:2943] CHIP:DMG:                         {
          [1657884929.245245][2938:2943] CHIP:DMG:                                 DataVersion = 0xccfe0684,
          [1657884929.245319][2938:2943] CHIP:DMG:                                 AttributePathIB =
          [1657884929.245395][2938:2943] CHIP:DMG:                                 {
          [1657884929.245474][2938:2943] CHIP:DMG:                                         Endpoint = 0x1,
          [1657884929.245556][2938:2943] CHIP:DMG:                                         Cluster = 0x8,
          [1657884929.245638][2938:2943] CHIP:DMG:                                         Attribute = 0x0000_0010,
          [1657884929.245696][2938:2943] CHIP:DMG:                                 }
          [1657884929.245773][2938:2943] CHIP:DMG:
          [1657884929.245841][2938:2943] CHIP:DMG:                                 Data = 1,
          [1657884929.245897][2938:2943] CHIP:DMG:                         },
          [1657884929.245955][2938:2943] CHIP:DMG:
          [1657884929.246003][2938:2943] CHIP:DMG:                 },
          [1657884929.246059][2938:2943] CHIP:DMG:
          [1657884929.246104][2938:2943] CHIP:DMG:         ],
          [1657884929.246160][2938:2943] CHIP:DMG:
          [1657884929.246207][2938:2943] CHIP:DMG:         InteractionModelRevision = 1
          [1657884929.246252][2938:2943] CHIP:DMG: }
          [1657884929.246416][2938:2943] CHIP:TOO: Endpoint: 1 Cluster: 0x0000_0008 Attribute 0x0000_0010 DataVersion: 3439199876
          [1657884929.246496][2938:2943] CHIP:TOO:   on off transition time: 0
          [1657884929.246565][2938:2943] CHIP:DMG: MoveToState ReadClient[0xffffa40064f0]: Moving to [AwaitingSu]
          [1657884929.246666][2938:2943] CHIP:EM: Piggybacking Ack for MessageCounter:137911484 on exchange: 45830i
          [1657884929.246777][2938:2943] CHIP:IN: Prepared secure message 0xffffa4000db8 to 0x0000000000000001 (1)  of type 0x1 and protocolId (0, 1) on exchange 45830i with MessageCounter:83158096.
          [1657884929.246851][2938:2943] CHIP:IN: Sending encrypted msg 0xffffa4000db8 with MessageCounter:83158096 to 0x0000000000000001 (1) at monotonic time: 00000000007479B6 msec
          [1657884929.248540][2938:2943] CHIP:EM: Received message of type 0x4 with protocolId (0, 1) and MessageCounter:137911485 on exchange 45830i
          [1657884929.248614][2938:2943] CHIP:EM: Found matching exchange: 45830i, Delegate: 0xffffa40064f0
          [1657884929.248678][2938:2943] CHIP:EM: Rxd Ack; Removing MessageCounter:83158096 from Retrans Table on exchange 45830i
          [1657884929.248724][2938:2943] CHIP:EM: Removed CHIP MessageCounter:83158096 from RetransTable on exchange 45830i
          [1657884929.248809][2938:2943] CHIP:DMG: SubscribeResponseMessage =
          [1657884929.248858][2938:2943] CHIP:DMG: {
          [1657884929.248904][2938:2943] CHIP:DMG:         SubscriptionId = 0x6cee9660,
          [1657884929.248953][2938:2943] CHIP:DMG:         MaxInterval = 0x64,
          [1657884929.249003][2938:2943] CHIP:DMG:         InteractionModelRevision = 1
          [1657884929.249047][2938:2943] CHIP:DMG: }
          [1657884929.249098][2938:2943] CHIP:DMG: Subscription established with SubscriptionID = 0x6cee9660 MinInterval = 10s MaxInterval = 100s Peer = 01:0000000000000001

          In the case of chip tool as a client, here is an example command the client can write an attribute in the basic cluster in the TH to change the value that the client subscribed in the above command.



          In the case of chip tool as a client, here is an example command the client can write an attribute in the basic cluster in the TH to change the value that the client subscribed in the above command.

            any write-by-id 0x0008 0x0010 1 1 1

          [1657448453.234310][11525:11525] CHIP:EM: Removed CHIP MessageCounter:11055860 from RetransTable on exchange 8514i
          [1657448453.234372][11525:11525] CHIP:DMG: StatusResponseMessage =
          [1657448453.234409][11525:11525] CHIP:DMG: {
          [1657448453.234442][11525:11525] CHIP:DMG:      Status = 0x00 (SUCCESS),
          [1657448453.234478][11525:11525] CHIP:DMG:      InteractionModelRevision = 1
          [1657448453.234510][11525:11525] CHIP:DMG: }
          [1657448453.234542][11525:11525] CHIP:IM: Received status response, status is 0x00 (SUCCESS)
          [1657448453.234577][11525:11525] CHIP:DMG: <RE> OnReportConfirm: NumReports = 0



          If the DUT has to provision to verify the logs, , verify that TH all-clusters-app sent Subscription report with unic subscriptionID
          [1657884955.073466][2938:2943] CHIP:DMG: ReportDataMessage =
          [1657884955.073516][2938:2943] CHIP:DMG: {
          [1657884955.073562][2938:2943] CHIP:DMG:         SubscriptionId = 0x6cee9660,
          [1657884955.073608][2938:2943] CHIP:DMG:         AttributeReportIBs =
          [1657884955.073666][2938:2943] CHIP:DMG:         [
          [1657884955.073711][2938:2943] CHIP:DMG:                 AttributeReportIB =
          [1657884955.073770][2938:2943] CHIP:DMG:                 {
          [1657884955.073818][2938:2943] CHIP:DMG:                         AttributeDataIB =
          [1657884955.073882][2938:2943] CHIP:DMG:                         {
          [1657884955.073943][2938:2943] CHIP:DMG:                                 DataVersion = 0xccfe0685,
          [1657884955.074003][2938:2943] CHIP:DMG:                                 AttributePathIB =
          [1657884955.074064][2938:2943] CHIP:DMG:                                 {
          [1657884955.074128][2938:2943] CHIP:DMG:                                         Endpoint = 0x1,
          [1657884955.074199][2938:2943] CHIP:DMG:                                         Cluster = 0x8,
          [1657884955.074263][2938:2943] CHIP:DMG:                                         Attribute = 0x0000_0010,
          [1657884955.074329][2938:2943] CHIP:DMG:                                 }
          [1657884955.074393][2938:2943] CHIP:DMG:
          [1657884955.074455][2938:2943] CHIP:DMG:                                 Data = 1,
          [1657884955.074512][2938:2943] CHIP:DMG:                         },
          [1657884955.074574][2938:2943] CHIP:DMG:
          [1657884955.074625][2938:2943] CHIP:DMG:                 },
          [1657884955.074684][2938:2943] CHIP:DMG:
          [1657884955.074732][2938:2943] CHIP:DMG:         ],
          [1657884955.074788][2938:2943] CHIP:DMG:
          [1657884955.074833][2938:2943] CHIP:DMG:         InteractionModelRevision = 1
          [1657884955.074877][2938:2943] CHIP:DMG: }
          [1657884955.075032][2938:2943] CHIP:TOO: Endpoint: 1 Cluster: 0x0000_0008 Attribute 0x0000_0010 DataVersion: 3439199877
          [1657884955.075095][2938:2943] CHIP:TOO:   on off transition time: 1
          [1657884955.075170][2938:2943] CHIP:DMG: Refresh LivenessCheckTime for 125000 milliseconds with SubscriptionId = 0x6cee9660 Peer = 01:0000000000000001


          Verify the above command multiple times by changing attribute value(3 times)
      disabled: true

    - label:
          "[OPTIONAL] Activate the subscription between the DUT and the TH for
          an attribute of data type signed integer. Modify that attribute on the
          TH. TH should send the modified data to the DUT. Modify the attribute
          multiple times (3 times)"
      PICS: MCORE.IDM.C.SubscribeRequest.Attribute.DataType_Integer
      verification: |
          DUT implementation required to verify subscribe an attribute of data type signed integer


          If the Vendor DUT doesn"t implement/supported this attribute, Please mark the test step as "Not Applicable"
      disabled: true

    - label:
          "[OPTIONAL] Activate the subscription between the DUT and the TH for
          an attribute of data type Floating Point. Modify that attribute on the
          TH. TH should send the modified data to the DUT. Modify the attribute
          multiple times (3 times)"
      PICS: MCORE.IDM.C.SubscribeRequest.Attribute.DataType_FloatingPoint
      verification: |
          DUT implementation required to verify subscribe an attribute of data type floating point



          If the Vendor DUT doesn"t implement/supported this attribute, Please mark the test step as "Not Applicable"
      disabled: true

    - label:
          "[OPTIONAL] Activate the subscription between the DUT and the TH for
          an attribute of data type list. Modify that attribute on the TH. TH
          should send the modified data to the DUT. Modify the attribute
          multiple times (3 times)"
      PICS: MCORE.IDM.C.SubscribeRequest.Attribute.DataType_List
      verification: |
          DUT implementation required to verify subscribe and list an attribute of data type list



          If the Vendor DUT doesn"t implement/supported this attribute, Please mark the test step as "Not Applicable"
      disabled: true

    - label:
          "Activate the subscription between the DUT and the TH for an
          attribute. Force the TH to not send any report data for the duration
          of the maximum interval. After the maximum interval, TH sends a report
          data with the subscription id created during the subscription
          activation."
      PICS: MCORE.IDM.C.SubscribeRequest
      verification: |
          Out of scope for V1.0
      disabled: true

    - label:
          "DUT sends a subscription request message to the target node/reference
          device for multiple attributes(3 attributes)."
      PICS: MCORE.IDM.C.SubscribeRequest.MultipleAttributes
      verification: |
          Product maker needs to provide instructions for how to trigger the command on the DUT. For comparison, the DUT behavior for this test step can be simulated using chip-tool (when DUT is a commissioner/Client)

           Please use Interactive mode to Verify subscription test cases
          Here the command to enter interactive mode:--   ./chip-tool interactive start
          any subscribe-by-id '6,8,3' '0,1,0' 10 100 1 '1,1,1'

          On the TH(reference device)  verify the subscription request message received has the following fields.
          KeepSubscriptions which is of type bool
          MinIntervalFloor which is of type uint16
          MaxIntervalCeiling which is of type uint16
          AttributeRequests which is of type list and contains the paths for the 3 attributes.
          DataVersionFilters which is of type list and contains the data versions of the attributes requested.
          [Optional]EventRequests which is of type list
          [Optional]EventFilters which is of type list FabricFiltered which is of type bool

          [1657449168.663911][11525:11525] CHIP:EM: Handling via exchange: 33620r, Delegate: 0xaaaae00c1430
          [1657449168.664027][11525:11525] CHIP:IM: Received Subscribe request
          [1657449168.664216][11525:11525] CHIP:IM: Deleting previous subscription from NodeId: 000000000001B669, FabricIndex: 1
          [1657449168.664345][11525:11525] CHIP:DMG: SubscribeRequestMessage =
          [1657449168.664408][11525:11525] CHIP:DMG: {
          [1657449168.664467][11525:11525] CHIP:DMG:      KeepSubscriptions = false,
          [1657449168.664532][11525:11525] CHIP:DMG:      MinIntervalFloorSeconds = 0xa,
          [1657449168.664597][11525:11525] CHIP:DMG:      MaxIntervalCeilingSeconds = 0x64,
          [1657449168.664658][11525:11525] CHIP:DMG:      AttributePathIBs =
          [1657449168.664722][11525:11525] CHIP:DMG:      [
          [1657449168.664782][11525:11525] CHIP:DMG:              AttributePathIB =
          [1657449168.664848][11525:11525] CHIP:DMG:              {
          [1657449168.664916][11525:11525] CHIP:DMG:                      Endpoint = 0x1,
          [1657449168.664993][11525:11525] CHIP:DMG:                      Cluster = 0x6,
          [1657449168.665074][11525:11525] CHIP:DMG:                      Attribute = 0x0000_0000,
          [1657449168.665149][11525:11525] CHIP:DMG:              }
          [1657449168.665225][11525:11525] CHIP:DMG:
          [1657449168.665289][11525:11525] CHIP:DMG:              AttributePathIB =
          [1657449168.665353][11525:11525] CHIP:DMG:              {
          [1657449168.665420][11525:11525] CHIP:DMG:                      Endpoint = 0x1,
          [1657449168.665495][11525:11525] CHIP:DMG:                      Cluster = 0x8,
          [1657449168.665573][11525:11525] CHIP:DMG:                      Attribute = 0x0000_0001,
          [1657449168.665646][11525:11525] CHIP:DMG:              }
          [1657449168.665721][11525:11525] CHIP:DMG:
          [1657449168.665783][11525:11525] CHIP:DMG:              AttributePathIB =
          [1657449168.665847][11525:11525] CHIP:DMG:              {
          [1657449168.665913][11525:11525] CHIP:DMG:                      Endpoint = 0x1,
          [1657449168.665988][11525:11525] CHIP:DMG:                      Cluster = 0x3,
          [1657449168.666073][11525:11525] CHIP:DMG:                      Attribute = 0x0000_0000,
          [1657449168.666152][11525:11525] CHIP:DMG:              }
          [1657449168.666225][11525:11525] CHIP:DMG:
          [1657449168.666286][11525:11525] CHIP:DMG:      ],
          [1657449168.666362][11525:11525] CHIP:DMG:
          [1657449168.666427][11525:11525] CHIP:DMG:      isFabricFiltered = true,
          [1657449168.666488][11525:11525] CHIP:DMG:      InteractionModelRevision = 1
          [1657449168.666545][11525:11525] CHIP:DMG: },
          [1657449168.666762][11525:11525] CHIP:DMG: Final negotiated min/max parameters: Min = 10s, Max = 100s

          [1657449168.674140][11525:11525] CHIP:EM: Removed CHIP MessageCounter:11055871 from RetransTable on exchange 33620r
          [1657449168.674191][11525:11525] CHIP:DMG: StatusResponseMessage =
          [1657449168.674220][11525:11525] CHIP:DMG: {
          [1657449168.674246][11525:11525] CHIP:DMG:      Status = 0x00 (SUCCESS),
          [1657449168.674273][11525:11525] CHIP:DMG:      InteractionModelRevision = 1
          [1657449168.674297][11525:11525] CHIP:DMG: }
          [1657449168.674324][11525:11525] CHIP:IM: Received status response, status is 0x00 (SUCCESS)
          [1657449168.674365][11525:11525] CHIP:DMG: Refresh Subscribe Sync Timer with max 100 seconds



          If the DUT has to provision to verify the logs,  verify that TH all-clusters-app sent Subscription report with unic subscriptionID
          [1662036515.630221][166451:166456] CHIP:DMG: }
          [1662036515.630284][166451:166456] CHIP:TOO: Endpoint: 1 Cluster: 0x0000_0003 Attribute 0x0000_0000 DataVersion: 3175537504
          [1662036515.630298][166451:166456] CHIP:TOO:   identify time: 0
          [1662036515.630329][166451:166456] CHIP:TOO: Endpoint: 1 Cluster: 0x0000_0008 Attribute 0x0000_0001 DataVersion: 3999635638
          [1662036515.630338][166451:166456] CHIP:TOO:   RemainingTime: 0
          [1662036515.630366][166451:166456] CHIP:TOO: Endpoint: 1 Cluster: 0x0000_0006 Attribute 0x0000_0000 DataVersion: 2488235261
          [1662036515.630375][166451:166456] CHIP:TOO:   OnOff: FALSE
          [1662036515.630396][166451:166456] CHIP:DMG: MoveToState ReadClient[0x7fee1c024260]: Moving to [AwaitingSu]
          [1662036515.630416][166451:166456] CHIP:EM: Piggybacking Ack for MessageCounter:196351589 on exchange: 20857i
      disabled: true
