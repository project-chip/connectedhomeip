# Copyright (c) 2021 Project CHIP Authors
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# Auto-generated scripts for harness use only, please review before automation. The endpoints and cluster names are currently set to default

name:
    3.2.1. [TC-OPCREDS-3.1] Attribute-NOCs, TrustedRootCertificates list
    validation [DUT-Server]

PICS:
    - OPCREDS.S

config:
    nodeId: 0x12344321
    cluster: "Basic"
    endpoint: 0

tests:
    - label:
          "Factory Reset DUT (to ensure NOC list is empty at the beginning of
          the following steps)"
      PICS: OPCREDS.S.A0000
      verification: |
          On both DUT and TH side
          sudo rm -rf /tmp/chip_*
      disabled: true

    - label: "Start the commissioning process of DUT by TH1 on a first Fabric"
      verification: |
          DUT side:
          sudo ./chip-all-clusters-app --wifi

          TH side:
          ./chip-tool pairing ble-wifi 1 zigbeehome matter123 20202021 3841 --trace_decode 1

          [1650455358.501816][4366:4371] CHIP:TOO: Device commissioning completed with success
      disabled: true

    - label:
          "TH1 sends ArmFailSafe command to the DUT with the ExpiryLengthSeconds
          field set to 900"
      PICS: CGEN.S.C00.Rsp && CGEN.S.C01.Tx
      verification: |
          ./chip-tool generalcommissioning arm-fail-safe 900 600 1 0


          Verify the ErrorCode as "OK"(0) in TH log
          [1659676500.031926][2475:2480] CHIP:DMG: Received Command Response Data, Endpoint=0 Cluster=0x0000_0030 Command=0x0000_0001
          [1659676500.047646][2475:2480] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_0030 Command 0x0000_0001
          [1659676500.055459][2475:2480] CHIP:TOO:   ArmFailSafeResponse: {
          [1659676500.055613][2475:2480] CHIP:TOO:     errorCode: 0
          [1659676500.055669][2475:2480] CHIP:TOO:     debugText:
          [1659676500.055719][2475:2480] CHIP:TOO:    }
          [1659676500.055806][2475:2480] CHIP:DMG: ICR moving to [AwaitingDe]
          [1659676500.055920][2475:2480] CHIP:EM: Sending Standalone Ack for MessageCounter:225116044 on exchange 37810i
      disabled: true

    - label: "TH1 sends SetRegulatoryConfig command to the DUT"
      PICS: CGEN.S.C02.Rsp && CGEN.S.C03.Tx
      verification: |
          Verify TH log during commissioning

          [1655468537.763350][13015:13020] CHIP:DMG: DAC/PAI (463) =
          [1655468537.763466][13015:13020] CHIP:DMG: {
          -----BEGIN CERTIFICATE-----
          MIIByzCCAXGgAwIBAgIIVq2CIq2UW2QwCgYIKoZIzj0EAwIwMDEYMBYGA1UEAwwP
          TWF0dGVyIFRlc3QgUEFBMRQwEgYKKwYBBAGConwCAQwERkZGMTAgFw0yMjAyMDUw
          MDAwMDBaGA85OTk5MTIzMTIzNTk1OVowPTElMCMGA1UEAwwcTWF0dGVyIERldiBQ
          QUkgMHhGRkYxIG5vIFBJRDEUMBIGCisGAQQBgqJ8AgEMBEZGRjEwWTATBgcqhkjO
          PQIBBggqhkjOPQMBBwNCAARBmpMVwhc+DIyHbQPM/JRIUmR/f+xeUIL0BZko7KiU
          xZQVEwmsYx5MsDOSr2hLC6+35ls7gWLC9Sv5MbjneqqCo2YwZDASBgNVHRMBAf8E
          CDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBBjAdBgNVHQ4EFgQUY1QOR/ZLHDjROISk
          YtFsGV2P+zwwHwYDVR0jBBgwFoAUav0idx9RH+y/FkGXZxDc3DGhcX4wCgYIKoZI
          zj0EAwIDSAAwRQIhALLvJ/Sa6bUPuR7qyUxNC9u415KcbLiPrOUpNo0SBUwMAiBl
          Xckrhr2QmIKmxiF3uCXX0F7b58Ivn+pxIg5+pwP4kQ==
          -----END CERTIFICATE-----
      disabled: true

    - label: "TH1 sends AttestationRequest command to DUT"
      PICS: OPCREDS.S.C00.Rsp && OPCREDS.S.C01.Tx
      verification: |
          Verify below data is less or equal to 600 bytes

          Verify attestation response in TH Log

          [1658223434.718871][5712:5717] CHIP:DMG: Received Command Response Data, Endpoint=0 Cluster=0x0000_003E Command=0x0000_0001
          [1658223434.718921][5712:5717] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Command 0x0000_0001
          [1658223434.718981][5712:5717] CHIP:TOO:   AttestationResponse: {
          [1658223434.719026][5712:5717] CHIP:TOO:     attestationElements: 1531011D023082021906092A864886F70D010702A082020A30820206020103310D300B06096086480165030402013082017106092A864886F70D010701A08201620482015E152400012501F1FF3602050080050180050280050380050480050580050680050780050880050980050A80050B80050C80050D80050E80050F80051080051180051280051380051480051580051680051780051880051980051A80051B80051C80051D80051E80051F80052080052180052280052380052480052580052680052780052880052980052A80052B80052C80052D80052E80052F80053080053180053280053380053480053580053680053780053880053980053A80053B80053C80053D80053E80053F80054080054180054280054380054480054580054680054780054880054980054A80054B80054C80054D80054E80054F80055080055180055280055380055480055580055680055780055880055980055A80055B80055C80055D80055E80055F80056080056180056280056380182403162C04135A494732303134325A423333303030332D3234240500240600250794
          [1658223434.719078][5712:5717] CHIP:TOO:     ...................: 2624080018317D307B020103801462FA823359ACFAA9963E1CFA140ADDF504F37160300B0609608648016503040201300A06082A8648CE3D04030204473045022024E5D1F47A7D7B0D206A26EF699B7C9757B72D469089DE3192E678C745E7F60C022100F8AA2FA711FCB79B97E397CEDA667BAE464E2BD3FFDFC3CCED7AA8CA5F4C1A7C3002203577CA6EFFFC560E287604663AE5BE2F11D1B1CF99BE326AF5B3B114A2E9139524030018
          [1658223434.719110][5712:5717] CHIP:TOO:     signature: 7E18271F57FFC60492CA74943FC897493FB2FECDD4A4DC9F2AD348AAD1F5C57DAEB144A4D1C79419386C746F28AC145F3185C64AD99DD829EE70C3690D29642D
          [1658223434.719135][5712:5717] CHIP:TOO:    }
      disabled: true

    - label:
          "TH1 sends CertificateChainRequest Command to DUT for the PAI and
          saves the certififate as PAICert"
      PICS: OPCREDS.S.C02.Rsp && OPCREDS.S.C03.Tx
      verification: |
          ./chip-tool operationalcredentials certificate-chain-request 2 1 0

          Verify the CertificateChainResponse and verify that the size of certificate is less than or equal to 600 bytes and of type octstr in TH Log

          [1658223566.816155][5951:5956] CHIP:DMG: Received Command Response Data, Endpoint=0 Cluster=0x0000_003E Command=0x0000_0003
          [1658223566.816246][5951:5956] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Command 0x0000_0003
          [1658223566.816346][5951:5956] CHIP:TOO:   CertificateChainResponse: {
          [1658223566.816403][5951:5956] CHIP:TOO:     certificate: 308201CB30820171A003020102020856AD8222AD945B64300A06082A8648CE3D04030230303118301606035504030C0F4D617474657220546573742050414131143012060A2B0601040182A27C02010C04464646313020170D3232303230353030303030305A180F39393939313233313233353935395A303D3125302306035504030C1C4D6174746572204465762050414920307846464631206E6F2050494431143012060A2B0601040182A27C02010C04464646313059301306072A8648CE3D020106082A8648CE3D03010703420004419A9315C2173E0C8C876D03CCFC944852647F7FEC5E5082F4059928ECA894C594151309AC631E4CB03392AF684B0BAFB7E65B3B8162C2F52BF931B8E77AAA82A366306430120603551D130101FF040830060101FF020100300E0603551D0F0101FF040403020106301D0603551D0E0416041463540E47F64B1C38D13884A462D16C195D8FFB3C301F0603551D230418301680146AFD22771F511FECBF1641976710DCDC31A1717E300A06082A8648CE3D0403020348003045022100B2EF27F49AE9B50FB91EEAC94C4D0BDBB8D7929C6C
          [1658223566.816475][5951:5956] CHIP:TOO:     ...........: B88FACE529368D12054C0C0220655DC92B86BD909882A6C62177B825D7D05EDBE7C22F9FEA71220E7EA703F891
          [1658223566.816510][5951:5956] CHIP:TOO:    }

          Verify the size of certificate is less than or equal to 600 bytes and of type octstr from the above log

          Example :
          308201CB30820171A003020102020856AD8222AD945B64300A06082A8648CE3D04030230303118301606035504030C0F4D617474657220546573742050414131143012060A2B0601040182A27C02010C04464646313020170D3232303230353030303030305A180F39393939313233313233353935395A303D3125302306035504030C1C4D6174746572204465762050414920307846464631206E6F2050494431143012060A2B0601040182A27C02010C04464646313059301306072A8648CE3D020106082A8648CE3D03010703420004419A9315C2173E0C8C876D03CCFC944852647F7FEC5E5082F4059928ECA894C594151309AC631E4CB03392AF684B0BAFB7E65B3B8162C2F52BF931B8E77AAA82A366306430120603551D130101FF040830060101FF020100300E0603551D0F0101FF040403020106301D0603551D0E0416041463540E47F64B1C38D13884A462D16C195D8FFB3C301F0603551D230418301680146AFD22771F511FECBF1641976710DCDC31A1717E300A06082A8648CE3D0403020348003045022100B2EF27F49AE9B50FB91EEAC94C4D0BDBB8D7929C6C
      disabled: true

    - label:
          "TH1 sends CertificateChainRequest Command to DUT for the DAC and
          saves the certififate as DACCert"
      PICS: OPCREDS.S.C02.Rsp && OPCREDS.S.C03.Tx
      verification: |
          ./chip-tool operationalcredentials certificate-chain-request 1 1 0

          Verify the CertificateChainResponse in TH Log

          [1658223537.868606][5857:5862] CHIP:DMG: Received Command Response Data, Endpoint=0 Cluster=0x0000_003E Command=0x0000_0003
          [1658223537.868656][5857:5862] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Command 0x0000_0003
          [1658223537.868716][5857:5862] CHIP:TOO:   CertificateChainResponse: {
          [1658223537.868762][5857:5862] CHIP:TOO:     certificate: 308201E73082018EA003020102020869CDF10DE9E54ED1300A06082A8648CE3D040302303D3125302306035504030C1C4D6174746572204465762050414920307846464631206E6F2050494431143012060A2B0601040182A27C02010C04464646313020170D3232303230353030303030305A180F39393939313233313233353935395A30533125302306035504030C1C4D61747465722044657620444143203078464646312F30783830303131143012060A2B0601040182A27C02010C044646463131143012060A2B0601040182A27C02020C04383030313059301306072A8648CE3D020106082A8648CE3D03010703420004463AC69342910A0E5588FC6FF56BB63E62ECCECB148F7D4EB03EE552601415767D16A5C663F793E49123260B8297A7CD7E7CFC7B316B39D98E90D29377738E82A360305E300C0603551D130101FF04023000300E0603551D0F0101FF040403020780301D0603551D0E0416041488DDE7B300382932CFF734C04624810F44168A6F301F0603551D2304183016801463540E47F64B1C38D13884A462D16C195D8FFB3C300A06082A8648CE3D040302
          [1658223537.868809][5857:5862] CHIP:TOO:     ...........: 034700304402200127A27B4B44610EE2FCDC4D2B7885563660BC0F76F17219ED6A08DFB2B3C1CD02206B59E0AF45F3EB2A85B919D35731528C6028C415239545E108E4E54E70971353
          [1658223537.868834][5857:5862] CHIP:TOO:    }

          Verify the size of certificate is less than or equal to 600 bytes and of type octstr from the above log

          Example :
          308201E73082018EA003020102020869CDF10DE9E54ED1300A06082A8648CE3D040302303D3125302306035504030C1C4D6174746572204465762050414920307846464631206E6F2050494431143012060A2B0601040182A27C02010C04464646313020170D3232303230353030303030305A180F39393939313233313233353935395A30533125302306035504030C1C4D61747465722044657620444143203078464646312F30783830303131143012060A2B0601040182A27C02010C044646463131143012060A2B0601040182A27C02020C04383030313059301306072A8648CE3D020106082A8648CE3D03010703420004463AC69342910A0E5588FC6FF56BB63E62ECCECB148F7D4EB03EE552601415767D16A5C663F793E49123260B8297A7CD7E7CFC7B316B39D98E90D29377738E82A360305E300C0603551D130101FF04023000300E0603551D0F0101FF040403020780301D0603551D0E0416041488DDE7B300382932CFF734C04624810F44168A6F301F0603551D2304183016801463540E47F64B1C38D13884A462D16C195D8FFB3C300A06082A8648CE3D040302
      disabled: true

    - label: "TH1 Sends CSRRequest command with a random 32-byte nonce"
      PICS: OPCREDS.S.C04.Rsp
      verification: |
          To get SCR Nonce give below command 2 times
          echo hex:$(hexdump -vn32 -e"4/4 "%08X" " /dev/urandom)

          ./chip-tool operationalcredentials csrrequest hex:A61BFCE6E2C6AAF48FDEC4BF9DCEF08EB65B976997D82BE5F359902982717603 1 0

          Verify the CSRResponse  in TH Log

          [1658223679.580697][6136:6141] CHIP:DMG: Received Command Response Data, Endpoint=0 Cluster=0x0000_003E Command=0x0000_0005
          [1658223679.580761][6136:6141] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Command 0x0000_0005
          [1658223679.580823][6136:6141] CHIP:TOO:   CSRResponse: {
          [1658223679.580875][6136:6141] CHIP:TOO:     NOCSRElements: 153001CB3081C83070020100300E310C300A060355040A0C034353523059301306072A8648CE3D020106082A8648CE3D030107034200047DA16C714034D3B96716F64DC0E742D007233212025E305AF6CE56DFA057718E149E52B39584456C8F954A1596B64F8BBC02E501276B962D4AB2C0A607D983C9A000300A06082A8648CE3D040302034800304502206FB78A61A7B0F021C396FEC1CCD6802129AC3EE5EA2727ABCCB19DBAEA7DEE1A022100A5C81ADC5D8BFAA5DB84A1261D8BBCEA5C26B24D4405F0B978E19B17D8458C9E300220A61BFCE6E2C6AAF48FDEC4BF9DCEF08EB65B976997D82BE5F35990298271760318
          [1658223679.580915][6136:6141] CHIP:TOO:     attestationSignature: EB731B40B20501AF32C468AA522948F7848D3AEDFA24D9A879575B4A265886C97109EE0DE1ECEB969B1A7F98F127DB4C275292B986BF8DA56EF7B16DA8EC8ABE
          [1658223679.580943][6136:6141] CHIP:TOO:    }

          Verify attestation signature is an octstr type and has maximum length of 64

          Example:
          EB731B40B20501AF32C468AA522948F7848D3AEDFA24D9A879575B4A265886C97109EE0DE1ECEB969B1A7F98F127DB4C275292B986BF8DA56EF7B16DA8EC8ABE
      disabled: true

    - label: "TH1 validates the attestation response"
      verification: |
          verification step to be updated.
      disabled: true

    - label:
          "TH1 obtains or generates the NOC, the Root CA Certificate and ICAC
          using the CSR elements from step 8 and selects an IPK. The
          certificates shall have their subjects padded with additional data
          such that they are each the maximum certificate size of 400 bytes when
          encoded in the MatterCertificateEncoding. Save RCAC as
          Root_CA_Certificate_TH1 Save ICAC as Intermediate_Certificate_TH1 Save
          NOC as Node_Operational_Certificate_TH1 Save IPK as IPK_TH1 Extract
          the RCAC public key and save as Root_Public_Key_TH1"
      verification: |
          verification step to be updated.
      disabled: true

    - label:
          "TH1 obtains or generates Root Certificate with a different Root CA ID
          and the corresponding ICAC, NOC and IPK using the CSR elements from
          step 8 Save RCAC as Root_CA_Certificate_TH1_2 Save ICAC as
          Intermediate_Certificate_TH1_2 Save NOC as
          Node_Operational_Certificate_TH1_2 Save IPK as IPK_TH1_2"
      verification: |
          verification step to be updated.
      disabled: true

    - label:
          "TH1 generates an INVALID Root Certificate where the signature does
          not match the public key and saves it as Root_CA_Malformed"
      verification: |
          verification step to be updated.
      disabled: true

    - label:
          "TH1 sends AddTrustedRootCertificate command to DUT to install
          Root_CA_Malformed"
      PICS: OPCREDS.S.C0b.Rsp
      verification: |
          verification step to be updated.
      disabled: true

    - label:
          "TH1 sends AddTrustedRootCertificate command to DUT with
          RootCACertificate set to Root_CA_Certificate_TH1"
      PICS: OPCREDS.S.C0b.Rsp
      verification: |
          1. ./chip-tool generalcommissioning arm-fail-safe 500 600 1 0

          2.  ./chip-tool operationalcredentials  add-trusted-root-certificate 1530010100240201370324140018260480228127260580254D3A370624140018240701240801300941043D96471BD73AAAA423AA3EBA87DE9CC7C0864D46FA5571F4BCC64D3F50453E95C5EDB07713B14D0FD22359A85595C3049E0D2046AF0692691DCC32BC1322830F370A350129011824026030041442E8D59F9829D4E11FEE544E8C89C92774A7E27E30051442E8D59F9829D4E11FEE544E8C89C92774A7E27E18300B402334770CE79AB4EAAAA70B5A07232B9AE0BE0AAA681118552726DCB5B04C7F0382519CA0A7A7D4C498CFB3EE479912832B3618926F4765BA4343D6E691FE238918 1 0


          [1655374218.706390][35023:35028] CHIP:DMG:                         CommandFields =
          [1655374218.706431][35023:35028] CHIP:DMG:                         {
          [1655374218.706464][35023:35028] CHIP:DMG:                                 0x0 = [
          [1655374218.706591][35023:35028] CHIP:DMG:                                         0x15, 0x30, 0x1, 0x1, 0x0, 0x24, 0x2, 0x1, 0x37, 0x3, 0x24, 0x14, 0x0, 0x18, 0x26, 0x4, 0x80, 0x22, 0x81, 0x27, 0x26, 0x5, 0x80, 0x25, 0x4d, 0x3a, 0x37, 0x6, 0x24, 0x14, 0x0, 0x18, 0x24, 0x7, 0x1, 0x24, 0x8, 0x1, 0x30, 0x9, 0x41, 0x4, 0xab, 0xae, 0x5e, 0xc6, 0x4f, 0xc4, 0x6e, 0x99, 0xc, 0x44, 0x55, 0x39, 0x2, 0x45, 0xf6, 0xe9, 0x9, 0xcb, 0xc3, 0xc3, 0xc, 0xa0, 0x8, 0xb7, 0x36, 0x96, 0x62, 0x56, 0x43, 0x56, 0xba, 0x22, 0x25, 0x38, 0x6f, 0x40, 0x50, 0xf8, 0x7b, 0xd1, 0xd7, 0xe4, 0xd6, 0x5c, 0x12, 0x30, 0x84, 0x91, 0xb3, 0x10, 0x8f, 0x6a, 0x71, 0x8, 0xe1, 0xf0, 0xc3, 0xa0, 0xd2, 0x4, 0x99, 0xe3, 0xfb, 0xf, 0x37, 0xa, 0x35, 0x1, 0x29, 0x1, 0x18, 0x24, 0x2, 0x60, 0x30, 0x4, 0x14, 0x89, 0x4f, 0x8f, 0xdd, 0xf2, 0x13, 0x8d, 0x8e, 0xe0, 0x12, 0x13, 0x72, 0xa2, 0xb4, 0x23, 0x25, 0xef, 0xd6, 0x25, 0x8c, 0x30, 0x5, 0x14, 0x89, 0x4f, 0x8f, 0xdd, 0xf2, 0x13, 0x8d, 0x8e, 0xe0, 0x12, 0x13, 0x72, 0xa2, 0xb4, 0x23, 0x25, 0xef, 0xd6, 0x25, 0x8c, 0x18, 0x30, 0xb, 0x40, 0xd3, 0x8f, 0x56, 0xa2, 0xd9, 0xb4, 0x4a, 0x3a, 0x79, 0x6d, 0xed, 0xd7, 0x1c, 0x7a, 0x3e, 0xd6, 0xb9, 0x8d, 0x80, 0xd6, 0x3d, 0xe2, 0xde, 0xa5, 0xb0, 0x3b, 0xc0, 0xce, 0x1a, 0xe9, 0x26, 0x0, 0x9d, 0x9c, 0x78, 0xe4, 0xf3, 0x78, 0x74, 0x3a, 0xd, 0xfa, 0xc8, 0x1f, 0x27, 0xaa, 0x5e, 0x9b, 0xef, 0x78, 0x48, 0x1e, 0x6a, 0x60, 0x1a, 0x71, 0xd8, 0x67, 0x9, 0x40, 0xb3, 0xe4, 0xd0, 0xc6, 0x18,

          Verify we are getting success response
          [1655371172.014771][2459:2464] CHIP:DMG: InvokeResponseMessage =
          [1655371172.014797][2459:2464] CHIP:DMG: {
          [1655371172.014822][2459:2464] CHIP:DMG:         suppressResponse = false,
          [1655371172.014854][2459:2464] CHIP:DMG:         InvokeResponseIBs =
          [1655371172.014889][2459:2464] CHIP:DMG:         [
          [1655371172.014914][2459:2464] CHIP:DMG:                 InvokeResponseIB =
          [1655371172.014959][2459:2464] CHIP:DMG:                 {
          [1655371172.014989][2459:2464] CHIP:DMG:                         CommandStatusIB =
          [1655371172.015024][2459:2464] CHIP:DMG:                         {
          [1655371172.015055][2459:2464] CHIP:DMG:                                 CommandPathIB =
          [1655371172.015090][2459:2464] CHIP:DMG:                                 {
          [1655371172.015125][2459:2464] CHIP:DMG:                                         EndpointId = 0x0,
          [1655371172.015161][2459:2464] CHIP:DMG:                                         ClusterId = 0x3e,
          [1655371172.015196][2459:2464] CHIP:DMG:                                         CommandId = 0xb,
          [1655371172.015229][2459:2464] CHIP:DMG:                                 },
          [1655371172.015266][2459:2464] CHIP:DMG:
          [1655371172.015297][2459:2464] CHIP:DMG:                                 StatusIB =
          [1655371172.015332][2459:2464] CHIP:DMG:                                 {
          [1655371172.015366][2459:2464] CHIP:DMG:                                         status = 0x00 (SUCCESS),
          [1655371172.015399][2459:2464] CHIP:DMG:                                 },
          [1655371172.015433][2459:2464] CHIP:DMG:
          [1655371172.015464][2459:2464] CHIP:DMG:                         },
          [1655371172.015498][2459:2464] CHIP:DMG:
          [1655371172.015527][2459:2464] CHIP:DMG:                 },
          [1655371172.015560][2459:2464] CHIP:DMG:
          [1655371172.015584][2459:2464] CHIP:DMG:         ],
          [1655371172.015614][2459:2464] CHIP:DMG:
          [1655371172.015639][2459:2464] CHIP:DMG:         InteractionModelRevision = 1
          [1655371172.015665][2459:2464] CHIP:DMG: },
          [1655371172.015725][2459:2464] CHIP:DMG: Received Command Response Status for Endpoint=0 Cluster=0x0000_003E Command=0x0000_000B Status=0x0
          [1655371172.015770][2459:2464] CHIP:DMG: ICR moving to [AwaitingDe]
      disabled: true

    - label:
          "TH1 sends AddTrustedRootCertificate command to DUT for the
          installation of the same Root_CA_Certificate_Original_TH1"
      PICS: OPCREDS.S.C0b.Rsp
      verification: |
          1. ./chip-tool generalcommissioning arm-fail-safe 500 600 1 0

          2. ./chip-tool operationalcredentials  add-trusted-root-certificate FTABAQAkAgE3AyQUABgmBIAigScmBYAlTTo3BiQUABgkBwEkCAEwCUEE7v2ZbSMsKkVeeXBYD1r6THUa0+MwX1Sre4hF6HifssT8LmPXr7Yo5Oukmggl4zu0dHeXGoks+DcIqvMoSZqKTDcKNQEpARgkAmAwBBRk4uawYkPefrADlbkhMYSjioM+szAFFGTi5rBiQ95+sAOVuSExhKOKgz6zGDALQP+ShFEcnKP6jj903MIhM8/zcZpRq5whUk/z5ZJgiOztyTD5BTyfAOtLGxnC597PW5Rm4H1Eu+5EkJObonVQcBgY 1 0

          Verify we are getting success response
          [1655371172.014771][2459:2464] CHIP:DMG: InvokeResponseMessage =
          [1655371172.014797][2459:2464] CHIP:DMG: {
          [1655371172.014822][2459:2464] CHIP:DMG:         suppressResponse = false,
          [1655371172.014854][2459:2464] CHIP:DMG:         InvokeResponseIBs =
          [1655371172.014889][2459:2464] CHIP:DMG:         [
          [1655371172.014914][2459:2464] CHIP:DMG:                 InvokeResponseIB =
          [1655371172.014959][2459:2464] CHIP:DMG:                 {
          [1655371172.014989][2459:2464] CHIP:DMG:                         CommandStatusIB =
          [1655371172.015024][2459:2464] CHIP:DMG:                         {
          [1655371172.015055][2459:2464] CHIP:DMG:                                 CommandPathIB =
          [1655371172.015090][2459:2464] CHIP:DMG:                                 {
          [1655371172.015125][2459:2464] CHIP:DMG:                                         EndpointId = 0x0,
          [1655371172.015161][2459:2464] CHIP:DMG:                                         ClusterId = 0x3e,
          [1655371172.015196][2459:2464] CHIP:DMG:                                         CommandId = 0xb,
          [1655371172.015229][2459:2464] CHIP:DMG:                                 },
          [1655371172.015266][2459:2464] CHIP:DMG:
          [1655371172.015297][2459:2464] CHIP:DMG:                                 StatusIB =
          [1655371172.015332][2459:2464] CHIP:DMG:                                 {
          [1655371172.015366][2459:2464] CHIP:DMG:                                         status = 0x00 (SUCCESS),
          [1655371172.015399][2459:2464] CHIP:DMG:                                 },
          [1655371172.015433][2459:2464] CHIP:DMG:
          [1655371172.015464][2459:2464] CHIP:DMG:                         },
          [1655371172.015498][2459:2464] CHIP:DMG:
          [1655371172.015527][2459:2464] CHIP:DMG:                 },
          [1655371172.015560][2459:2464] CHIP:DMG:
          [1655371172.015584][2459:2464] CHIP:DMG:         ],
          [1655371172.015614][2459:2464] CHIP:DMG:
          [1655371172.015639][2459:2464] CHIP:DMG:         InteractionModelRevision = 1
          [1655371172.015665][2459:2464] CHIP:DMG: },
          [1655371172.015725][2459:2464] CHIP:DMG: Received Command Response Status for Endpoint=0 Cluster=0x0000_003E Command=0x0000_000B Status=0x0
          [1655371172.015770][2459:2464] CHIP:DMG: ICR moving to [AwaitingDe]
      disabled: true

    - label: "Read the TrustedRootCertificates list from DUT"
      verification: |
          ./chip-tool operationalcredentials read trusted-root-certificates 1 0

          [1655296468.138167][5628:5633] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Attribute 0x0000_0004 DataVersion: 323778350
          [1655296468.138314][5628:5633] CHIP:TOO:   TrustedRootCertificates: 1 entries
          [1655296468.138421][5628:5633] CHIP:TOO:     [1]: 1530010100240201370324140018260480228127260580254D3A370624140018240701240801300941040411C332B4D6CA8A742852BAA10666F9BD6A0D6180BAF8677011FD1542C19E1A89864CE9454AA409BF0CABB8E2305E6FBB4A767FE00C7D8C0A581758749650C8370A35012901182402603004145A3098A5158DF1C2E6C2188E2CB716AB925129933005145A3098A5158DF1C2E6C2188E2CB716AB9251299318300B40822E81D4315B3710181B44D7E35C91AE7E6578C90D112275BB07CF8B7906751830BC0F93BB53E43BD8AD38C58A74386101A1AC7759D6D53EB9F65F64870C875818
      disabled: true

    - label: "TH1 sends the AddNOC Command to DUT"
      PICS: OPCREDS.S.C06.Rsp
      verification: |
          Not Verifiable
      disabled: true

    - label:
          "Save the FabricIndex as FabricIndex_TH1 or FabricIndex_TH2 (depending
          on which TH was running the command) for future use"
      verification: |
          Not Verifiable
      disabled: true

    - label: "Read the NOCs (NOCStruct) list from DUT"
      verification: |
          ./chip-tool operationalcredentials read nocs 1 0

          [1655470923.441130][13282:13287] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Attribute 0x0000_0000 DataVersion: 2667297991
          [1655470923.441223][13282:13287] CHIP:TOO:   NOCs: 1 entries
          [1655470923.441297][13282:13287] CHIP:TOO:     [1]: {
          [1655470923.441352][13282:13287] CHIP:TOO:       Noc: 1530010101240201370324130118260480228127260580254D3A37062415012411011824070124080130094104D5FA104FF03F9118BDC2A072D50DB3BED32C47F138439FBF05753D02D01AEC10F350CB77EA22844A83FF0FEF6CFA764F5B1FD48E487F3EC82A201D376F56DCC8370A350128011824020136030402040118300414BD61F9405A7A15EFA38F8B6833AB9027876482E1300514B5AED0B2C2CDBB9D4D0124755B56278B081FD4AD18300B40441AA0EE6ACE43EEA2A52321821D8B260AAFFEBD394C2FD11E83008C5AD2DF5EA58FAFA14A3EF7BAFDE190591298311D7DE6A257819D98D0E9FE239A635684B418
          [1655470923.441411][13282:13287] CHIP:TOO:       Icac: 1530010100240201370324140018260480228127260580254D3A37062413011824070124080130094104B267483D9981A2C15E7DE8C63298FEB6DC19EAA9AEA41D9D659CD3BBBD25B943B3186716C82B297091D64B1620E8FB2C6FD095F509684E074C5B479E583CE295370A3501290118240260300414B5AED0B2C2CDBB9D4D0124755B56278B081FD4AD3005146EDE812590A5E6E4463798EB06AC3BD5284DFAAE18300B404A48E0B45704A98739C0C656B0F1A4252AEED8E1EBA5FD1032C79A4B26BF8A314EFDD7C835947DEB4B3E9F6D0BF2A561CEE54B45F311773301D4B5CFFF2F76D918
          [1655470923.441453][13282:13287] CHIP:TOO:       FabricIndex: 1
          [1655470923.441486][13282:13287] CHIP:TOO:      }
      disabled: true

    - label: "Read the first NOCStruct element from the list"
      verification: |

      disabled: true

    - label:
          "TH1 sends UpdateFabricLabel command with 'Label 1' as Label field to
          DUT"
      PICS: OPCREDS.S.C09.Rsp
      verification: |
          ./chip-tool operationalcredentials update-fabric-label label2 1 0

          [1651571821.028022][3803:3808] CHIP:DMG: Received Command Response Data, Endpoint=0 Cluster=0x0000_003E Command=0x0000_0008
          [1651571821.028086][3803:3808] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Command 0x0000_0008
          [1651571821.028181][3803:3808] CHIP:TOO:   NOCResponse: {
          [1651571821.028226][3803:3808] CHIP:TOO:     statusCode: 0
          [1651571821.028259][3803:3808] CHIP:TOO:     fabricIndex: 1
          [1651571821.028292][3803:3808] CHIP:TOO:    }
      disabled: true

    - label:
          "Read the Fabrics List from DUT and get the FabricDescriptorStruct for
          which FabricIndex the FabricIndex field equals FabricIndex_TH1"
      verification: |
          ./chip-tool operationalcredentials read fabrics 1 0

          [1655471672.386120][13377:13382] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Attribute 0x0000_0001 DataVersion: 2667297992
          [1655471672.386213][13377:13382] CHIP:TOO:   Fabrics: 1 entries
          [1655471672.386291][13377:13382] CHIP:TOO:     [1]: {
          [1655471672.386339][13377:13382] CHIP:TOO:       RootPublicKey: 04FB421853FB8AE6AEA281845DE7C8689E7C24AD3283A3536E09BA2FAAE88F6EA4C08DC055A965D8FE0A8060A7F9F45E509B7A4C9092FB3D8D2E253B057899F5AB
          [1655471672.386378][13377:13382] CHIP:TOO:       VendorId: 65521
          [1655471672.386412][13377:13382] CHIP:TOO:       FabricId: 1
          [1655471672.386445][13377:13382] CHIP:TOO:       NodeId: 1
          [1655471672.386675][13377:13382] CHIP:TOO:       Label:
          [1655471672.386716][13377:13382] CHIP:TOO:       FabricIndex: 1
          [1655471672.386750][13377:13382] CHIP:TOO:      }
      disabled: true

    - label: "Read the TrustedRootCertificates list from DUT"
      verification: |
          ./chip-tool operationalcredentials read trusted-root-certificates 1 0

          [1655296468.138167][5628:5633] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Attribute 0x0000_0004 DataVersion: 323778350
          [1655296468.138314][5628:5633] CHIP:TOO:   TrustedRootCertificates: 1 entries
          [1655296468.138421][5628:5633] CHIP:TOO:     [1]: 1530010100240201370324140018260480228127260580254D3A370624140018240701240801300941040411C332B4D6CA8A742852BAA10666F9BD6A0D6180BAF8677011FD1542C19E1A89864CE9454AA409BF0CABB8E2305E6FBB4A767FE00C7D8C0A581758749650C8370A35012901182402603004145A3098A5158DF1C2E6C2188E2CB716AB925129933005145A3098A5158DF1C2E6C2188E2CB716AB9251299318300B40822E81D4315B3710181B44D7E35C91AE7E6578C90D112275BB07CF8B7906751830BC0F93BB53E43BD8AD38C58A74386101A1AC7759D6D53EB9F65F64870C875818
      disabled: true

    - label:
          'TH2 starts comissionning DUT on a second fabric Repeat steps 3 to 30
          for TH2 For UpdateFabricLabel command set the label value as "Label 2"
          Save RCAC certificate as Root_CA_Certificate_Original_TH2'
      verification: |
          To commission DUT to TH2 follow below procedure
          1../chip-tool  pairing open-commissioning-window 1 1 400 2000 3841  on TH
          2. manualcode will be provided by TH when we pass above command pass manualcode in TH2 to commission by using "./chip-tool pairing code 2 36199720672" considering 36199720672 as manualcode generated in TH

          Repeat Step 3 to 30 from DUT to Th
      disabled: true

    - label: "Read the TrustedRootCertificates list from DUT"
      verification: |
          ./chip-tool operationalcredentials read trusted-root-certificates 2 0


          [1655472305.543993][4402:4407] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Attribute 0x0000_0004 DataVersion: 2667297995
          [1655472305.547119][4402:4407] CHIP:TOO:   TrustedRootCertificates: 2 entries
          [1655472305.547219][4402:4407] CHIP:TOO:     [1]: 1530010100240201370324140018260480228127260580254D3A37062414001824070124080130094104FB421853FB8AE6AEA281845DE7C8689E7C24AD3283A3536E09BA2FAAE88F6EA4C08DC055A965D8FE0A8060A7F9F45E509B7A4C9092FB3D8D2E253B057899F5AB370A35012901182402603004146EDE812590A5E6E4463798EB06AC3BD5284DFAAE3005146EDE812590A5E6E4463798EB06AC3BD5284DFAAE18300B405F5AF97A75846BFB6B68727C697FEF7E233535D14303E2338A458BB50A6C7BA05AEC058DD802EB4138164D3525392F51D1F8595E8E9FC79E3F5704995762164218
          [1655472305.547287][4402:4407] CHIP:TOO:     [2]: 1530010100240201370324140018260480228127260580254D3A370624140018240701240801300941046E07C7995834C97544C01B348C6E99AECC2BFBC7A6C9D2CDF2B8C23AEC425463997F77AFF4F536257118CA4113AAD5EDBE64F548F525FF9C1EEEB1E71530CD2F370A3501290118240260300414532A927E58D5D6E4512CA432D4DC750058752C04300514532A927E58D5D6E4512CA432D4DC750058752C0418300B403FDF5247055ACF950C7717B9145ECA0BFE1702C780AD459CBB26E20927A22C5C73308CC5C9C982EAB1EC9F1310784B9F81E35C683D9EA01A5E4CFF9667B8235F18
      disabled: true

    - label:
          "TH2 sends UpdateFabricLabel command with 'Label 1' as Label field to
          DUT"
      PICS: OPCREDS.S.C09.Rsp
      verification: |
          ./chip-tool operationalcredentials update-fabric-label label2 2 0

          [1656311622.310656][20507:20512] CHIP:DMG: Received Command Response Data, Endpoint=0 Cluster=0x0000_003E Command=0x0000_0008
          [1656311622.310739][20507:20512] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Command 0x0000_0008
          [1656311622.310848][20507:20512] CHIP:TOO:   NOCResponse: {
          [1656311622.310937][20507:20512] CHIP:TOO:     statusCode: 10
          [1656311622.310990][20507:20512] CHIP:TOO:    }
      disabled: true

    - label: "Read the Fabrics List from DUT"
      verification: |
          ./chip-tool operationalcredentials read fabrics 2 0 --fabric-filtered 0

          [1655472488.702974][4422:4427] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Attribute 0x0000_0001 DataVersion: 2667297999
          [1655472488.703106][4422:4427] CHIP:TOO:   Fabrics: 2 entries
          [1655472488.703199][4422:4427] CHIP:TOO:     [1]: {
          [1655472488.703253][4422:4427] CHIP:TOO:       RootPublicKey: 04FB421853FB8AE6AEA281845DE7C8689E7C24AD3283A3536E09BA2FAAE88F6EA4C08DC055A965D8FE0A8060A7F9F45E509B7A4C9092FB3D8D2E253B057899F5AB
          [1655472488.703299][4422:4427] CHIP:TOO:       VendorId: 65521
          [1655472488.703338][4422:4427] CHIP:TOO:       FabricId: 1
          [1655472488.703374][4422:4427] CHIP:TOO:       NodeId: 1
          [1655472488.703411][4422:4427] CHIP:TOO:       Label:
          [1655472488.703447][4422:4427] CHIP:TOO:       FabricIndex: 1
          [1655472488.703480][4422:4427] CHIP:TOO:      }
          [1655472488.703535][4422:4427] CHIP:TOO:     [2]: {
          [1655472488.703581][4422:4427] CHIP:TOO:       RootPublicKey: 046E07C7995834C97544C01B348C6E99AECC2BFBC7A6C9D2CDF2B8C23AEC425463997F77AFF4F536257118CA4113AAD5EDBE64F548F525FF9C1EEEB1E71530CD2F
          [1655472488.703622][4422:4427] CHIP:TOO:       VendorId: 65521
          [1655472488.703660][4422:4427] CHIP:TOO:       FabricId: 1
          [1655472488.703697][4422:4427] CHIP:TOO:       NodeId: 2
          [1655472488.703735][4422:4427] CHIP:TOO:       Label: NodeOpeCredits1
          [1655472488.703773][4422:4427] CHIP:TOO:       FabricIndex: 2
          [1655472488.703805][4422:4427] CHIP:TOO:      }
      disabled: true

    - label:
          "Read the Fabrics List from DUT and get the FabricDescriptorStruct for
          which the FabricIndex field equals FabricIndex_TH2"
      verification: |
          See above
      disabled: true

    - label:
          "From TH2 send RemoveFabric command with Fabric Index as
          FabricIndexTH2 + 5 (Invalid Fabric Index) to DUT"
      PICS: OPCREDS.S.C0a.Rsp
      verification: |
          ./chip-tool operationalcredentials remove-fabric 3 2 0

          [1655472616.205550][4434:4439] CHIP:DMG: Received Command Response Data, Endpoint=0 Cluster=0x0000_003E Command=0x0000_0008
          [1655472616.205609][4434:4439] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Command 0x0000_0008
          [1655472616.205671][4434:4439] CHIP:TOO:   NOCResponse: {
          [1655472616.205722][4434:4439] CHIP:TOO:     statusCode: 11
          [1655472616.205760][4434:4439] CHIP:TOO:    }
          [1655472616.205799][4434:4439] CHIP:DMG: ICR moving to [AwaitingDe]


          ./chip-tool operationalcredentials read  trusted-root-certificates 2 0

          [1655472673.786473][4444:4449] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Attribute 0x0000_0004 DataVersion: 2667298001
          [1655472673.786545][4444:4449] CHIP:TOO:   TrustedRootCertificates: 2 entries
          [1655472673.786590][4444:4449] CHIP:TOO:     [1]: 1530010100240201370324140018260480228127260580254D3A37062414001824070124080130094104FB421853FB8AE6AEA281845DE7C8689E7C24AD3283A3536E09BA2FAAE88F6EA4C08DC055A965D8FE0A8060A7F9F45E509B7A4C9092FB3D8D2E253B057899F5AB370A35012901182402603004146EDE812590A5E6E4463798EB06AC3BD5284DFAAE3005146EDE812590A5E6E4463798EB06AC3BD5284DFAAE18300B405F5AF97A75846BFB6B68727C697FEF7E233535D14303E2338A458BB50A6C7BA05AEC058DD802EB4138164D3525392F51D1F8595E8E9FC79E3F5704995762164218
          [1655472673.786635][4444:4449] CHIP:TOO:     [2]: 1530010100240201370324140018260480228127260580254D3A370624140018240701240801300941046E07C7995834C97544C01B348C6E99AECC2BFBC7A6C9D2CDF2B8C23AEC425463997F77AFF4F536257118CA4113AAD5EDBE64F548F525FF9C1EEEB1E71530CD2F370A3501290118240260300414532A927E58D5D6E4512CA432D4DC750058752C04300514532A927E58D5D6E4512CA432D4DC750058752C0418300B403FDF5247055ACF950C7717B9145ECA0BFE1702C780AD459CBB26E20927A22C5C73308CC5C9C982EAB1EC9F1310784B9F81E35C683D9EA01A5E4CFF9667B8235F18
      disabled: true

    - label:
          "From TH2 sends RemoveFabric command with Fabric Index as
          FabricIndex_TH1 (Valid Fabric Index) to DUT"
      verification: |
          ./chip-tool operationalcredentials remove-fabric 1 2 0

          [1655472760.302540][4453:4458] CHIP:DMG: Received Command Response Data, Endpoint=0 Cluster=0x0000_003E Command=0x0000_0008
          [1655472760.302643][4453:4458] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Command 0x0000_0008
          [1655472760.302815][4453:4458] CHIP:TOO:   NOCResponse: {
          [1655472760.302885][4453:4458] CHIP:TOO:     statusCode: 0
          [1655472760.303018][4453:4458] CHIP:TOO:     fabricIndex: 1
          [1655472760.303070][4453:4458] CHIP:TOO:    }
      disabled: true

    - label: "From TH1 Read the Fabrics list from DUT."
      verification: |
          ./chip-tool operationalcredentials read trusted-root-certificates 1 0

          [1655472793.693681][13463:13468] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Attribute 0x0000_0004 DataVersion: 2667298005
          [1655472793.693790][13463:13468] CHIP:TOO:   TrustedRootCertificates: 1 entries
          [1655472793.693869][13463:13468] CHIP:TOO:     [1]: 1530010100240201370324140018260480228127260580254D3A37062414001824070124080130094104FB421853FB8AE6AEA281845DE7C8689E7C24AD3283A3536E09BA2FAAE88F6EA4C08DC055A965D8FE0A8060A7F9F45E509B7A4C9092FB3D8D2E253B057899F5AB370A35012901182402603004146EDE812590A5E6E4463798EB06AC3BD5284DFAAE3005146EDE812590A5E6E4463798EB06AC3BD5284DFAAE18300B405F5AF97A75846BFB6B68727C697FEF7E233535D14303E2338A458BB50A6C7BA05AEC058DD802EB4138164D3525392F51D1F8595E8E9FC79E3F5704995762164218
      disabled: true

    - label:
          "TH1 sends AddTrustedRootCertificate command to DUT to install the
          Root CA Certificate which differs from
          Root_CA_Certificate_Original_TH1 by one byte in the Subject field"
      PICS: OPCREDS.S.C0b.Rsp
      verification: |

      disabled: true

    - label: "Read the TrustedRootCertificates list from DUT"
      verification: |
          ./chip-tool operationalcredentials read trusted-root-certificates 1 0

          [1655296468.138167][5628:5633] CHIP:TOO: Endpoint: 0 Cluster: 0x0000_003E Attribute 0x0000_0004 DataVersion: 323778350
          [1655296468.138314][5628:5633] CHIP:TOO:   TrustedRootCertificates: 1 entries
          [1655296468.138421][5628:5633] CHIP:TOO:     [1]: 1530010100240201370324140018260480228127260580254D3A370624140018240701240801300941040411C332B4D6CA8A742852BAA10666F9BD6A0D6180BAF8677011FD1542C19E1A89864CE9454AA409BF0CABB8E2305E6FBB4A767FE00C7D8C0A581758749650C8370A35012901182402603004145A3098A5158DF1C2E6C2188E2CB716AB925129933005145A3098A5158DF1C2E6C2188E2CB716AB9251299318300B40822E81D4315B3710181B44D7E35C91AE7E6578C90D112275BB07CF8B7906751830BC0F93BB53E43BD8AD38C58A74386101A1AC7759D6D53EB9F65F64870C875818
      disabled: true

    - label:
          "TH1 sends AddTrustedRootCertificate command to DUT to install a
          malformed Root CA Certificate where the signature does not match the
          public key"
      PICS: OPCREDS.S.C0b.Rsp
      verification: |
          Not verifiable
      disabled: true
