<!DOCTYPE html>
<html>

<head>
    <title>Push AV Server</title>
    <link href="{{ url_for('static', path='/styles.css') }}" rel="stylesheet">
</head>

<body>
    <nav class="top-level">
        <a href="/ui/streams">Streams</a>
        <a href="/ui/certificates">Certificates</a>
    </nav>
    <div class="left-bar">
        <h2>Stream Details</h2>

        <h3>Configuration</h3>
            <ul>
                <li>Stream ID: {{stream.id}}</li>
                <li>Strict Mode: {{stream.strict_mode}}</li>
                <li>Interface: {{stream.interface}}</li>
                <li>Track name: {{stream.track_name}}</li>
            </ul>
        <h3>Sessions</h3>
        <ul>
        {% for session in stream.sessions %}
            <li> Session {{session.id}}
                {%- set errors = stream.errors | selectattr('session_id', 'eq', session.id) | list -%}
                <ul>
                    <li>
                        {{- errors|length}} errors{% if errors|length > 1 %}:{% endif %}

                        <ul>
                            {% for error in errors %}
                                <li>{{error.file_path}} : {{error.reasons}}</li>
                            {% endfor %}
                        </ul>
                    </li>
                    {% for (file, crt) in session.uploaded_segments %}
                    <li><a href="/ui/streams/{{stream.id}}/{{file}}">{{file}}</a> (<a href="/ui/streams/{{stream.id}}/{{crt}}">{{crt}}</a>)</li>
                    {% endfor %}
                    {% for (file, crt) in session.uploaded_manifests %}
                    <li><a href="/ui/streams/{{stream.id}}/{{file}}">{{file}}</a> (<a href="/ui/streams/{{stream.id}}/{{crt}}">{{crt}}</a>) </li>
                    {% endfor %}
                </ul>
            </li>
        {% endfor %}
        </ul>
</body>

</html>