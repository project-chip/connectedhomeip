name=OTA Bootload Client Policy
description=This plugin provides a simple interface for configuring an OTA Bootload cluster client.
category=ZCL
quality=development

requiredApis=zcl-core,zcl-ota-bootload-core,zcl-ota-bootload-client

ota-bootload-client-policy.c

implementedCallbacks=chipZclOtaBootloadClientSetVersionInfoCallback,chipZclOtaBootloadClientServerHasStaticAddressCallback,chipZclOtaBootloadClientServerHasDnsNameCallback,chipZclOtaBootloadClientServerHasDiscByClusterId,chipZclOtaBootloadClientExpectSecureOta,chipZclOtaBootloadClientServerDiscoveredCallback,chipZclOtaBootloadClientGetQueryNextImageParametersCallback,chipZclOtaBootloadClientStartDownloadCallback,chipZclOtaBootloadClientDownloadCompleteCallback,chipZclOtaBootloadClientPreBootloadCallback

options=serverLookupType,serverSchemeParameter,serverName,serverAddressParameter,serverPortParameter,serverUidParameter,serverEndpointParameter,currentImageManufacturerCode,currentImageType,currentImageVersion,currentHardwareVersion,deleteExistingImagesBeforeDownload

serverLookupType.name=Server Detection Method
serverLookupType.description=The desired method to detect the address of the OTA server
serverLookupType.type=LIST:CHIP_ZCL_OTA_STATIC_IP,CHIP_ZCL_OTA_DNS_LOOKUP,CHIP_ZCL_OTA_DISCOVER
serverLookupType.default=CHIP_ZCL_OTA_DISCOVER

# TODO: Enable COAPS as default when it is available
serverSchemeParameter.name=Desired Server Scheme
serverSchemeParameter.description=The desired scheme to use in order to communicate with the OTA Bootload Server device (see ChipZclScheme_t type).
serverSchemeParameter.type=LIST:CHIP_ZCL_SCHEME_COAP,CHIP_ZCL_SCHEME_COAPS,
serverSchemeParameter.default=CHIP_ZCL_SCHEME_COAP

# The DNS name for OTA server
serverName.name=OTA Server Name
serverName.description=The network name to use when looking for an OTA server. This field is used when Detection Method is DNS_LOOKUP.
serverName.type=length_encoded_hostname
serverName.default=silabs.com

serverAddressParameter.name=Desired Server IPV6 Address
serverAddressParameter.description=The desired address to use in order to communicate with the OTA Bootload Server device (see ChipIpv6Address type). Note that specifying 16 0xFF bytes for this plugin option in DISCOVERY mode will allow the device to accept any remote address. The special IPv6 prefix FC01:6464::<IPv4 address> can be used to route IPv4 addresses via a Border Router.
serverAddressParameter.type=ipv6_address
serverAddressParameter.default=FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF

# TODO: Set default port to 5684, the secure COAPS port
serverPortParameter.name=Desired Server Port
serverPortParameter.description=The desired port to use in order to communicate with the OTA Bootload Server device. Typically 5683 is used. Note that specifying 0xFFFF for this plugin option in DISCOVERY mode will allow the device to accept any port.
serverPortParameter.type=NUMBER:0,65535
serverPortParameter.default=0xFFFF

serverUidParameter.name=Desired Server UID
serverUidParameter.description=The desired UID to use in order to communicate with the OTA Bootload Server device (see ChipIpv6Address type). Note that specifying 32 0xFF bytes for this plugin option in DISCOVERY mode will allow the device to accept any remote address.b
serverUidParameter.type=NUMBER_ARRAY
serverUidParameter.default=0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF

serverEndpointParameter.name=Desired Server Endpoint
serverEndpointParameter.description=The desired endpoint to use in order to communicate with the OTA Bootload Server device. Note that specifying 255 for this plugin option in DISCOVERY mode will allow the device to accept any endpoint.
serverEndpointParameter.type=NUMBER:1,255
serverEndpointParameter.default=1

currentImageManufacturerCode.name=Current Image Manufacturer Code
currentImageManufacturerCode.description=This is the Manufacturer Code for the current image on the local device.
currentImageManufacturerCode.type=NUMBER:0,65535
currentImageManufacturerCode.default=0x0000

currentImageType.name=Current Image Type
currentImageType.description=This is the type of the current image on the local device.
currentImageType.type=NUMBER:0,65535
currentImageType.default=0xFFFF

currentImageVersion.name=Current Image Version
currentImageVersion.description=This is the version of the current image on the local device.
currentImageVersion.type=NUMBER:0,4294967295
currentImageVersion.default=0x00000000

currentHardwareVersion.name=Current Hardware Version
currentHardwareVersion.description=This is the hardware version of the local device. Note that this plugin option can be set to 0xFFFF to disregard the hardware version.
currentHardwareVersion.type=NUMBER:0,65535
currentHardwareVersion.default=0xFFFF

deleteExistingImagesBeforeDownload.name=Delete Existing Images Before Download
deleteExistingImagesBeforeDownload.description=This determines whether or not devices will automatically delete existing OTA images before downloading new ones. Applications that run atop storage implementations that are not read/modify/write will need to use this option.
deleteExistingImagesBeforeDownload.type=BOOLEAN
deleteExistingImagesBeforeDownload.default=TRUE

setup(zclip) { 
  provides: Over the Air Bootloading,client 
} 
