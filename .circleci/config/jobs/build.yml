parameters:
    builder:
        type: string
environment:
    BUILD_TYPE: "<< parameters.builder >>"
executor: << parameters.builder >>
steps:
    - checkout
    - run:
         name: Enable IPv6
         command: |
           cat \<<'EOF' | sudo tee /etc/docker/daemon.json
           {
             "ipv6": true,
             "fixed-cidr-v6": "2001:db8:1::/64"
           }
           EOF
           sudo service docker restart
    - setup-environment:
          builder: << parameters.builder >>
    - bootstrap
    - save-bootstrapped-tree:
          builder: << parameters.builder >>
    - run:
          name: Build
          command: scripts/build/default.sh
    - save-built-tree:
          builder: << parameters.builder >>
    - save-build-environment:
          builder: << parameters.builder >>
